{"meta":{"timestamp":"2025-07-01T13:15:19.467884","version":"9.2.1","argv":["sample/435bf00ef63783d41805be2eeb2e0f21.exe","-f","pe","-vvv","--json"],"sample":{"md5":"435bf00ef63783d41805be2eeb2e0f21","sha1":"4fdeb0a7971d147967d728f6fc8d30b7f8b4617b","sha256":"aeb9fbca5debe5f070a440a165856109fd4287bb1ce75b0f93ed6250be90232a","path":"/home/GokbakarE/sample/435bf00ef63783d41805be2eeb2e0f21.exe"},"flavor":"static","analysis":{"format":"pe","arch":"i386","os":"windows","extractor":"VivisectFeatureExtractor","rules":["/tmp/_MEI5ELLoD/rules"],"base_address":{"type":"absolute","value":4194304},"layout":{"functions":[{"address":{"type":"absolute","value":4198404},"matched_basic_blocks":[{"address":{"type":"absolute","value":4198404}},{"address":{"type":"absolute","value":4198409}},{"address":{"type":"absolute","value":4198429}},{"address":{"type":"absolute","value":4198525}},{"address":{"type":"absolute","value":4198543}}]},{"address":{"type":"absolute","value":4198424},"matched_basic_blocks":[{"address":{"type":"absolute","value":4198429}},{"address":{"type":"absolute","value":4198543}}]},{"address":{"type":"absolute","value":4198536},"matched_basic_blocks":[{"address":{"type":"absolute","value":4198536}}]},{"address":{"type":"absolute","value":4198696},"matched_basic_blocks":[{"address":{"type":"absolute","value":4198711}}]},{"address":{"type":"absolute","value":4198720},"matched_basic_blocks":[{"address":{"type":"absolute","value":4198747}}]},{"address":{"type":"absolute","value":4198900},"matched_basic_blocks":[{"address":{"type":"absolute","value":4198947}},{"address":{"type":"absolute","value":4198979}}]},{"address":{"type":"absolute","value":4198996},"matched_basic_blocks":[{"address":{"type":"absolute","value":4199035}},{"address":{"type":"absolute","value":4199060}},{"address":{"type":"absolute","value":4199099}}]},{"address":{"type":"absolute","value":4199232},"matched_basic_blocks":[{"address":{"type":"absolute","value":4199232}},{"address":{"type":"absolute","value":4199316}}]},{"address":{"type":"absolute","value":4199340},"matched_basic_blocks":[{"address":{"type":"absolute","value":4199340}}]},{"address":{"type":"absolute","value":4199372},"matched_basic_blocks":[{"address":{"type":"absolute","value":4199454}},{"address":{"type":"absolute","value":4199466}},{"address":{"type":"absolute","value":4199531}},{"address":{"type":"absolute","value":4199539}},{"address":{"type":"absolute","value":4199547}},{"address":{"type":"absolute","value":4199554}}]},{"address":{"type":"absolute","value":4199648},"matched_basic_blocks":[{"address":{"type":"absolute","value":4199657}}]},{"address":{"type":"absolute","value":4199708},"matched_basic_blocks":[{"address":{"type":"absolute","value":4199684}}]},{"address":{"type":"absolute","value":4199728},"matched_basic_blocks":[{"address":{"type":"absolute","value":4199752}},{"address":{"type":"absolute","value":4199755}}]},{"address":{"type":"absolute","value":4199828},"matched_basic_blocks":[{"address":{"type":"absolute","value":4199839}}]},{"address":{"type":"absolute","value":4200120},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4200424},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200309}},{"address":{"type":"absolute","value":4200407}},{"address":{"type":"absolute","value":4200465}},{"address":{"type":"absolute","value":4200538}}]},{"address":{"type":"absolute","value":4200494},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200309}},{"address":{"type":"absolute","value":4200407}},{"address":{"type":"absolute","value":4200494}},{"address":{"type":"absolute","value":4200538}}]},{"address":{"type":"absolute","value":4200584},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200600}},{"address":{"type":"absolute","value":4200610}}]},{"address":{"type":"absolute","value":4200808},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200808}}]},{"address":{"type":"absolute","value":4200856},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200918}},{"address":{"type":"absolute","value":4200929}}]},{"address":{"type":"absolute","value":4201144},"matched_basic_blocks":[{"address":{"type":"absolute","value":4201144}}]},{"address":{"type":"absolute","value":4201248},"matched_basic_blocks":[{"address":{"type":"absolute","value":4201285}}]},{"address":{"type":"absolute","value":4201404},"matched_basic_blocks":[{"address":{"type":"absolute","value":4201408}}]},{"address":{"type":"absolute","value":4201512},"matched_basic_blocks":[{"address":{"type":"absolute","value":4201538}}]},{"address":{"type":"absolute","value":4201572},"matched_basic_blocks":[{"address":{"type":"absolute","value":4201585}}]},{"address":{"type":"absolute","value":4201640},"matched_basic_blocks":[{"address":{"type":"absolute","value":4201654}},{"address":{"type":"absolute","value":4201683}}]},{"address":{"type":"absolute","value":4201708},"matched_basic_blocks":[{"address":{"type":"absolute","value":4201654}},{"address":{"type":"absolute","value":4201683}},{"address":{"type":"absolute","value":4201742}}]},{"address":{"type":"absolute","value":4201824},"matched_basic_blocks":[{"address":{"type":"absolute","value":4201857}},{"address":{"type":"absolute","value":4201873}},{"address":{"type":"absolute","value":4201911}}]},{"address":{"type":"absolute","value":4201956},"matched_basic_blocks":[{"address":{"type":"absolute","value":4201989}},{"address":{"type":"absolute","value":4201991}},{"address":{"type":"absolute","value":4202018}},{"address":{"type":"absolute","value":4202029}},{"address":{"type":"absolute","value":4202075}}]},{"address":{"type":"absolute","value":4202141},"matched_basic_blocks":[{"address":{"type":"absolute","value":4202141}}]},{"address":{"type":"absolute","value":4202228},"matched_basic_blocks":[{"address":{"type":"absolute","value":4202257}}]},{"address":{"type":"absolute","value":4202292},"matched_basic_blocks":[{"address":{"type":"absolute","value":4202326}},{"address":{"type":"absolute","value":4202334}}]},{"address":{"type":"absolute","value":4202436},"matched_basic_blocks":[{"address":{"type":"absolute","value":4202461}}]},{"address":{"type":"absolute","value":4202604},"matched_basic_blocks":[{"address":{"type":"absolute","value":4202622}}]},{"address":{"type":"absolute","value":4202652},"matched_basic_blocks":[{"address":{"type":"absolute","value":4202706}},{"address":{"type":"absolute","value":4202716}},{"address":{"type":"absolute","value":4202726}},{"address":{"type":"absolute","value":4202748}},{"address":{"type":"absolute","value":4202778}}]},{"address":{"type":"absolute","value":4202800},"matched_basic_blocks":[{"address":{"type":"absolute","value":4202818}}]},{"address":{"type":"absolute","value":4202852},"matched_basic_blocks":[{"address":{"type":"absolute","value":4202973}},{"address":{"type":"absolute","value":4202991}},{"address":{"type":"absolute","value":4203021}},{"address":{"type":"absolute","value":4203040}},{"address":{"type":"absolute","value":4203055}},{"address":{"type":"absolute","value":4203072}}]},{"address":{"type":"absolute","value":4203088},"matched_basic_blocks":[{"address":{"type":"absolute","value":4203106}}]},{"address":{"type":"absolute","value":4203140},"matched_basic_blocks":[{"address":{"type":"absolute","value":4203192}},{"address":{"type":"absolute","value":4203202}},{"address":{"type":"absolute","value":4203217}},{"address":{"type":"absolute","value":4203233}},{"address":{"type":"absolute","value":4203251}},{"address":{"type":"absolute","value":4203281}},{"address":{"type":"absolute","value":4203300}},{"address":{"type":"absolute","value":4203315}}]},{"address":{"type":"absolute","value":4203332},"matched_basic_blocks":[{"address":{"type":"absolute","value":4203365}},{"address":{"type":"absolute","value":4203428}},{"address":{"type":"absolute","value":4203439}},{"address":{"type":"absolute","value":4203456}},{"address":{"type":"absolute","value":4203473}},{"address":{"type":"absolute","value":4203490}},{"address":{"type":"absolute","value":4203522}},{"address":{"type":"absolute","value":4203547}},{"address":{"type":"absolute","value":4203564}},{"address":{"type":"absolute","value":4203581}},{"address":{"type":"absolute","value":4203599}}]},{"address":{"type":"absolute","value":4203616},"matched_basic_blocks":[{"address":{"type":"absolute","value":4203675}},{"address":{"type":"absolute","value":4203686}},{"address":{"type":"absolute","value":4203709}},{"address":{"type":"absolute","value":4203729}},{"address":{"type":"absolute","value":4203758}},{"address":{"type":"absolute","value":4203782}},{"address":{"type":"absolute","value":4203811}},{"address":{"type":"absolute","value":4203831}}]},{"address":{"type":"absolute","value":4203868},"matched_basic_blocks":[{"address":{"type":"absolute","value":4203868}}]},{"address":{"type":"absolute","value":4203996},"matched_basic_blocks":[{"address":{"type":"absolute","value":4202973}},{"address":{"type":"absolute","value":4202991}},{"address":{"type":"absolute","value":4203021}},{"address":{"type":"absolute","value":4203040}},{"address":{"type":"absolute","value":4203055}},{"address":{"type":"absolute","value":4203072}}]},{"address":{"type":"absolute","value":4204012},"matched_basic_blocks":[{"address":{"type":"absolute","value":4204012}},{"address":{"type":"absolute","value":4204089}},{"address":{"type":"absolute","value":4204143}},{"address":{"type":"absolute","value":4204168}},{"address":{"type":"absolute","value":4204239}},{"address":{"type":"absolute","value":4204281}},{"address":{"type":"absolute","value":4204303}},{"address":{"type":"absolute","value":4204348}}]},{"address":{"type":"absolute","value":4204408},"matched_basic_blocks":[{"address":{"type":"absolute","value":4204408}}]},{"address":{"type":"absolute","value":4204707},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4205125},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4205181},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4205773},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4205808},"matched_basic_blocks":[{"address":{"type":"absolute","value":4205858}}]},{"address":{"type":"absolute","value":4205931},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4205948},"matched_basic_blocks":[{"address":{"type":"absolute","value":4205948}}]},{"address":{"type":"absolute","value":4206052},"matched_basic_blocks":[{"address":{"type":"absolute","value":4206052}}]},{"address":{"type":"absolute","value":4206128},"matched_basic_blocks":[{"address":{"type":"absolute","value":4206128}}]},{"address":{"type":"absolute","value":4206251},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4206328},"matched_basic_blocks":[{"address":{"type":"absolute","value":4206483}}]},{"address":{"type":"absolute","value":4206618},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4206632},"matched_basic_blocks":[{"address":{"type":"absolute","value":4206656}},{"address":{"type":"absolute","value":4206663}}]},{"address":{"type":"absolute","value":4206672},"matched_basic_blocks":[{"address":{"type":"absolute","value":4206696}}]},{"address":{"type":"absolute","value":4206712},"matched_basic_blocks":[{"address":{"type":"absolute","value":4206825}}]},{"address":{"type":"absolute","value":4206852},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4206880},"matched_basic_blocks":[{"address":{"type":"absolute","value":4206880}}]},{"address":{"type":"absolute","value":4207003},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4207057},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4207080},"matched_basic_blocks":[{"address":{"type":"absolute","value":4207095}},{"address":{"type":"absolute","value":4207099}},{"address":{"type":"absolute","value":4207154}},{"address":{"type":"absolute","value":4207200}}]},{"address":{"type":"absolute","value":4207152},"matched_basic_blocks":[{"address":{"type":"absolute","value":4207152}},{"address":{"type":"absolute","value":4207154}}]},{"address":{"type":"absolute","value":4207168},"matched_basic_blocks":[{"address":{"type":"absolute","value":4207200}}]},{"address":{"type":"absolute","value":4207294},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4207312},"matched_basic_blocks":[{"address":{"type":"absolute","value":4207312}}]},{"address":{"type":"absolute","value":4207360},"matched_basic_blocks":[{"address":{"type":"absolute","value":4207360}},{"address":{"type":"absolute","value":4207435}}]},{"address":{"type":"absolute","value":4207476},"matched_basic_blocks":[{"address":{"type":"absolute","value":4207476}}]},{"address":{"type":"absolute","value":4207528},"matched_basic_blocks":[{"address":{"type":"absolute","value":4207528}}]},{"address":{"type":"absolute","value":4207686},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4207740},"matched_basic_blocks":[{"address":{"type":"absolute","value":4207740}}]},{"address":{"type":"absolute","value":4207873},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4207884},"matched_basic_blocks":[{"address":{"type":"absolute","value":4207884}},{"address":{"type":"absolute","value":4208011}}]},{"address":{"type":"absolute","value":4208058},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4208084},"matched_basic_blocks":[{"address":{"type":"absolute","value":4208106}},{"address":{"type":"absolute","value":4208151}},{"address":{"type":"absolute","value":4208170}}]},{"address":{"type":"absolute","value":4208196},"matched_basic_blocks":[{"address":{"type":"absolute","value":4208196}},{"address":{"type":"absolute","value":4208227}},{"address":{"type":"absolute","value":4208250}},{"address":{"type":"absolute","value":4208279}},{"address":{"type":"absolute","value":4208287}}]},{"address":{"type":"absolute","value":4208320},"matched_basic_blocks":[{"address":{"type":"absolute","value":4208320}},{"address":{"type":"absolute","value":4208361}},{"address":{"type":"absolute","value":4208476}},{"address":{"type":"absolute","value":4208490}},{"address":{"type":"absolute","value":4208538}},{"address":{"type":"absolute","value":4208566}},{"address":{"type":"absolute","value":4208577}},{"address":{"type":"absolute","value":4208581}}]},{"address":{"type":"absolute","value":4208622},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4208636},"matched_basic_blocks":[{"address":{"type":"absolute","value":4208636}},{"address":{"type":"absolute","value":4208872}},{"address":{"type":"absolute","value":4208938}},{"address":{"type":"absolute","value":4209005}},{"address":{"type":"absolute","value":4209028}},{"address":{"type":"absolute","value":4209056}}]},{"address":{"type":"absolute","value":4209142},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4209160},"matched_basic_blocks":[{"address":{"type":"absolute","value":4209160}}]},{"address":{"type":"absolute","value":4209200},"matched_basic_blocks":[{"address":{"type":"absolute","value":4209200}},{"address":{"type":"absolute","value":4209278}},{"address":{"type":"absolute","value":4209312}}]},{"address":{"type":"absolute","value":4209477},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4209496},"matched_basic_blocks":[{"address":{"type":"absolute","value":4209496}}]},{"address":{"type":"absolute","value":4209544},"matched_basic_blocks":[{"address":{"type":"absolute","value":4209544}},{"address":{"type":"absolute","value":4209686}},{"address":{"type":"absolute","value":4209704}}]},{"address":{"type":"absolute","value":4209716},"matched_basic_blocks":[{"address":{"type":"absolute","value":4209724}},{"address":{"type":"absolute","value":4209797}},{"address":{"type":"absolute","value":4209847}},{"address":{"type":"absolute","value":4209872}},{"address":{"type":"absolute","value":4209916}}]},{"address":{"type":"absolute","value":4209748},"matched_basic_blocks":[{"address":{"type":"absolute","value":4209762}},{"address":{"type":"absolute","value":4209769}},{"address":{"type":"absolute","value":4209847}},{"address":{"type":"absolute","value":4209853}},{"address":{"type":"absolute","value":4209865}},{"address":{"type":"absolute","value":4209872}},{"address":{"type":"absolute","value":4209877}},{"address":{"type":"absolute","value":4209916}}]},{"address":{"type":"absolute","value":4209813},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4209832},"matched_basic_blocks":[{"address":{"type":"absolute","value":4209847}},{"address":{"type":"absolute","value":4209872}},{"address":{"type":"absolute","value":4209916}}]},{"address":{"type":"absolute","value":4209960},"matched_basic_blocks":[{"address":{"type":"absolute","value":4209960}},{"address":{"type":"absolute","value":4209991}},{"address":{"type":"absolute","value":4210049}},{"address":{"type":"absolute","value":4210077}},{"address":{"type":"absolute","value":4210104}},{"address":{"type":"absolute","value":4210127}},{"address":{"type":"absolute","value":4210210}},{"address":{"type":"absolute","value":4210233}},{"address":{"type":"absolute","value":4210250}},{"address":{"type":"absolute","value":4210268}},{"address":{"type":"absolute","value":4210287}},{"address":{"type":"absolute","value":4210306}},{"address":{"type":"absolute","value":4210309}},{"address":{"type":"absolute","value":4210329}},{"address":{"type":"absolute","value":4210378}}]},{"address":{"type":"absolute","value":4210457},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4210840},"matched_basic_blocks":[{"address":{"type":"absolute","value":4210861}},{"address":{"type":"absolute","value":4210981}},{"address":{"type":"absolute","value":4210999}},{"address":{"type":"absolute","value":4211013}},{"address":{"type":"absolute","value":4211043}},{"address":{"type":"absolute","value":4211044}}]},{"address":{"type":"absolute","value":4210900},"matched_basic_blocks":[{"address":{"type":"absolute","value":4210922}},{"address":{"type":"absolute","value":4210959}},{"address":{"type":"absolute","value":4210968}},{"address":{"type":"absolute","value":4210981}},{"address":{"type":"absolute","value":4210999}},{"address":{"type":"absolute","value":4211013}},{"address":{"type":"absolute","value":4211027}},{"address":{"type":"absolute","value":4211043}},{"address":{"type":"absolute","value":4211044}}]},{"address":{"type":"absolute","value":4210952},"matched_basic_blocks":[{"address":{"type":"absolute","value":4210955}},{"address":{"type":"absolute","value":4210981}},{"address":{"type":"absolute","value":4210999}},{"address":{"type":"absolute","value":4211013}},{"address":{"type":"absolute","value":4211027}},{"address":{"type":"absolute","value":4211043}},{"address":{"type":"absolute","value":4211044}}]},{"address":{"type":"absolute","value":4211245},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4211309},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4211433},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4211489},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4211593},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4211612},"matched_basic_blocks":[{"address":{"type":"absolute","value":4211612}}]},{"address":{"type":"absolute","value":4211673},"matched_basic_blocks":[{"address":{"type":"absolute","value":4199877}},{"address":{"type":"absolute","value":4199921}},{"address":{"type":"absolute","value":4199981}},{"address":{"type":"absolute","value":4199992}},{"address":{"type":"absolute","value":4200040}}]},{"address":{"type":"absolute","value":4211692},"matched_basic_blocks":[{"address":{"type":"absolute","value":4211692}}]},{"address":{"type":"absolute","value":4211919},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4211936},"matched_basic_blocks":[{"address":{"type":"absolute","value":4211936}},{"address":{"type":"absolute","value":4212028}},{"address":{"type":"absolute","value":4212060}},{"address":{"type":"absolute","value":4212109}}]},{"address":{"type":"absolute","value":4212143},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4212160},"matched_basic_blocks":[{"address":{"type":"absolute","value":4212213}}]},{"address":{"type":"absolute","value":4212303},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4212368},"matched_basic_blocks":[{"address":{"type":"absolute","value":4212368}},{"address":{"type":"absolute","value":4212856}},{"address":{"type":"absolute","value":4212887}},{"address":{"type":"absolute","value":4212918}},{"address":{"type":"absolute","value":4212949}}]},{"address":{"type":"absolute","value":4213047},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4213450},"matched_basic_blocks":[{"address":{"type":"absolute","value":4199877}},{"address":{"type":"absolute","value":4199921}},{"address":{"type":"absolute","value":4199981}},{"address":{"type":"absolute","value":4199992}},{"address":{"type":"absolute","value":4200040}}]},{"address":{"type":"absolute","value":4213624},"matched_basic_blocks":[{"address":{"type":"absolute","value":4213639}}]},{"address":{"type":"absolute","value":4213776},"matched_basic_blocks":[{"address":{"type":"absolute","value":4213776}}]},{"address":{"type":"absolute","value":4214192},"matched_basic_blocks":[{"address":{"type":"absolute","value":4214192}}]},{"address":{"type":"absolute","value":4214408},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4214592},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4214628},"matched_basic_blocks":[{"address":{"type":"absolute","value":4214704}}]},{"address":{"type":"absolute","value":4214640},"matched_basic_blocks":[{"address":{"type":"absolute","value":4214704}}]},{"address":{"type":"absolute","value":4214731},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4214956},"matched_basic_blocks":[{"address":{"type":"absolute","value":4214956}},{"address":{"type":"absolute","value":4215010}}]},{"address":{"type":"absolute","value":4215028},"matched_basic_blocks":[{"address":{"type":"absolute","value":4215087}}]},{"address":{"type":"absolute","value":4215068},"matched_basic_blocks":[{"address":{"type":"absolute","value":4215068}}]},{"address":{"type":"absolute","value":4215085},"matched_basic_blocks":[{"address":{"type":"absolute","value":4215087}}]},{"address":{"type":"absolute","value":4215096},"matched_basic_blocks":[{"address":{"type":"absolute","value":4215096}}]},{"address":{"type":"absolute","value":4215203},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4215236},"matched_basic_blocks":[{"address":{"type":"absolute","value":4215236}}]},{"address":{"type":"absolute","value":4215343},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4215368},"matched_basic_blocks":[{"address":{"type":"absolute","value":4215380}},{"address":{"type":"absolute","value":4215461}},{"address":{"type":"absolute","value":4215474}},{"address":{"type":"absolute","value":4215480}},{"address":{"type":"absolute","value":4215485}},{"address":{"type":"absolute","value":4215592}}]},{"address":{"type":"absolute","value":4215380},"matched_basic_blocks":[{"address":{"type":"absolute","value":4215380}}]},{"address":{"type":"absolute","value":4215454},"matched_basic_blocks":[{"address":{"type":"absolute","value":4215454}},{"address":{"type":"absolute","value":4215480}},{"address":{"type":"absolute","value":4215592}}]},{"address":{"type":"absolute","value":4215480},"matched_basic_blocks":[{"address":{"type":"absolute","value":4215480}},{"address":{"type":"absolute","value":4215592}}]},{"address":{"type":"absolute","value":4215628},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4215648},"matched_basic_blocks":[{"address":{"type":"absolute","value":4216304}}]},{"address":{"type":"absolute","value":4216362},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4216776},"matched_basic_blocks":[{"address":{"type":"absolute","value":4216776}},{"address":{"type":"absolute","value":4216809}}]},{"address":{"type":"absolute","value":4216872},"matched_basic_blocks":[{"address":{"type":"absolute","value":4216872}}]},{"address":{"type":"absolute","value":4217008},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4217024},"matched_basic_blocks":[{"address":{"type":"absolute","value":4217533}},{"address":{"type":"absolute","value":4217635}},{"address":{"type":"absolute","value":4217862}},{"address":{"type":"absolute","value":4218019}}]},{"address":{"type":"absolute","value":4218168},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4218240},"matched_basic_blocks":[{"address":{"type":"absolute","value":4218240}},{"address":{"type":"absolute","value":4218406}}]},{"address":{"type":"absolute","value":4218450},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4218464},"matched_basic_blocks":[{"address":{"type":"absolute","value":4218464}},{"address":{"type":"absolute","value":4218585}}]},{"address":{"type":"absolute","value":4218629},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4218648},"matched_basic_blocks":[{"address":{"type":"absolute","value":4218648}}]},{"address":{"type":"absolute","value":4218700},"matched_basic_blocks":[{"address":{"type":"absolute","value":4218700}},{"address":{"type":"absolute","value":4218744}},{"address":{"type":"absolute","value":4218948}},{"address":{"type":"absolute","value":4219000}}]},{"address":{"type":"absolute","value":4219047},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4219092},"matched_basic_blocks":[{"address":{"type":"absolute","value":4219097}},{"address":{"type":"absolute","value":4219200}},{"address":{"type":"absolute","value":4219274}},{"address":{"type":"absolute","value":4219286}}]},{"address":{"type":"absolute","value":4219112},"matched_basic_blocks":[{"address":{"type":"absolute","value":4219112}}]},{"address":{"type":"absolute","value":4219164},"matched_basic_blocks":[{"address":{"type":"absolute","value":4219270}},{"address":{"type":"absolute","value":4219274}},{"address":{"type":"absolute","value":4219286}}]},{"address":{"type":"absolute","value":4219200},"matched_basic_blocks":[{"address":{"type":"absolute","value":4219200}},{"address":{"type":"absolute","value":4219274}},{"address":{"type":"absolute","value":4219286}}]},{"address":{"type":"absolute","value":4219292},"matched_basic_blocks":[{"address":{"type":"absolute","value":4219292}},{"address":{"type":"absolute","value":4219463}}]},{"address":{"type":"absolute","value":4219490},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4219920},"matched_basic_blocks":[{"address":{"type":"absolute","value":4219920}},{"address":{"type":"absolute","value":4220078}},{"address":{"type":"absolute","value":4220344}}]},{"address":{"type":"absolute","value":4220337},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4220344},"matched_basic_blocks":[{"address":{"type":"absolute","value":4220344}}]},{"address":{"type":"absolute","value":4220407},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4220436},"matched_basic_blocks":[{"address":{"type":"absolute","value":4220436}}]},{"address":{"type":"absolute","value":4220608},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4220624},"matched_basic_blocks":[{"address":{"type":"absolute","value":4220624}}]},{"address":{"type":"absolute","value":4220747},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4220905},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4221291},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4221400},"matched_basic_blocks":[{"address":{"type":"absolute","value":4221515}},{"address":{"type":"absolute","value":4221520}},{"address":{"type":"absolute","value":4221530}},{"address":{"type":"absolute","value":4221629}},{"address":{"type":"absolute","value":4221660}},{"address":{"type":"absolute","value":4221701}},{"address":{"type":"absolute","value":4222203}},{"address":{"type":"absolute","value":4222578}},{"address":{"type":"absolute","value":4222630}}]},{"address":{"type":"absolute","value":4221424},"matched_basic_blocks":[{"address":{"type":"absolute","value":4221431}},{"address":{"type":"absolute","value":4221530}},{"address":{"type":"absolute","value":4221539}},{"address":{"type":"absolute","value":4221660}},{"address":{"type":"absolute","value":4221701}},{"address":{"type":"absolute","value":4222203}},{"address":{"type":"absolute","value":4222578}},{"address":{"type":"absolute","value":4222630}}]},{"address":{"type":"absolute","value":4221440},"matched_basic_blocks":[{"address":{"type":"absolute","value":4221660}},{"address":{"type":"absolute","value":4221701}},{"address":{"type":"absolute","value":4222203}},{"address":{"type":"absolute","value":4222578}},{"address":{"type":"absolute","value":4222630}}]},{"address":{"type":"absolute","value":4221564},"matched_basic_blocks":[{"address":{"type":"absolute","value":4221701}},{"address":{"type":"absolute","value":4222203}},{"address":{"type":"absolute","value":4222578}},{"address":{"type":"absolute","value":4222630}}]},{"address":{"type":"absolute","value":4221613},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4221632},"matched_basic_blocks":[{"address":{"type":"absolute","value":4221701}},{"address":{"type":"absolute","value":4222203}},{"address":{"type":"absolute","value":4222578}},{"address":{"type":"absolute","value":4222630}}]},{"address":{"type":"absolute","value":4222971},"matched_basic_blocks":[{"address":{"type":"absolute","value":4199877}},{"address":{"type":"absolute","value":4199921}},{"address":{"type":"absolute","value":4199981}},{"address":{"type":"absolute","value":4199992}},{"address":{"type":"absolute","value":4200040}}]},{"address":{"type":"absolute","value":4223017},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4223036},"matched_basic_blocks":[{"address":{"type":"absolute","value":4223047}},{"address":{"type":"absolute","value":4223101}},{"address":{"type":"absolute","value":4223154}},{"address":{"type":"absolute","value":4223183}}]},{"address":{"type":"absolute","value":4223228},"matched_basic_blocks":[{"address":{"type":"absolute","value":4223228}},{"address":{"type":"absolute","value":4223299}}]},{"address":{"type":"absolute","value":4223350},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4223436},"matched_basic_blocks":[{"address":{"type":"absolute","value":4223436}},{"address":{"type":"absolute","value":4223506}},{"address":{"type":"absolute","value":4223560}},{"address":{"type":"absolute","value":4223589}},{"address":{"type":"absolute","value":4223624}},{"address":{"type":"absolute","value":4223661}},{"address":{"type":"absolute","value":4223764}},{"address":{"type":"absolute","value":4223788}}]},{"address":{"type":"absolute","value":4223999},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4224048},"matched_basic_blocks":[{"address":{"type":"absolute","value":4224048}},{"address":{"type":"absolute","value":4224095}}]},{"address":{"type":"absolute","value":4224245},"matched_basic_blocks":[{"address":{"type":"absolute","value":4199877}},{"address":{"type":"absolute","value":4199921}},{"address":{"type":"absolute","value":4199981}},{"address":{"type":"absolute","value":4199992}},{"address":{"type":"absolute","value":4200040}}]},{"address":{"type":"absolute","value":4224284},"matched_basic_blocks":[{"address":{"type":"absolute","value":4224284}},{"address":{"type":"absolute","value":4224354}},{"address":{"type":"absolute","value":4224376}},{"address":{"type":"absolute","value":4224397}}]},{"address":{"type":"absolute","value":4224444},"matched_basic_blocks":[{"address":{"type":"absolute","value":4224470}},{"address":{"type":"absolute","value":4224550}},{"address":{"type":"absolute","value":4224566}},{"address":{"type":"absolute","value":4224570}},{"address":{"type":"absolute","value":4224572}},{"address":{"type":"absolute","value":4224576}},{"address":{"type":"absolute","value":4224610}}]},{"address":{"type":"absolute","value":4224539},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]},{"address":{"type":"absolute","value":4224668},"matched_basic_blocks":[{"address":{"type":"absolute","value":4224799}},{"address":{"type":"absolute","value":4225109}},{"address":{"type":"absolute","value":4225282}},{"address":{"type":"absolute","value":4225323}}]},{"address":{"type":"absolute","value":4225400},"matched_basic_blocks":[{"address":{"type":"absolute","value":4200177}}]}]},"feature_counts":{"file":2677,"functions":[{"address":{"type":"absolute","value":4198404},"count":51},{"address":{"type":"absolute","value":4198424},"count":30},{"address":{"type":"absolute","value":4198432},"count":11},{"address":{"type":"absolute","value":4198440},"count":7},{"address":{"type":"absolute","value":4198448},"count":7},{"address":{"type":"absolute","value":4198456},"count":7},{"address":{"type":"absolute","value":4198464},"count":7},{"address":{"type":"absolute","value":4198472},"count":7},{"address":{"type":"absolute","value":4198480},"count":7},{"address":{"type":"absolute","value":4198488},"count":7},{"address":{"type":"absolute","value":4198496},"count":7},{"address":{"type":"absolute","value":4198504},"count":7},{"address":{"type":"absolute","value":4198512},"count":7},{"address":{"type":"absolute","value":4198536},"count":16},{"address":{"type":"absolute","value":4198544},"count":7},{"address":{"type":"absolute","value":4198552},"count":7},{"address":{"type":"absolute","value":4198560},"count":6},{"address":{"type":"absolute","value":4198568},"count":7},{"address":{"type":"absolute","value":4198576},"count":7},{"address":{"type":"absolute","value":4198584},"count":7},{"address":{"type":"absolute","value":4198592},"count":12},{"address":{"type":"absolute","value":4198612},"count":28},{"address":{"type":"absolute","value":4198648},"count":15},{"address":{"type":"absolute","value":4198672},"count":42},{"address":{"type":"absolute","value":4198696},"count":43},{"address":{"type":"absolute","value":4198720},"count":48},{"address":{"type":"absolute","value":4198800},"count":9},{"address":{"type":"absolute","value":4198888},"count":38},{"address":{"type":"absolute","value":4198900},"count":37},{"address":{"type":"absolute","value":4198996},"count":50},{"address":{"type":"absolute","value":4199232},"count":40},{"address":{"type":"absolute","value":4199328},"count":16},{"address":{"type":"absolute","value":4199340},"count":24},{"address":{"type":"absolute","value":4199372},"count":80},{"address":{"type":"absolute","value":4199576},"count":12},{"address":{"type":"absolute","value":4199588},"count":24},{"address":{"type":"absolute","value":4199624},"count":9},{"address":{"type":"absolute","value":4199648},"count":28},{"address":{"type":"absolute","value":4199708},"count":27},{"address":{"type":"absolute","value":4199728},"count":29},{"address":{"type":"absolute","value":4199760},"count":24},{"address":{"type":"absolute","value":4199828},"count":26},{"address":{"type":"absolute","value":4200120},"count":32},{"address":{"type":"absolute","value":4200424},"count":105},{"address":{"type":"absolute","value":4200494},"count":83},{"address":{"type":"absolute","value":4200584},"count":26},{"address":{"type":"absolute","value":4200636},"count":26},{"address":{"type":"absolute","value":4200720},"count":20},{"address":{"type":"absolute","value":4200748},"count":18},{"address":{"type":"absolute","value":4200808},"count":33},{"address":{"type":"absolute","value":4200856},"count":55},{"address":{"type":"absolute","value":4201064},"count":9},{"address":{"type":"absolute","value":4201076},"count":11},{"address":{"type":"absolute","value":4201088},"count":24},{"address":{"type":"absolute","value":4201144},"count":29},{"address":{"type":"absolute","value":4201212},"count":30},{"address":{"type":"absolute","value":4201248},"count":37},{"address":{"type":"absolute","value":4201296},"count":31},{"address":{"type":"absolute","value":4201364},"count":26},{"address":{"type":"absolute","value":4201404},"count":39},{"address":{"type":"absolute","value":4201448},"count":17},{"address":{"type":"absolute","value":4201496},"count":14},{"address":{"type":"absolute","value":4201512},"count":37},{"address":{"type":"absolute","value":4201560},"count":22},{"address":{"type":"absolute","value":4201572},"count":25},{"address":{"type":"absolute","value":4201596},"count":26},{"address":{"type":"absolute","value":4201632},"count":11},{"address":{"type":"absolute","value":4201640},"count":35},{"address":{"type":"absolute","value":4201708},"count":35},{"address":{"type":"absolute","value":4201824},"count":35},{"address":{"type":"absolute","value":4201956},"count":47},{"address":{"type":"absolute","value":4202120},"count":14},{"address":{"type":"absolute","value":4202136},"count":10},{"address":{"type":"absolute","value":4202141},"count":10},{"address":{"type":"absolute","value":4202212},"count":30},{"address":{"type":"absolute","value":4202220},"count":30},{"address":{"type":"absolute","value":4202228},"count":31},{"address":{"type":"absolute","value":4202292},"count":28},{"address":{"type":"absolute","value":4202364},"count":27},{"address":{"type":"absolute","value":4202436},"count":49},{"address":{"type":"absolute","value":4202568},"count":52},{"address":{"type":"absolute","value":4202604},"count":37},{"address":{"type":"absolute","value":4202652},"count":88},{"address":{"type":"absolute","value":4202800},"count":37},{"address":{"type":"absolute","value":4202852},"count":82},{"address":{"type":"absolute","value":4203088},"count":37},{"address":{"type":"absolute","value":4203136},"count":6},{"address":{"type":"absolute","value":4203140},"count":80},{"address":{"type":"absolute","value":4203332},"count":88},{"address":{"type":"absolute","value":4203616},"count":82},{"address":{"type":"absolute","value":4203860},"count":40},{"address":{"type":"absolute","value":4203868},"count":19},{"address":{"type":"absolute","value":4203892},"count":20},{"address":{"type":"absolute","value":4203924},"count":7},{"address":{"type":"absolute","value":4203932},"count":7},{"address":{"type":"absolute","value":4203940},"count":11},{"address":{"type":"absolute","value":4203948},"count":7},{"address":{"type":"absolute","value":4203956},"count":39},{"address":{"type":"absolute","value":4203964},"count":11},{"address":{"type":"absolute","value":4203972},"count":10},{"address":{"type":"absolute","value":4203980},"count":14},{"address":{"type":"absolute","value":4203996},"count":81},{"address":{"type":"absolute","value":4204004},"count":9},{"address":{"type":"absolute","value":4204012},"count":67},{"address":{"type":"absolute","value":4204408},"count":18},{"address":{"type":"absolute","value":4204420},"count":37},{"address":{"type":"absolute","value":4204480},"count":23},{"address":{"type":"absolute","value":4204520},"count":11},{"address":{"type":"absolute","value":4204528},"count":10},{"address":{"type":"absolute","value":4204544},"count":21},{"address":{"type":"absolute","value":4204576},"count":23},{"address":{"type":"absolute","value":4204600},"count":23},{"address":{"type":"absolute","value":4204644},"count":17},{"address":{"type":"absolute","value":4204656},"count":22},{"address":{"type":"absolute","value":4204707},"count":32},{"address":{"type":"absolute","value":4204714},"count":6},{"address":{"type":"absolute","value":4204716},"count":17},{"address":{"type":"absolute","value":4204844},"count":13},{"address":{"type":"absolute","value":4204864},"count":23},{"address":{"type":"absolute","value":4204932},"count":20},{"address":{"type":"absolute","value":4204996},"count":11},{"address":{"type":"absolute","value":4205008},"count":19},{"address":{"type":"absolute","value":4205076},"count":23},{"address":{"type":"absolute","value":4205125},"count":32},{"address":{"type":"absolute","value":4205132},"count":6},{"address":{"type":"absolute","value":4205136},"count":8},{"address":{"type":"absolute","value":4205144},"count":17},{"address":{"type":"absolute","value":4205181},"count":32},{"address":{"type":"absolute","value":4205188},"count":6},{"address":{"type":"absolute","value":4205192},"count":8},{"address":{"type":"absolute","value":4205200},"count":7},{"address":{"type":"absolute","value":4205208},"count":7},{"address":{"type":"absolute","value":4205216},"count":7},{"address":{"type":"absolute","value":4205224},"count":7},{"address":{"type":"absolute","value":4205232},"count":7},{"address":{"type":"absolute","value":4205240},"count":7},{"address":{"type":"absolute","value":4205248},"count":7},{"address":{"type":"absolute","value":4205256},"count":7},{"address":{"type":"absolute","value":4205264},"count":7},{"address":{"type":"absolute","value":4205272},"count":7},{"address":{"type":"absolute","value":4205280},"count":7},{"address":{"type":"absolute","value":4205288},"count":7},{"address":{"type":"absolute","value":4205296},"count":7},{"address":{"type":"absolute","value":4205304},"count":7},{"address":{"type":"absolute","value":4205312},"count":7},{"address":{"type":"absolute","value":4205320},"count":7},{"address":{"type":"absolute","value":4205328},"count":31},{"address":{"type":"absolute","value":4205360},"count":7},{"address":{"type":"absolute","value":4205368},"count":7},{"address":{"type":"absolute","value":4205376},"count":7},{"address":{"type":"absolute","value":4205384},"count":7},{"address":{"type":"absolute","value":4205392},"count":6},{"address":{"type":"absolute","value":4205400},"count":7},{"address":{"type":"absolute","value":4205408},"count":7},{"address":{"type":"absolute","value":4205416},"count":7},{"address":{"type":"absolute","value":4205424},"count":7},{"address":{"type":"absolute","value":4205432},"count":7},{"address":{"type":"absolute","value":4205440},"count":7},{"address":{"type":"absolute","value":4205448},"count":7},{"address":{"type":"absolute","value":4205456},"count":7},{"address":{"type":"absolute","value":4205464},"count":7},{"address":{"type":"absolute","value":4205472},"count":7},{"address":{"type":"absolute","value":4205480},"count":7},{"address":{"type":"absolute","value":4205488},"count":7},{"address":{"type":"absolute","value":4205496},"count":7},{"address":{"type":"absolute","value":4205504},"count":7},{"address":{"type":"absolute","value":4205512},"count":7},{"address":{"type":"absolute","value":4205520},"count":7},{"address":{"type":"absolute","value":4205528},"count":7},{"address":{"type":"absolute","value":4205536},"count":7},{"address":{"type":"absolute","value":4205544},"count":7},{"address":{"type":"absolute","value":4205552},"count":7},{"address":{"type":"absolute","value":4205560},"count":7},{"address":{"type":"absolute","value":4205568},"count":7},{"address":{"type":"absolute","value":4205576},"count":7},{"address":{"type":"absolute","value":4205584},"count":7},{"address":{"type":"absolute","value":4205592},"count":7},{"address":{"type":"absolute","value":4205600},"count":7},{"address":{"type":"absolute","value":4205608},"count":7},{"address":{"type":"absolute","value":4205616},"count":7},{"address":{"type":"absolute","value":4205624},"count":7},{"address":{"type":"absolute","value":4205632},"count":7},{"address":{"type":"absolute","value":4205640},"count":7},{"address":{"type":"absolute","value":4205648},"count":7},{"address":{"type":"absolute","value":4205656},"count":7},{"address":{"type":"absolute","value":4205664},"count":7},{"address":{"type":"absolute","value":4205672},"count":7},{"address":{"type":"absolute","value":4205680},"count":7},{"address":{"type":"absolute","value":4205688},"count":7},{"address":{"type":"absolute","value":4205696},"count":7},{"address":{"type":"absolute","value":4205704},"count":7},{"address":{"type":"absolute","value":4205712},"count":7},{"address":{"type":"absolute","value":4205720},"count":7},{"address":{"type":"absolute","value":4205728},"count":11},{"address":{"type":"absolute","value":4205736},"count":17},{"address":{"type":"absolute","value":4205773},"count":32},{"address":{"type":"absolute","value":4205780},"count":6},{"address":{"type":"absolute","value":4205784},"count":8},{"address":{"type":"absolute","value":4205792},"count":7},{"address":{"type":"absolute","value":4205800},"count":7},{"address":{"type":"absolute","value":4205808},"count":48},{"address":{"type":"absolute","value":4205931},"count":32},{"address":{"type":"absolute","value":4205948},"count":33},{"address":{"type":"absolute","value":4206052},"count":32},{"address":{"type":"absolute","value":4206128},"count":30},{"address":{"type":"absolute","value":4206251},"count":32},{"address":{"type":"absolute","value":4206276},"count":22},{"address":{"type":"absolute","value":4206316},"count":12},{"address":{"type":"absolute","value":4206328},"count":45},{"address":{"type":"absolute","value":4206618},"count":32},{"address":{"type":"absolute","value":4206625},"count":7},{"address":{"type":"absolute","value":4206632},"count":33},{"address":{"type":"absolute","value":4206672},"count":29},{"address":{"type":"absolute","value":4206712},"count":29},{"address":{"type":"absolute","value":4206852},"count":32},{"address":{"type":"absolute","value":4206880},"count":28},{"address":{"type":"absolute","value":4207003},"count":32},{"address":{"type":"absolute","value":4207020},"count":17},{"address":{"type":"absolute","value":4207057},"count":32},{"address":{"type":"absolute","value":4207064},"count":6},{"address":{"type":"absolute","value":4207068},"count":8},{"address":{"type":"absolute","value":4207080},"count":68},{"address":{"type":"absolute","value":4207152},"count":20},{"address":{"type":"absolute","value":4207168},"count":35},{"address":{"type":"absolute","value":4207294},"count":32},{"address":{"type":"absolute","value":4207301},"count":7},{"address":{"type":"absolute","value":4207312},"count":27},{"address":{"type":"absolute","value":4207360},"count":36},{"address":{"type":"absolute","value":4207476},"count":20},{"address":{"type":"absolute","value":4207528},"count":42},{"address":{"type":"absolute","value":4207686},"count":32},{"address":{"type":"absolute","value":4207693},"count":7},{"address":{"type":"absolute","value":4207740},"count":28},{"address":{"type":"absolute","value":4207873},"count":32},{"address":{"type":"absolute","value":4207880},"count":6},{"address":{"type":"absolute","value":4207884},"count":43},{"address":{"type":"absolute","value":4208058},"count":32},{"address":{"type":"absolute","value":4208084},"count":42},{"address":{"type":"absolute","value":4208196},"count":58},{"address":{"type":"absolute","value":4208308},"count":10},{"address":{"type":"absolute","value":4208320},"count":68},{"address":{"type":"absolute","value":4208622},"count":32},{"address":{"type":"absolute","value":4208629},"count":7},{"address":{"type":"absolute","value":4208636},"count":96},{"address":{"type":"absolute","value":4209142},"count":32},{"address":{"type":"absolute","value":4209149},"count":9},{"address":{"type":"absolute","value":4209160},"count":23},{"address":{"type":"absolute","value":4209200},"count":71},{"address":{"type":"absolute","value":4209477},"count":32},{"address":{"type":"absolute","value":4209484},"count":7},{"address":{"type":"absolute","value":4209496},"count":17},{"address":{"type":"absolute","value":4209544},"count":53},{"address":{"type":"absolute","value":4209716},"count":57},{"address":{"type":"absolute","value":4209748},"count":69},{"address":{"type":"absolute","value":4209776},"count":17},{"address":{"type":"absolute","value":4209813},"count":32},{"address":{"type":"absolute","value":4209820},"count":6},{"address":{"type":"absolute","value":4209824},"count":8},{"address":{"type":"absolute","value":4209832},"count":44},{"address":{"type":"absolute","value":4209960},"count":78},{"address":{"type":"absolute","value":4210420},"count":17},{"address":{"type":"absolute","value":4210457},"count":32},{"address":{"type":"absolute","value":4210464},"count":6},{"address":{"type":"absolute","value":4210468},"count":8},{"address":{"type":"absolute","value":4210476},"count":52},{"address":{"type":"absolute","value":4210840},"count":53},{"address":{"type":"absolute","value":4210900},"count":49},{"address":{"type":"absolute","value":4210952},"count":45},{"address":{"type":"absolute","value":4211112},"count":17},{"address":{"type":"absolute","value":4211144},"count":17},{"address":{"type":"absolute","value":4211176},"count":17},{"address":{"type":"absolute","value":4211208},"count":17},{"address":{"type":"absolute","value":4211245},"count":32},{"address":{"type":"absolute","value":4211252},"count":6},{"address":{"type":"absolute","value":4211256},"count":8},{"address":{"type":"absolute","value":4211264},"count":7},{"address":{"type":"absolute","value":4211272},"count":17},{"address":{"type":"absolute","value":4211309},"count":32},{"address":{"type":"absolute","value":4211316},"count":6},{"address":{"type":"absolute","value":4211320},"count":8},{"address":{"type":"absolute","value":4211328},"count":28},{"address":{"type":"absolute","value":4211396},"count":17},{"address":{"type":"absolute","value":4211433},"count":32},{"address":{"type":"absolute","value":4211440},"count":6},{"address":{"type":"absolute","value":4211444},"count":8},{"address":{"type":"absolute","value":4211452},"count":17},{"address":{"type":"absolute","value":4211489},"count":32},{"address":{"type":"absolute","value":4211496},"count":6},{"address":{"type":"absolute","value":4211500},"count":8},{"address":{"type":"absolute","value":4211508},"count":7},{"address":{"type":"absolute","value":4211516},"count":7},{"address":{"type":"absolute","value":4211524},"count":7},{"address":{"type":"absolute","value":4211532},"count":7},{"address":{"type":"absolute","value":4211540},"count":7},{"address":{"type":"absolute","value":4211548},"count":7},{"address":{"type":"absolute","value":4211556},"count":17},{"address":{"type":"absolute","value":4211593},"count":32},{"address":{"type":"absolute","value":4211600},"count":6},{"address":{"type":"absolute","value":4211604},"count":8},{"address":{"type":"absolute","value":4211612},"count":33},{"address":{"type":"absolute","value":4211673},"count":74},{"address":{"type":"absolute","value":4211692},"count":43},{"address":{"type":"absolute","value":4211919},"count":32},{"address":{"type":"absolute","value":4211926},"count":7},{"address":{"type":"absolute","value":4211936},"count":55},{"address":{"type":"absolute","value":4212143},"count":32},{"address":{"type":"absolute","value":4212150},"count":7},{"address":{"type":"absolute","value":4212160},"count":42},{"address":{"type":"absolute","value":4212303},"count":32},{"address":{"type":"absolute","value":4212320},"count":12},{"address":{"type":"absolute","value":4212368},"count":68},{"address":{"type":"absolute","value":4213047},"count":32},{"address":{"type":"absolute","value":4213054},"count":7},{"address":{"type":"absolute","value":4213136},"count":43},{"address":{"type":"absolute","value":4213450},"count":74},{"address":{"type":"absolute","value":4213624},"count":33},{"address":{"type":"absolute","value":4213704},"count":28},{"address":{"type":"absolute","value":4213776},"count":22},{"address":{"type":"absolute","value":4213860},"count":13},{"address":{"type":"absolute","value":4214192},"count":47},{"address":{"type":"absolute","value":4214408},"count":32},{"address":{"type":"absolute","value":4214415},"count":7},{"address":{"type":"absolute","value":4214448},"count":28},{"address":{"type":"absolute","value":4214592},"count":32},{"address":{"type":"absolute","value":4214599},"count":7},{"address":{"type":"absolute","value":4214628},"count":38},{"address":{"type":"absolute","value":4214640},"count":31},{"address":{"type":"absolute","value":4214731},"count":32},{"address":{"type":"absolute","value":4214738},"count":7},{"address":{"type":"absolute","value":4214768},"count":25},{"address":{"type":"absolute","value":4214844},"count":16},{"address":{"type":"absolute","value":4214956},"count":28},{"address":{"type":"absolute","value":4215028},"count":30},{"address":{"type":"absolute","value":4215068},"count":14},{"address":{"type":"absolute","value":4215085},"count":13},{"address":{"type":"absolute","value":4215096},"count":31},{"address":{"type":"absolute","value":4215203},"count":32},{"address":{"type":"absolute","value":4215236},"count":31},{"address":{"type":"absolute","value":4215343},"count":32},{"address":{"type":"absolute","value":4215368},"count":67},{"address":{"type":"absolute","value":4215380},"count":29},{"address":{"type":"absolute","value":4215454},"count":54},{"address":{"type":"absolute","value":4215480},"count":43},{"address":{"type":"absolute","value":4215628},"count":32},{"address":{"type":"absolute","value":4215635},"count":9},{"address":{"type":"absolute","value":4215648},"count":87},{"address":{"type":"absolute","value":4216362},"count":32},{"address":{"type":"absolute","value":4216369},"count":7},{"address":{"type":"absolute","value":4216744},"count":17},{"address":{"type":"absolute","value":4216776},"count":46},{"address":{"type":"absolute","value":4216864},"count":11},{"address":{"type":"absolute","value":4216872},"count":29},{"address":{"type":"absolute","value":4217008},"count":32},{"address":{"type":"absolute","value":4217015},"count":7},{"address":{"type":"absolute","value":4217024},"count":94},{"address":{"type":"absolute","value":4218168},"count":32},{"address":{"type":"absolute","value":4218175},"count":7},{"address":{"type":"absolute","value":4218240},"count":38},{"address":{"type":"absolute","value":4218450},"count":32},{"address":{"type":"absolute","value":4218457},"count":9},{"address":{"type":"absolute","value":4218464},"count":39},{"address":{"type":"absolute","value":4218629},"count":32},{"address":{"type":"absolute","value":4218636},"count":9},{"address":{"type":"absolute","value":4218648},"count":29},{"address":{"type":"absolute","value":4218700},"count":66},{"address":{"type":"absolute","value":4219047},"count":32},{"address":{"type":"absolute","value":4219054},"count":7},{"address":{"type":"absolute","value":4219092},"count":68},{"address":{"type":"absolute","value":4219112},"count":27},{"address":{"type":"absolute","value":4219164},"count":36},{"address":{"type":"absolute","value":4219180},"count":21},{"address":{"type":"absolute","value":4219200},"count":59},{"address":{"type":"absolute","value":4219292},"count":43},{"address":{"type":"absolute","value":4219490},"count":32},{"address":{"type":"absolute","value":4219497},"count":7},{"address":{"type":"absolute","value":4219636},"count":31},{"address":{"type":"absolute","value":4219920},"count":64},{"address":{"type":"absolute","value":4220337},"count":32},{"address":{"type":"absolute","value":4220344},"count":29},{"address":{"type":"absolute","value":4220407},"count":32},{"address":{"type":"absolute","value":4220414},"count":7},{"address":{"type":"absolute","value":4220436},"count":29},{"address":{"type":"absolute","value":4220608},"count":32},{"address":{"type":"absolute","value":4220615},"count":7},{"address":{"type":"absolute","value":4220624},"count":28},{"address":{"type":"absolute","value":4220747},"count":32},{"address":{"type":"absolute","value":4220764},"count":39},{"address":{"type":"absolute","value":4220905},"count":32},{"address":{"type":"absolute","value":4220912},"count":6},{"address":{"type":"absolute","value":4220916},"count":45},{"address":{"type":"absolute","value":4221291},"count":32},{"address":{"type":"absolute","value":4221298},"count":7},{"address":{"type":"absolute","value":4221400},"count":196},{"address":{"type":"absolute","value":4221424},"count":195},{"address":{"type":"absolute","value":4221440},"count":192},{"address":{"type":"absolute","value":4221564},"count":187},{"address":{"type":"absolute","value":4221576},"count":17},{"address":{"type":"absolute","value":4221613},"count":32},{"address":{"type":"absolute","value":4221620},"count":6},{"address":{"type":"absolute","value":4221624},"count":8},{"address":{"type":"absolute","value":4221632},"count":178},{"address":{"type":"absolute","value":4222971},"count":74},{"address":{"type":"absolute","value":4223017},"count":32},{"address":{"type":"absolute","value":4223024},"count":7},{"address":{"type":"absolute","value":4223036},"count":68},{"address":{"type":"absolute","value":4223140},"count":36},{"address":{"type":"absolute","value":4223228},"count":38},{"address":{"type":"absolute","value":4223350},"count":32},{"address":{"type":"absolute","value":4223357},"count":7},{"address":{"type":"absolute","value":4223436},"count":66},{"address":{"type":"absolute","value":4223999},"count":32},{"address":{"type":"absolute","value":4224006},"count":7},{"address":{"type":"absolute","value":4224048},"count":53},{"address":{"type":"absolute","value":4224245},"count":74},{"address":{"type":"absolute","value":4224284},"count":62},{"address":{"type":"absolute","value":4224444},"count":42},{"address":{"type":"absolute","value":4224508},"count":16},{"address":{"type":"absolute","value":4224539},"count":32},{"address":{"type":"absolute","value":4224546},"count":6},{"address":{"type":"absolute","value":4224668},"count":75},{"address":{"type":"absolute","value":4225400},"count":32},{"address":{"type":"absolute","value":4225407},"count":8}]},"library_functions":[{"address":{"type":"absolute","value":4204856},"name":"?"}]}},"rules":{"calculate modulo 256 via x86 assembly":{"meta":{"name":"calculate modulo 256 via x86 assembly","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"instruction"},"attack":[],"mbc":[{"parts":["Data","Modulo"],"objective":"Data","behavior":"Modulo","method":"","id":"C0058"}],"references":[],"examples":["9324D1A8AE37A36AE560C37448C9705A:0x4049A9"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: calculate modulo 256 via x86 assembly\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: instruction\n      dynamic: unsupported  # requires mnemonic features\n    mbc:\n      - Data::Modulo [C0058]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4049A9\n  features:\n    #  and ecx, 800000FFh\n    #  and ecx, 0FFh\n    - and:\n      - or:\n        - arch: i386\n        - arch: amd64\n      - mnemonic: and\n      - or:\n        - number: 0x800000FF\n        - number: 0xFF\n","matches":[[{"type":"absolute","value":4200407},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4200407}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4200407}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4200407},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4200407}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4200407}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223610},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4223610}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[{"type":"absolute","value":4223610}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223637},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4223637}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4223637}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223748},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4223748}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[{"type":"absolute","value":4223748}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223774},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4223774}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[{"type":"absolute","value":4223774}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223815},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4223815}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4223815}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223847},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4223847}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[{"type":"absolute","value":4223847}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"create or open mutex on Windows":{"meta":{"name":"create or open mutex on Windows","namespace":"host-interaction/mutex","authors":["moritz.raabe@mandiant.com","anushka.virgaonkar@mandiant.com","mehunhoff@google.com"],"scopes":{"static":"instruction","dynamic":"call"},"attack":[],"mbc":[{"parts":["Process","Create Mutex"],"objective":"Process","behavior":"Create Mutex","method":"","id":"C0042"}],"references":[],"examples":["Practical Malware Analysis Lab 01-01.dll_:0x10001010"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: create or open mutex on Windows\n    namespace: host-interaction/mutex\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n      - mehunhoff@google.com\n    scopes:\n      static: instruction\n      dynamic: call\n    mbc:\n      - Process::Create Mutex [C0042]\n    examples:\n      - Practical Malware Analysis Lab 01-01.dll_:0x10001010\n  features:\n    - or:\n      - api: kernel32.OpenMutex\n      - api: kernel32.CreateMutex\n      - api: kernel32.CreateMutexEx\n      - api: ntdll.NtCreateMutant\n      - api: ntdll.NtOpenMutant\n      - and:\n        - format: dotnet\n        - or:\n          - api: System.Threading.Mutex::ctor\n          - api: System.Threading.Mutex::OpenExisting\n          - api: System.Threading.Mutex::TryOpenExisting\n","matches":[[{"type":"absolute","value":4205350},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"OpenMutex"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateMutex"}},"children":[],"locations":[{"type":"absolute","value":4205350}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateMutexEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateMutant"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenMutant"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"format","format":"dotnet"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Mutex::ctor"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Mutex::OpenExisting"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Mutex::TryOpenExisting"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"write process memory":{"meta":{"name":"write process memory","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"instruction","dynamic":"call"},"attack":[{"parts":["Defense Evasion","Process Injection"],"tactic":"Defense Evasion","technique":"Process Injection","subtechnique":"","id":"T1055"}],"mbc":[],"references":[],"examples":["2D3EDC218A90F03089CC01715A9F047F:0x4027CF"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: write process memory\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: instruction\n      dynamic: call\n    att&ck:\n      - Defense Evasion::Process Injection [T1055]\n    examples:\n      - 2D3EDC218A90F03089CC01715A9F047F:0x4027CF\n  features:\n    - or:\n      - api: kernel32.WriteProcessMemory\n      - api: ntdll.NtWriteVirtualMemory\n      - api: ntdll.ZwWriteVirtualMemory\n      - api: NtWow64WriteVirtualMemory64\n","matches":[[{"type":"absolute","value":4207262},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"WriteProcessMemory"}},"children":[],"locations":[{"type":"absolute","value":4207262}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWow64WriteVirtualMemory64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207262},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"WriteProcessMemory"}},"children":[],"locations":[{"type":"absolute","value":4207262}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWow64WriteVirtualMemory64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207346},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"WriteProcessMemory"}},"children":[],"locations":[{"type":"absolute","value":4207346}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWow64WriteVirtualMemory64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209416},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"WriteProcessMemory"}},"children":[],"locations":[{"type":"absolute","value":4209416}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWow64WriteVirtualMemory64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218901},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"WriteProcessMemory"}},"children":[],"locations":[{"type":"absolute","value":4218901}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWow64WriteVirtualMemory64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218937},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"WriteProcessMemory"}},"children":[],"locations":[{"type":"absolute","value":4218937}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWow64WriteVirtualMemory64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218986},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"WriteProcessMemory"}},"children":[],"locations":[{"type":"absolute","value":4218986}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWow64WriteVirtualMemory64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"link function at runtime on Windows":{"meta":{"name":"link function at runtime on Windows","namespace":"linking/runtime-linking","authors":["moritz.raabe@mandiant.com","mehunhoff@google.com"],"scopes":{"static":"instruction","dynamic":"call"},"attack":[{"parts":["Execution","Shared Modules"],"tactic":"Execution","technique":"Shared Modules","subtechnique":"","id":"T1129"}],"mbc":[],"references":[],"examples":["9324D1A8AE37A36AE560C37448C9705A:0x404130","Practical Malware Analysis Lab 01-04.exe_:0x401350"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: link function at runtime on Windows\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - mehunhoff@google.com\n    scopes:\n      static: instruction\n      dynamic: call\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404130\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - and:\n      - os: windows\n      - or:\n        - api: kernel32.GetProcAddress\n        - api: ntdll.LdrGetProcedureAddress\n        - api: ntdll.LdrGetProcedureAddressEx\n        - api: ntdll.LdrGetProcedureAddressForCaller\n        - api: MmGetSystemRoutineAddress\n","matches":[[{"type":"absolute","value":4207581},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4207581}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207605},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4207605}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209575},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4209575}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209600},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4209600}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209625},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4209625}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4210520},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4210520}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4210538},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4210538}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4210556},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4210556}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4210574},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4210574}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4210592},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4210592}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4210610},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4210610}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4210628},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4210628}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4210646},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4210646}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4210664},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4210664}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4210682},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4210682}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4210700},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4210700}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4210718},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4210718}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4210736},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4210736}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4210754},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4210754}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4210772},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4210772}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4210790},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4210790}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4214788},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4214788}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218760},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4218760}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218784},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4218784}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218808},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4218808}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4224312},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4224312}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4224341},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetProcAddress"}},"children":[],"locations":[{"type":"absolute","value":4224341}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrGetProcedureAddressForCaller"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MmGetSystemRoutineAddress"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"create or open file":{"meta":{"name":"create or open file","authors":["michael.hunhoff@mandiant.com","joakim@intezer.com"],"scopes":{"static":"instruction","dynamic":"call"},"attack":[],"mbc":[{"parts":["File System","Create File"],"objective":"File System","behavior":"Create File","method":"","id":"C0016"}],"references":[],"examples":["B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: create or open file\n    authors:\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n    lib: true\n    scopes:\n      static: instruction\n      dynamic: call\n    mbc:\n      - File System::Create File [C0016]\n    examples:\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x401D7E\n  features:\n    - or:\n      - api: CreateFile\n      - api: CreateFileEx\n      - api: IoCreateFile\n      - api: IoCreateFileEx\n      - api: ZwOpenFile\n      - api: ZwCreateFile\n      - api: NtOpenFile\n      - api: NtCreateFile\n      - api: LZCreateFile\n      - api: LZOpenFile\n      - api: fopen\n      - api: fopen64\n      - api: fdopen\n      - api: freopen\n      - api: open\n      - api: openat\n","matches":[[{"type":"absolute","value":4216854},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateFile"}},"children":[],"locations":[{"type":"absolute","value":4216854}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"IoCreateFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZCreateFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZOpenFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fopen64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fdopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"freopen"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"open"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"openat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"find graphical window":{"meta":{"name":"find graphical window","namespace":"host-interaction/gui/window/find","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"instruction","dynamic":"call"},"attack":[{"parts":["Discovery","Application Window Discovery"],"tactic":"Discovery","technique":"Application Window Discovery","subtechnique":"","id":"T1010"}],"mbc":[],"references":[],"examples":["7C843E75D4F02087B932FE280DF9C90C:0x41B180"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: find graphical window\n    namespace: host-interaction/gui/window/find\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: instruction\n      dynamic: call\n    att&ck:\n      - Discovery::Application Window Discovery [T1010]\n    examples:\n      - 7C843E75D4F02087B932FE280DF9C90C:0x41B180\n  features:\n    - or:\n      - api: user32.FindWindow\n      - api: user32.FindWindowEx\n","matches":[[{"type":"absolute","value":4219121},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"FindWindow"}},"children":[],"locations":[{"type":"absolute","value":4219121}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"FindWindowEx"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"modify access privileges":{"meta":{"name":"modify access privileges","namespace":"host-interaction/process/modify","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"instruction","dynamic":"call"},"attack":[{"parts":["Privilege Escalation","Access Token Manipulation"],"tactic":"Privilege Escalation","technique":"Access Token Manipulation","subtechnique":"","id":"T1134"}],"mbc":[],"references":[],"examples":["9324D1A8AE37A36AE560C37448C9705A:0x403BE0"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: modify access privileges\n    namespace: host-interaction/process/modify\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: instruction\n      dynamic: call\n    att&ck:\n      - Privilege Escalation::Access Token Manipulation [T1134]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x403BE0\n  features:\n    - and:\n      - api: advapi32.AdjustTokenPrivileges\n","matches":[[{"type":"absolute","value":4224182},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"AdjustTokenPrivileges"}},"children":[],"locations":[{"type":"absolute","value":4224182}],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4224221},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"AdjustTokenPrivileges"}},"children":[],"locations":[{"type":"absolute","value":4224221}],"captures":{}}],"locations":[],"captures":{}}]]},"create thread":{"meta":{"name":"create thread","namespace":"host-interaction/thread/create","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com","joakim@intezer.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"basic block","dynamic":"span of calls"},"attack":[],"mbc":[{"parts":["Process","Create Thread"],"objective":"Process","behavior":"Create Thread","method":"","id":"C0038"}],"references":[],"examples":["946A99F36A46D335DEC080D9A4371940:0x10001DA0","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: create thread\n    namespace: host-interaction/thread/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: span of calls\n    mbc:\n      - Process::Create Thread [C0038]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x10001DA0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x408020\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.CreateThread\n          - api: _beginthread\n          - api: _beginthreadex\n          - api: PsCreateSystemThread\n          - api: SHCreateThread\n          - api: SHCreateThreadWithHandle\n          - api: kernel32.CreateRemoteThread\n          - api: kernel32.CreateRemoteThreadEx\n          - api: RtlCreateUserThread\n          - api: ntdll.NtCreateThread\n          - api: ntdll.NtCreateThreadEx\n          - api: ntdll.ZwCreateThread\n          - api: ntdll.ZwCreateThreadEx\n      - and:\n        - or:\n          - os: linux\n          - os: android\n        - api: pthread_create\n      - and:\n        - api: System.Threading.Thread::Start\n        - optional:\n          - api: System.Threading.Thread::ctor\n","matches":[[{"type":"absolute","value":4198543},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"pthread_create"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Thread::Start"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Thread::ctor"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateThread"}},"children":[],"locations":[{"type":"absolute","value":4198552}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_beginthread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_beginthreadex"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"PsCreateSystemThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateThreadWithHandle"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateRemoteThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateRemoteThreadEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateUserThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateThreadEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateThreadEx"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4198536},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"pthread_create"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Thread::Start"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Thread::ctor"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateThread"}},"children":[],"locations":[{"type":"absolute","value":4198552}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_beginthread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_beginthreadex"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"PsCreateSystemThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateThreadWithHandle"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateRemoteThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateRemoteThreadEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateUserThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateThreadEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateThreadEx"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201144},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"pthread_create"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Thread::Start"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Thread::ctor"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateThread"}},"children":[],"locations":[{"type":"absolute","value":4201198}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_beginthread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_beginthreadex"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"PsCreateSystemThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateThreadWithHandle"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateRemoteThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateRemoteThreadEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateUserThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateThreadEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateThreadEx"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207360},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"pthread_create"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Thread::Start"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Thread::ctor"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_beginthread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_beginthreadex"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"PsCreateSystemThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateThreadWithHandle"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateRemoteThread"}},"children":[],"locations":[{"type":"absolute","value":4207422}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateRemoteThreadEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateUserThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateThreadEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateThreadEx"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4219000},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"pthread_create"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Thread::Start"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Thread::ctor"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_beginthread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_beginthreadex"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"PsCreateSystemThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateThreadWithHandle"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateRemoteThread"}},"children":[],"locations":[{"type":"absolute","value":4219013}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateRemoteThreadEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateUserThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateThreadEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateThreadEx"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"set file attributes":{"meta":{"name":"set file attributes","namespace":"host-interaction/file-system/meta","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[{"parts":["Defense Evasion","File and Directory Permissions Modification"],"tactic":"Defense Evasion","technique":"File and Directory Permissions Modification","subtechnique":"","id":"T1222"}],"mbc":[{"parts":["File System","Set File Attributes"],"objective":"File System","behavior":"Set File Attributes","method":"","id":"C0050"}],"references":[],"examples":["946A99F36A46D335DEC080D9A4371940:0x100015f0","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: set file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    att&ck:\n      - Defense Evasion::File and Directory Permissions Modification [T1222]\n    mbc:\n      - File System::Set File Attributes [C0050]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015f0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n  features:\n    - or:\n      - api: kernel32.SetFileAttributes\n      - api: ZwSetInformationFile\n      - api: NtSetInformationFile\n      - api: System.IO.File::SetAttributes\n      - api: System.IO.File::SetCreationTime\n      - api: System.IO.File::SetCreationTimeUtc\n      - api: System.IO.File::SetLastAccessTime\n      - api: System.IO.File::SetLastAccessTimeUtc\n      - api: System.IO.File::SetLastWriteTime\n      - api: System.IO.File::SetLastWriteTimeUtc\n      - property/write: System.IO.FileSystemInfo::Attributes\n      - api: utime\n      - api: utimes\n","matches":[[{"type":"absolute","value":4205858},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"SetFileAttributes"}},"children":[],"locations":[{"type":"absolute","value":4205861}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwSetInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtSetInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetAttributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetCreationTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetCreationTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetLastAccessTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetLastAccessTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetLastWriteTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetLastWriteTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"write","property":"System.IO.FileSystemInfo::Attributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"utime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"utimes"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4217635},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"SetFileAttributes"}},"children":[],"locations":[{"type":"absolute","value":4217752}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwSetInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtSetInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetAttributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetCreationTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetCreationTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetLastAccessTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetLastAccessTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetLastWriteTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::SetLastWriteTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"write","property":"System.IO.FileSystemInfo::Attributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"utime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"utimes"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"allocate memory":{"meta":{"name":"allocate memory","authors":["0x534a@mailbox.org","@mr-tz"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Memory","Allocate Memory"],"objective":"Memory","behavior":"Allocate Memory","method":"","id":"C0007"}],"references":[],"examples":["Practical Malware Analysis Lab 03-03.exe_:0x4010EA","563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: allocate memory\n    authors:\n      - 0x534a@mailbox.org\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA  # ntdll.NtAllocateVirtualMemory\n  features:\n    - or:\n      - api: kernel32.VirtualAlloc\n      - api: kernel32.VirtualAllocEx\n      - api: kernel32.VirtualAllocExNuma\n      - api: NtAllocateVirtualMemory\n      - api: ZwAllocateVirtualMemory\n      - api: NtMapViewOfSection\n      - api: ZwMapViewOfSection\n      - basic block:\n        - and:\n          - match: link function at runtime on Windows\n          - or:\n            - string: \"VirtualAlloc\"\n            - string: \"VirtualAllocEx\"\n            - string: \"VirtualAllocExNuma\"\n            - string: \"NtAllocateVirtualMemory\"\n            - string: \"ZwAllocateVirtualMemory\"\n            - string: \"NtMapViewOfSection\"\n            - string: \"ZwMapViewOfSection\"\n","matches":[[{"type":"absolute","value":4207200},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[{"type":"absolute","value":4207228}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207200},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[{"type":"absolute","value":4207228}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207312},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[{"type":"absolute","value":4207334}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208636},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[{"type":"absolute","value":4208761},{"type":"absolute","value":4208723}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208872},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[{"type":"absolute","value":4208891}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209278},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[{"type":"absolute","value":4209301}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209312},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[{"type":"absolute","value":4209346}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218744},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[{"type":"absolute","value":4218918},{"type":"absolute","value":4218846}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218948},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[{"type":"absolute","value":4218963}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"allocate or change RWX memory":{"meta":{"name":"allocate or change RWX memory","namespace":"host-interaction/process/inject","authors":["@mr-tz","mehunhoff@google.com"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Memory","Allocate Memory"],"objective":"Memory","behavior":"Allocate Memory","method":"","id":"C0007"}],"references":[],"examples":["Practical Malware Analysis Lab 03-03.exe_:0x4010EA","563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: allocate or change RWX memory\n    namespace: host-interaction/process/inject\n    authors:\n      - \"@mr-tz\"\n      - mehunhoff@google.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - basic block:\n        - and:\n          - or:\n            - match: allocate memory\n            - match: change memory protection\n          - or:\n            - number: 0x40 = PAGE_EXECUTE_READWRITE\n            # lea     r9d, [rcx+40h]  ; flProtect\n            # call    cs:VirtualAlloc\n            - instruction:\n              - mnemonic: lea\n              - offset: 0x40 = PAGE_EXECUTE_READWRITE\n      - call:\n        - and:\n          - or:\n            - match: allocate memory\n            - match: change memory protection\n          - number: 0x40 = PAGE_EXECUTE_READWRITE\n","matches":[[{"type":"absolute","value":4207312},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[{"type":"absolute","value":4207334}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4207312}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":64,"description":"PAGE_EXECUTE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":4207323}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/6c2c434a278b4b1b9489b3bac72ff5d9/169a9469648947a5abf30e3d2c455873"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4207312}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/efde64e8d4064c3d933c2c1ba9650038"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209278},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[{"type":"absolute","value":4209301}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4209278}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":64,"description":"PAGE_EXECUTE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":4209284}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/6c2c434a278b4b1b9489b3bac72ff5d9/169a9469648947a5abf30e3d2c455873"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4209278}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/efde64e8d4064c3d933c2c1ba9650038"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209312},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[{"type":"absolute","value":4209346}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4209312}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":64,"description":"PAGE_EXECUTE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":4209325}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/6c2c434a278b4b1b9489b3bac72ff5d9/169a9469648947a5abf30e3d2c455873"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4209312}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/efde64e8d4064c3d933c2c1ba9650038"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218744},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[{"type":"absolute","value":4218918},{"type":"absolute","value":4218846}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218744}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":64,"description":"PAGE_EXECUTE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":4218816},{"type":"absolute","value":4218906}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/6c2c434a278b4b1b9489b3bac72ff5d9/169a9469648947a5abf30e3d2c455873"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218744}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/efde64e8d4064c3d933c2c1ba9650038"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218948},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[{"type":"absolute","value":4218963}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218948}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":64,"description":"PAGE_EXECUTE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":4218948}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/6c2c434a278b4b1b9489b3bac72ff5d9/169a9469648947a5abf30e3d2c455873"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218948}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/efde64e8d4064c3d933c2c1ba9650038"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"delay execution":{"meta":{"name":"delay execution","authors":["michael.hunhoff@mandiant.com","@ramen0x3f"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Anti-Behavioral Analysis","Dynamic Analysis Evasion","Delayed Execution"],"objective":"Anti-Behavioral Analysis","behavior":"Dynamic Analysis Evasion","method":"Delayed Execution","id":"B0003.003"}],"references":["https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions","https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp"],"examples":["al-khaser_x86.exe_:0x449770","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: delay execution\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@ramen0x3f\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Anti-Behavioral Analysis::Dynamic Analysis Evasion::Delayed Execution [B0003.003]\n    references:\n      - https://docs.microsoft.com/en-us/windows/win32/sync/wait-functions\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/TimingAttacks/timing.cpp\n    examples:\n      - al-khaser_x86.exe_:0x449770\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402FA6\n  features:\n    - or:\n      - and:\n        - os: windows\n        - or:\n          - api: kernel32.Sleep\n          - api: kernel32.SleepEx\n          - api: kernel32.WaitForSingleObject\n          - api: kernel32.SignalObjectAndWait\n          - api: kernel32.WaitForSingleObjectEx\n          - api: kernel32.WaitForMultipleObjects\n          - api: kernel32.WaitForMultipleObjectsEx\n          - api: kernel32.RegisterWaitForSingleObject\n          - api: WaitOnAddress\n          - api: user32.MsgWaitForMultipleObjects\n          - api: user32.MsgWaitForMultipleObjectsEx\n          - api: NtDelayExecution\n          - api: KeWaitForSingleObject\n          - api: KeDelayExecutionThread\n      - and:\n        - or:\n          - os: linux\n          - os: android\n        - or:\n          - api: sleep\n          - api: usleep\n","matches":[[{"type":"absolute","value":4207435},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"usleep"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SleepEx"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObject"}},"children":[],"locations":[{"type":"absolute","value":4207438}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SignalObjectAndWait"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObjectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegisterWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitOnAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDelayExecution"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeDelayExecutionThread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209686},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"usleep"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SleepEx"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObject"}},"children":[],"locations":[{"type":"absolute","value":4209689}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SignalObjectAndWait"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObjectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegisterWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitOnAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDelayExecution"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeDelayExecutionThread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4212060},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"usleep"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"Sleep"}},"children":[],"locations":[{"type":"absolute","value":4212067}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SleepEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SignalObjectAndWait"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObjectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegisterWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitOnAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDelayExecution"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeDelayExecutionThread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4214956},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"usleep"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"Sleep"}},"children":[],"locations":[{"type":"absolute","value":4214973},{"type":"absolute","value":4214990}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SleepEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SignalObjectAndWait"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObjectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegisterWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitOnAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDelayExecution"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeDelayExecutionThread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4216304},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"usleep"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"Sleep"}},"children":[],"locations":[{"type":"absolute","value":4216309}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SleepEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SignalObjectAndWait"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObjectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegisterWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitOnAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDelayExecution"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeDelayExecutionThread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4222630},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"usleep"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"Sleep"}},"children":[],"locations":[{"type":"absolute","value":4222632}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SleepEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SignalObjectAndWait"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObjectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegisterWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitOnAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDelayExecution"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeDelayExecutionThread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4222630},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"usleep"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"Sleep"}},"children":[],"locations":[{"type":"absolute","value":4222632}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SleepEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SignalObjectAndWait"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObjectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegisterWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitOnAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDelayExecution"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeDelayExecutionThread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4222630},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"usleep"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"Sleep"}},"children":[],"locations":[{"type":"absolute","value":4222632}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SleepEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SignalObjectAndWait"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObjectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegisterWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitOnAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDelayExecution"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeDelayExecutionThread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4222630},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"usleep"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"Sleep"}},"children":[],"locations":[{"type":"absolute","value":4222632}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SleepEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SignalObjectAndWait"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObjectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegisterWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitOnAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDelayExecution"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeDelayExecutionThread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4222630},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"usleep"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"Sleep"}},"children":[],"locations":[{"type":"absolute","value":4222632}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SleepEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SignalObjectAndWait"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObjectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegisterWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitOnAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDelayExecution"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeDelayExecutionThread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223299},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"sleep"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"usleep"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"Sleep"}},"children":[],"locations":[{"type":"absolute","value":4223323}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SleepEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SignalObjectAndWait"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForSingleObjectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegisterWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WaitOnAddress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjects"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MsgWaitForMultipleObjectsEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDelayExecution"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeWaitForSingleObject"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"KeDelayExecutionThread"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"change memory protection":{"meta":{"name":"change memory protection","authors":["@mr-tz"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Memory","Change Memory Protection"],"objective":"Memory","behavior":"Change Memory Protection","method":"","id":"C0008"}],"references":[],"examples":["Practical Malware Analysis Lab 11-02.dll_:0x10001203"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: change memory protection\n    authors:\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Memory::Change Memory Protection [C0008]\n    examples:\n      - Practical Malware Analysis Lab 11-02.dll_:0x10001203\n  features:\n    - or:\n      - api: kernel32.VirtualProtect\n      - api: kernel32.VirtualProtectEx\n      - api: NtProtectVirtualMemory\n      - api: ZwProtectVirtualMemory\n      - basic block:\n        - and:\n          - match: link function at runtime on Windows\n          - or:\n            - string: \"VirtualProtect\"\n            - string: \"VirtualProtectEx\"\n            - string: \"NtProtectVirtualMemory\"\n            - string: \"ZwProtectVirtualMemory\"\n","matches":[[{"type":"absolute","value":4208636},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualProtect"}},"children":[],"locations":[{"type":"absolute","value":4208803}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualProtectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtProtectVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwProtectVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection/9ad788b8a415428e92c13ffe6276e600"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209056},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualProtect"}},"children":[],"locations":[{"type":"absolute","value":4209086}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualProtectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtProtectVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwProtectVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection/9ad788b8a415428e92c13ffe6276e600"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"allocate or change RW memory":{"meta":{"name":"allocate or change RW memory","authors":["0x534a@mailbox.org","@mr-tz"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Memory","Allocate Memory"],"objective":"Memory","behavior":"Allocate Memory","method":"","id":"C0007"}],"references":[],"examples":["Practical Malware Analysis Lab 17-02.dll_:0x1000D10D"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: allocate or change RW memory\n    authors:\n      - 0x534a@mailbox.org\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Memory::Allocate Memory [C0007]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\n  features:\n    - and:\n      - or:\n        - match: allocate memory\n        - match: change memory protection\n      - or:\n        - number: 0x4 = PAGE_READWRITE\n        # lea     r9d, [rcx+4]  ; flProtect\n        # call    cs:VirtualAlloc\n        - instruction:\n          - mnemonic: lea\n          - offset: 0x4 = PAGE_READWRITE\n","matches":[[{"type":"absolute","value":4208636},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[{"type":"absolute","value":4208761},{"type":"absolute","value":4208723}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4208636}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualProtect"}},"children":[],"locations":[{"type":"absolute","value":4208803}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualProtectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtProtectVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwProtectVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection/9ad788b8a415428e92c13ffe6276e600"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4208636}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":4,"description":"PAGE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":4208743}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RW memory/65234c8b71cd4ae5a5bb89c34c53ef4e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208636},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[{"type":"absolute","value":4208761},{"type":"absolute","value":4208723}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4208636}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualProtect"}},"children":[],"locations":[{"type":"absolute","value":4208803}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualProtectEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtProtectVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwProtectVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection/9ad788b8a415428e92c13ffe6276e600"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4208636}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":4,"description":"PAGE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":4208743}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RW memory/65234c8b71cd4ae5a5bb89c34c53ef4e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208872},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[{"type":"absolute","value":4208891}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4208872}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":4,"description":"PAGE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":4208872}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RW memory/65234c8b71cd4ae5a5bb89c34c53ef4e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"open process":{"meta":{"name":"open process","authors":["0x534a@mailbox.org"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Process","Open Process"],"objective":"Process","behavior":"Open Process","method":"","id":"C0065"}],"references":[],"examples":["Practical Malware Analysis Lab 17-02.dll_:0x1000D10D"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: open process\n    authors:\n      - 0x534a@mailbox.org\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Open Process [C0065]\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_:0x1000D10D\n  features:\n    - or:\n      - api: kernel32.OpenProcess\n      - api: NtOpenProcess\n      - api: ZwOpenProcess\n","matches":[[{"type":"absolute","value":4211612},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"OpenProcess"}},"children":[],"locations":[{"type":"absolute","value":4211642}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenProcess"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4219112},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"OpenProcess"}},"children":[],"locations":[{"type":"absolute","value":4219143}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenProcess"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4224354},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"OpenProcess"}},"children":[],"locations":[{"type":"absolute","value":4224365}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenProcess"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4225282},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"OpenProcess"}},"children":[],"locations":[{"type":"absolute","value":4225300}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenProcess"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4225323},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"OpenProcess"}},"children":[],"locations":[{"type":"absolute","value":4225341}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenProcess"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"create or open registry key":{"meta":{"name":"create or open registry key","authors":["michael.hunhoff@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Operating System","Registry","Create Registry Key"],"objective":"Operating System","behavior":"Registry","method":"Create Registry Key","id":"C0036.004"},{"parts":["Operating System","Registry","Open Registry Key"],"objective":"Operating System","behavior":"Registry","method":"Open Registry Key","id":"C0036.003"}],"references":[],"examples":["Practical Malware Analysis Lab 03-02.dll_:0x10004706","Practical Malware Analysis Lab 11-01.exe_:0x401000","493167E85E45363D09495D0841C30648:0x404D60","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E","692f7fd6d198e804d6af98eb9e390d61:0x6000003"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: create or open registry key\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Operating System::Registry::Create Registry Key [C0036.004]\n      - Operating System::Registry::Open Registry Key [C0036.003]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n      - Practical Malware Analysis Lab 11-01.exe_:0x401000\n      - 493167E85E45363D09495D0841C30648:0x404D60\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4045F2\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: advapi32.RegOpenKey\n      - api: advapi32.RegOpenKeyEx\n      - api: advapi32.RegCreateKey\n      - api: advapi32.RegCreateKeyEx\n      - api: advapi32.RegOpenCurrentUser\n      - api: advapi32.RegOpenKeyTransacted\n      - api: advapi32.RegOpenUserClassesRoot\n      - api: advapi32.RegCreateKeyTransacted\n      - api: ZwOpenKey\n      - api: ZwOpenKeyEx\n      - api: ZwCreateKey\n      - api: ZwOpenKeyTransacted\n      - api: ZwOpenKeyTransactedEx\n      - api: ZwCreateKeyTransacted\n      - api: NtOpenKey\n      - api: NtCreateKey\n      - api: SHRegOpenUSKey\n      - api: SHRegCreateUSKey\n      - api: RtlCreateRegistryKey\n      - api: Microsoft.Win32.RegistryKey::OpenSubKey\n      - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n      - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n      - api: Microsoft.Win32.RegistryKey::CreateSubKey\n","matches":[[{"type":"absolute","value":4215480},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[{"type":"absolute","value":4215549}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4215485},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[{"type":"absolute","value":4215549}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4215480},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[{"type":"absolute","value":4215549}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4215480},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[{"type":"absolute","value":4215549}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218240},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[{"type":"absolute","value":4218311}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218464},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[{"type":"absolute","value":4218534}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4220078},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[{"type":"absolute","value":4220102}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get file attributes":{"meta":{"name":"get file attributes","namespace":"host-interaction/file-system/meta","authors":["michael.hunhoff@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["File System","Get File Attributes"],"objective":"File System","behavior":"Get File Attributes","method":"","id":"C0049"}],"references":[],"examples":["03B236B23B1EC37C663527C1F53AF3FE:0x180019824","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: get file attributes\n    namespace: host-interaction/file-system/meta\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - File System::Get File Attributes [C0049]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x180019824\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4028B6\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x4029E0\n  features:\n    - or:\n      - api: kernel32.GetFileAttributes\n      - api: ZwQueryDirectoryFile\n      - api: ZwQueryInformationFile\n      - api: NtQueryDirectoryFile\n      - api: NtQueryInformationFile\n      - api: System.IO.File::GetAttributes\n      - api: System.IO.File::GetCreationTime\n      - api: System.IO.File::GetCreationTimeUtc\n      - api: System.IO.File::GetLastAccessTime\n      - api: System.IO.File::GetLastAccessTimeUtc\n      - api: System.IO.File::GetLastWriteTime\n      - api: System.IO.File::GetLastWriteTimeUtc\n      - property/read: System.IO.FileSystemInfo::Attributes\n      - api: stat\n      - api: fstat\n      - api: lstat\n      - api: fstatat\n","matches":[[{"type":"absolute","value":4217635},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetFileAttributes"}},"children":[],"locations":[{"type":"absolute","value":4217685}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryDirectoryFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryDirectoryFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryInformationFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetAttributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetCreationTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetCreationTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastAccessTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastAccessTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastWriteTime"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::GetLastWriteTimeUtc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.IO.FileSystemInfo::Attributes"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"stat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fstat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"lstat"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"fstatat"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"create process on Windows":{"meta":{"name":"create process on Windows","namespace":"host-interaction/process/create","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Process","Create Process"],"objective":"Process","behavior":"Create Process","method":"","id":"C0017"}],"references":[],"examples":["9324D1A8AE37A36AE560C37448C9705A:0x406DB0","Practical Malware Analysis Lab 01-04.exe_:0x4011FC","692f7fd6d198e804d6af98eb9e390d61:0x6000003"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: create process on Windows\n    namespace: host-interaction/process/create\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Create Process [C0017]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x406DB0\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      - 692f7fd6d198e804d6af98eb9e390d61:0x6000003\n  features:\n    - or:\n      - api: kernel32.WinExec\n      - api: kernel32.CreateProcess\n      - api: shell32.ShellExecute\n      - api: shell32.ShellExecuteEx\n      - api: advapi32.CreateProcessAsUser\n      - api: advapi32.CreateProcessWithLogon\n      - api: advapi32.CreateProcessWithToken\n      - api: kernel32.CreateProcessInternal\n      - api: ntdll.NtCreateUserProcess\n      - api: ntdll.NtCreateProcess\n      - api: ntdll.NtCreateProcessEx\n      - api: ntdll.ZwCreateProcess\n      - api: ZwCreateProcessEx\n      - api: ntdll.ZwCreateUserProcess\n      - api: ntdll.RtlCreateUserProcess\n      - api: System.Diagnostics.Process::Start\n","matches":[[{"type":"absolute","value":4217862},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WinExec"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcess"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"ShellExecute"}},"children":[],"locations":[{"type":"absolute","value":4218012}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ShellExecuteEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessAsUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessWithLogon"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessWithToken"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessInternal"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateUserProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateProcessEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateProcessEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateUserProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateUserProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Diagnostics.Process::Start"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218019},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WinExec"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcess"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"ShellExecute"}},"children":[],"locations":[{"type":"absolute","value":4218123}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ShellExecuteEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessAsUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessWithLogon"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessWithToken"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessInternal"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateUserProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateProcessEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateProcessEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateUserProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateUserProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Diagnostics.Process::Start"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4225109},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"WinExec"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcess"}},"children":[],"locations":[{"type":"absolute","value":4225218}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ShellExecute"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ShellExecuteEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessAsUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessWithLogon"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessWithToken"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessInternal"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateUserProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateProcessEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateProcessEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateUserProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateUserProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Diagnostics.Process::Start"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"PEB access":{"meta":{"name":"PEB access","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"basic block"},"attack":[],"mbc":[{"parts":["Anti-Behavioral Analysis","Debugger Detection","Process Environment Block"],"objective":"Anti-Behavioral Analysis","behavior":"Debugger Detection","method":"Process Environment Block","id":"B0001.019"}],"references":["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp"],"examples":["al-khaser_x86.exe_:0x420D20"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: PEB access\n    authors:\n      - michael.hunhoff@mandiant.com\n    lib: true\n    scopes:\n      static: basic block\n      dynamic: unsupported  # requires characteristic, offset, mnemonic features\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Process Environment Block [B0001.019]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp\n    examples:\n      - al-khaser_x86.exe_:0x420D20\n  features:\n    - or:\n      - characteristic: peb access\n      - and:\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L41\n        - arch: i386\n        - characteristic: fs access\n        - or:\n          # in 0f5d5d07c6533bc6d991836ce79daaa1\n          # then we have:\n          #\n          #     xor edx, edx\n          #     mov edx, fs:[edx+30h]\n          - offset: 0x30\n          - instruction:\n            # in the case of CallObfuscator, gs:[rax]\n            - mnemonic: add\n            - number: 0x30\n      - and:\n        - arch: amd64\n        - characteristic: gs access\n        - or:\n          - offset: 0x60\n          - instruction:\n            - mnemonic: add\n            - number: 0x60\n      - and:\n        # WoW64 PEB address is fetched via the WoW64 Thread Environment Block (TEB) at FS:[0x18]-0x2000\n        # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiDebug/NtGlobalFlag.cpp#L45\n        - characteristic: fs access\n        - instruction:\n          - mnemonic: sub\n          - number: 0x2000\n","matches":[[{"type":"absolute","value":4221660},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"peb access"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"fs access"}},"children":[],"locations":[{"type":"absolute","value":4221680},{"type":"absolute","value":4221667},{"type":"absolute","value":4221683}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/88764106f5a94371815f1d9eb5cad20b"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"fs access"}},"children":[],"locations":[{"type":"absolute","value":4221680},{"type":"absolute","value":4221667},{"type":"absolute","value":4221683}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"offset","offset":48}},"children":[],"locations":[{"type":"absolute","value":4221663}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/6c3d766652914e2292b3c7d154c170c9"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"gs access"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":96}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/3cf9a9d68a3b48fd861333c91313fed9"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4221660},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"peb access"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"fs access"}},"children":[],"locations":[{"type":"absolute","value":4221680},{"type":"absolute","value":4221667},{"type":"absolute","value":4221683}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/88764106f5a94371815f1d9eb5cad20b"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"fs access"}},"children":[],"locations":[{"type":"absolute","value":4221680},{"type":"absolute","value":4221667},{"type":"absolute","value":4221683}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"offset","offset":48}},"children":[],"locations":[{"type":"absolute","value":4221663}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/6c3d766652914e2292b3c7d154c170c9"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"gs access"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":96}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/3cf9a9d68a3b48fd861333c91313fed9"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4221660},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"peb access"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"fs access"}},"children":[],"locations":[{"type":"absolute","value":4221680},{"type":"absolute","value":4221667},{"type":"absolute","value":4221683}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/88764106f5a94371815f1d9eb5cad20b"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"fs access"}},"children":[],"locations":[{"type":"absolute","value":4221680},{"type":"absolute","value":4221667},{"type":"absolute","value":4221683}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"offset","offset":48}},"children":[],"locations":[{"type":"absolute","value":4221663}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/6c3d766652914e2292b3c7d154c170c9"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"gs access"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":96}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/3cf9a9d68a3b48fd861333c91313fed9"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"acquire debug privileges":{"meta":{"name":"acquire debug privileges","namespace":"host-interaction/process/modify","authors":["william.ballenthin@mandiant.com"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[{"parts":["Privilege Escalation","Access Token Manipulation"],"tactic":"Privilege Escalation","technique":"Access Token Manipulation","subtechnique":"","id":"T1134"}],"mbc":[],"references":[],"examples":["Practical Malware Analysis Lab 01-04.exe_:0x401174"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: acquire debug privileges\n    namespace: host-interaction/process/modify\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: basic block\n      dynamic: call\n    att&ck:\n      - Privilege Escalation::Access Token Manipulation [T1134]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401174\n  features:\n    - and:\n      - string: \"SeDebugPrivilege\"\n      - optional:\n        - match: modify access privileges\n","matches":[[{"type":"absolute","value":4224095},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"string","string":"SeDebugPrivilege"}},"children":[],"locations":[{"type":"absolute","value":4224133}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"modify access privileges"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"AdjustTokenPrivileges"}},"children":[],"locations":[{"type":"absolute","value":4224221}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"AdjustTokenPrivileges"}},"children":[],"locations":[{"type":"absolute","value":4224182}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4224221},{"type":"absolute","value":4224182}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"create process suspended":{"meta":{"name":"create process suspended","namespace":"host-interaction/process/create","authors":["william.ballenthin@mandiant.com","mehunhoff@google.com"],"scopes":{"static":"basic block","dynamic":"call"},"attack":[],"mbc":[{"parts":["Process","Create Process","Create Suspended Process"],"objective":"Process","behavior":"Create Process","method":"Create Suspended Process","id":"C0017.003"}],"references":["https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/an-in-depth-look-at-mailto-ransomware-part-two-of-three/","https://learn.microsoft.com/en-us/windows/win32/procthread/process-creation-flags#flags"],"examples":["Practical Malware Analysis Lab 03-03.exe_:0x4010EA"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: create process suspended\n    namespace: host-interaction/process/create\n    authors:\n      - william.ballenthin@mandiant.com\n      - mehunhoff@google.com\n    scopes:\n      static: basic block\n      dynamic: call\n    mbc:\n      - Process::Create Process::Create Suspended Process [C0017.003]\n    references:\n      - https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/an-in-depth-look-at-mailto-ransomware-part-two-of-three/\n      - https://learn.microsoft.com/en-us/windows/win32/procthread/process-creation-flags#flags\n    examples:\n      - Practical Malware Analysis Lab 03-03.exe_:0x4010EA\n  features:\n    - or:\n      - and:\n        - or:\n          - number: 0x08000004 = CREATE_NO_WINDOW | CREATE_SUSPENDED\n          - number: 0x800000C = CREATE_SUSPENDED | DETACHED_PROCESS | CREATE_NO_WINDOW\n          - number: 4 = CREATE_SUSPENDED\n          - number: 2 = DEBUG_ONLY_THIS_PROCESS\n        - or:\n          - api: kernel32.CreateProcess\n          - api: kernel32.CreateProcessInternal\n          - api: advapi32.CreateProcessAsUser\n          - api: advapi32.CreateProcessWithLogon\n          - api: advapi32.CreateProcessWithToken\n      - and:\n        - or:\n          - number: 0x10 = PROCESS_CREATE_FLAGS_CREATE_SUSPENDED\n          - number: 0x2000010 = PROCESS_CREATE_FLAGS_CREATE_SUSPENDED | PROCESS_CREATE_FLAGS_NO_WINDOW\n          - number: 0x11 = PROCESS_CREATE_FLAGS_CREATE_SUSPENDED | PROCESS_CREATE_FLAGS_BREAKAWAY\n        - or:\n          - api: ntdll.NtCreateProcessEx\n          - api: ZwCreateProcessEx\n          - api: ntdll.NtCreateUserProcess\n          - api: ntdll.ZwCreateUserProcess\n          - api: ntdll.RtlCreateUserProcess\n","matches":[[{"type":"absolute","value":4225109},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":16,"description":"PROCESS_CREATE_FLAGS_CREATE_SUSPENDED"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":33554448,"description":"PROCESS_CREATE_FLAGS_CREATE_SUSPENDED | PROCESS_CREATE_FLAGS_NO_WINDOW"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":17,"description":"PROCESS_CREATE_FLAGS_CREATE_SUSPENDED | PROCESS_CREATE_FLAGS_BREAKAWAY"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateProcessEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateProcessEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateUserProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateUserProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateUserProcess"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":134217732,"description":"CREATE_NO_WINDOW | CREATE_SUSPENDED"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":134217740,"description":"CREATE_SUSPENDED | DETACHED_PROCESS | CREATE_NO_WINDOW"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":4,"description":"CREATE_SUSPENDED"}},"children":[],"locations":[{"type":"absolute","value":4225197}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2,"description":"DEBUG_ONLY_THIS_PROCESS"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcess"}},"children":[],"locations":[{"type":"absolute","value":4225218}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessInternal"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessAsUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessWithLogon"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateProcessWithToken"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"contain loop":{"meta":{"name":"contain loop","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function"},"attack":[],"mbc":[],"references":[],"examples":["08AC667C65D36D6542917655571E61C8:0x406EAA"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: contain loop\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic features\n    examples:\n      - 08AC667C65D36D6542917655571E61C8:0x406EAA\n  features:\n    - or:\n      - characteristic: loop\n      - characteristic: tight loop\n      - characteristic: recursive call\n","matches":[[{"type":"absolute","value":4198996},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4198996}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4199160},{"type":"absolute","value":4199206}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4199232},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4199232}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4199372},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4199372}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4199391}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4199588},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4199588}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4200584},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4200584}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4200636},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4200636}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4200856},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4200856}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4200886}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201248},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4201248}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201512},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4201512}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201824},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4201824}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4201956},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4201956}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4202364},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4202364}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4202604},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4202622}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4202652},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4202778},{"type":"absolute","value":4202716},{"type":"absolute","value":4202748},{"type":"absolute","value":4202726}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[{"type":"absolute","value":4202652}],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4202800},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4202818}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4202852},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4203040},{"type":"absolute","value":4202973},{"type":"absolute","value":4203055},{"type":"absolute","value":4203021},{"type":"absolute","value":4202991}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[{"type":"absolute","value":4202852}],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4203088},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4203106}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4203140},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4203217},{"type":"absolute","value":4203202},{"type":"absolute","value":4203251},{"type":"absolute","value":4203233},{"type":"absolute","value":4203281},{"type":"absolute","value":4203300},{"type":"absolute","value":4203315}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[{"type":"absolute","value":4203140}],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4203332},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4203332}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[{"type":"absolute","value":4203332}],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4203616},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4203729},{"type":"absolute","value":4203811},{"type":"absolute","value":4203686},{"type":"absolute","value":4203782},{"type":"absolute","value":4203831},{"type":"absolute","value":4203709},{"type":"absolute","value":4203758}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[{"type":"absolute","value":4203616}],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4203892},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4203899}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4203996},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4203040},{"type":"absolute","value":4202973},{"type":"absolute","value":4203055},{"type":"absolute","value":4203021},{"type":"absolute","value":4202991}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4204012},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4204368}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[{"type":"absolute","value":4204012}],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4204544},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4204558}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4206052},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4206094}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4206328},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4206328}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4206632},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4206632}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4206672},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4206672}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207080},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4207154}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207152},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4207154}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4207884},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4207884}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4207899}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208196},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4208196}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208320},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4208320}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4208636},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4208636}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4209056}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209200},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4209200}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4209960},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4209960}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4210341}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4211692},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4211692}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4211936},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4211936}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4214192},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4214192}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4215648},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4215648}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4215656}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4217024},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4217032}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218648},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4218668}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4219920},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4219920}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[{"type":"absolute","value":4219920}],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4220916},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4220924}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4221400},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4221400}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4221424},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4221424}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4221440},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4221440}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4221564},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4221564}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4221632},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4221632}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223036},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4223036}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223140},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4223140}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223436},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[{"type":"absolute","value":4223436}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4223560},{"type":"absolute","value":4223900},{"type":"absolute","value":4223532},{"type":"absolute","value":4223710}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4224668},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"loop"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4224676}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"recursive call"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"accept command line arguments":{"meta":{"name":"accept command line arguments","namespace":"host-interaction/cli","authors":["moritz.raabe@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[{"parts":["Execution","Command and Scripting Interpreter"],"tactic":"Execution","technique":"Command and Scripting Interpreter","subtechnique":"","id":"T1059"}],"mbc":[{"parts":["Execution","Command and Scripting Interpreter"],"objective":"Execution","behavior":"Command and Scripting Interpreter","method":"","id":"E1059"}],"references":[],"examples":["e5369ac309f1be6d77afeeb3edab0ed8:0x402760"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: accept command line arguments\n    namespace: host-interaction/cli\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Execution::Command and Scripting Interpreter [T1059]\n    mbc:\n      - Execution::Command and Scripting Interpreter [E1059]\n    examples:\n      - e5369ac309f1be6d77afeeb3edab0ed8:0x402760\n  features:\n    - or:\n      - api: GetCommandLine\n      - api: CommandLineToArgv\n      - api: System.Environment::GetCommandLineArgs\n","matches":[[{"type":"absolute","value":4199232},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetCommandLine"}},"children":[],"locations":[{"type":"absolute","value":4199286}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CommandLineToArgv"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::GetCommandLineArgs"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"set thread local storage value":{"meta":{"name":"set thread local storage value","namespace":"host-interaction/thread/tls","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[],"mbc":[{"parts":["Process","Set Thread Local Storage Value"],"objective":"Process","behavior":"Set Thread Local Storage Value","method":"","id":"C0041"}],"references":[],"examples":["03B236B23B1EC37C663527C1F53AF3FE:0x18000AE21"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: set thread local storage value\n    namespace: host-interaction/thread/tls\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    mbc:\n      - Process::Set Thread Local Storage Value [C0041]\n    examples:\n      - 03B236B23B1EC37C663527C1F53AF3FE:0x18000AE21\n  features:\n    - and:\n      - api: kernel32.TlsSetValue\n      - optional:\n        - match: allocate thread local storage\n","matches":[[{"type":"absolute","value":4204864},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"TlsSetValue"}},"children":[],"locations":[{"type":"absolute","value":4204925}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate thread local storage"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get thread local storage value":{"meta":{"name":"get thread local storage value","namespace":"host-interaction/process","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[],"mbc":[],"references":[],"examples":[],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: get thread local storage value\n    namespace: host-interaction/process\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n  features:\n    - and:\n      - api: kernel32.TlsGetValue\n","matches":[[{"type":"absolute","value":4204932},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"TlsGetValue"}},"children":[],"locations":[{"type":"absolute","value":4204969},{"type":"absolute","value":4204986}],"captures":{}}],"locations":[],"captures":{}}]]},"copy file":{"meta":{"name":"copy file","namespace":"host-interaction/file-system/copy","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[],"mbc":[{"parts":["File System","Copy File"],"objective":"File System","behavior":"Copy File","method":"","id":"C0045"}],"references":[],"examples":["Practical Malware Analysis Lab 01-01.exe_:0x401440"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: copy file\n    namespace: host-interaction/file-system/copy\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - File System::Copy File [C0045]\n    examples:\n      - Practical Malware Analysis Lab 01-01.exe_:0x401440\n  features:\n    - or:\n      - api: kernel32.CopyFile\n      - api: kernel32.CopyFileEx\n      - api: CopyFile2\n      - api: CopyFileTransacted\n      - api: LZCopy\n      - api: System.IO.FileInfo::CopyTo\n      - api: System.IO.File::Copy\n      - basic block:\n        - and:\n          - number: 2 = FO_COPY\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 2 = FO_COPY\n          - or:\n            - api: kernel32.SHFileOperation\n","matches":[[{"type":"absolute","value":4205808},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CopyFile"}},"children":[],"locations":[{"type":"absolute","value":4205881}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CopyFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CopyFile2"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CopyFileTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LZCopy"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.FileInfo::CopyTo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::Copy"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"copy file/d05cd9e441d048c380ba06474774ab2d"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"copy file/10e95bba4dcf42a893e8675534d6c2c0"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"move file":{"meta":{"name":"move file","namespace":"host-interaction/file-system/move","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[],"mbc":[{"parts":["File System","Move File"],"objective":"File System","behavior":"Move File","method":"","id":"C0063"}],"references":[],"examples":["Practical Malware Analysis Lab 01-04.exe_:0x401350"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: move file\n    namespace: host-interaction/file-system/move\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - File System::Move File [C0063]\n    examples:\n      - Practical Malware Analysis Lab 01-04.exe_:0x401350\n  features:\n    - or:\n      - api: kernel32.MoveFile\n      - api: kernel32.MoveFileEx\n      - api: MoveFileWithProgress\n      - api: MoveFileTransacted\n      - api: rename\n      - api: _wrename\n      - api: System.IO.FileInfo::MoveTo\n      - api: System.IO.File::Move\n      - basic block:\n        - and:\n          - number: 1 = FO_MOVE\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 1 = FO_MOVE\n          - api: kernel32.SHFileOperation\n","matches":[[{"type":"absolute","value":4205808},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"MoveFile"}},"children":[],"locations":[{"type":"absolute","value":4205898}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MoveFileEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MoveFileWithProgress"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"MoveFileTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"rename"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_wrename"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.FileInfo::MoveTo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::Move"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"move file/8955df24889e4323a25d2476655b7181"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"move file/78d7b555800c49c3ac2fbb485836451e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get common file path":{"meta":{"name":"get common file path","namespace":"host-interaction/file-system","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[{"parts":["Discovery","File and Directory Discovery"],"tactic":"Discovery","technique":"File and Directory Discovery","subtechnique":"","id":"T1083"}],"mbc":[{"parts":["Discovery","File and Directory Discovery"],"objective":"Discovery","behavior":"File and Directory Discovery","method":"","id":"E1083"}],"references":[],"examples":["Practical Malware Analysis Lab 03-02.dll_:0x10003415","972B219F18379907A045431303F4DA7D:0x404887"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: get common file path\n    namespace: host-interaction/file-system\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::File and Directory Discovery [T1083]\n    mbc:\n      - Discovery::File and Directory Discovery [E1083]\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10003415\n      - 972B219F18379907A045431303F4DA7D:0x404887\n  features:\n    - or:\n      - api: kernel32.GetTempPath\n      - api: kernel32.GetTempFileName\n      - api: kernel32.GetSystemDirectory\n      - api: kernel32.GetWindowsDirectory\n      - api: kernel32.GetSystemWow64Directory\n      - api: GetAllUsersProfileDirectory\n      - api: GetAppContainerFolderPath\n      - api: GetCurrentDirectory\n      - api: GetDefaultUserProfileDirectory\n      - api: GetProfilesDirectory\n      - api: GetUserProfileDirectory\n      - api: SHGetFolderPathAndSubDir\n      - api: shell32.SHGetFolderPath\n      - api: shell32.SHGetFolderLocation\n      - api: shell32.SHGetKnownFolderPath\n      - api: shell32.SHGetSpecialFolderPath\n      - api: shell32.SHGetSpecialFolderLocation\n      - api: System.IO.Directory::GetCurrentDirectory\n      - api: System.Environment::GetFolderPath\n      - property/read: System.Environment::SystemDirectory\n      - property/read: System.Environment::CurrentDirectory\n","matches":[[{"type":"absolute","value":4206880},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetTempPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetTempFileName"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetSystemDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetWindowsDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetSystemWow64Directory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetAllUsersProfileDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetAppContainerFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetCurrentDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetDefaultUserProfileDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetProfilesDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetUserProfileDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetFolderPathAndSubDir"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetFolderLocation"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetKnownFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetSpecialFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"SHGetSpecialFolderLocation"}},"children":[],"locations":[{"type":"absolute","value":4206927}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.Directory::GetCurrentDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::GetFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::SystemDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::CurrentDirectory"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4220624},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetTempPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetTempFileName"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetSystemDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetWindowsDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetSystemWow64Directory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetAllUsersProfileDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetAppContainerFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetCurrentDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetDefaultUserProfileDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetProfilesDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetUserProfileDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetFolderPathAndSubDir"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetFolderLocation"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetKnownFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetSpecialFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"SHGetSpecialFolderLocation"}},"children":[],"locations":[{"type":"absolute","value":4220671}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.Directory::GetCurrentDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::GetFolderPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::SystemDirectory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::CurrentDirectory"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"inspect section memory permissions":{"meta":{"name":"inspect section memory permissions","namespace":"load-code/pe","authors":["@Ana06"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[],"mbc":[{"parts":["Discovery","Code Discovery","Inspect Section Memory Permissions"],"objective":"Discovery","behavior":"Code Discovery","method":"Inspect Section Memory Permissions","id":"B0046.002"}],"references":[],"examples":["E4C33AC3638EEF68311F8AC0D72483C7:0x401480"],"description":"translate section memory permissions (specified in the 'Characteristics' field of the image section header) into page protection constants","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: inspect section memory permissions\n    namespace: load-code/pe\n    authors:\n      - \"@Ana06\"\n    description: \"translate section memory permissions (specified in the 'Characteristics' field of the image section header) into page protection constants\"\n    scopes:\n      static: function\n      dynamic: span of calls\n    mbc:\n      - Discovery::Code Discovery::Inspect Section Memory Permissions [B0046.002]\n    examples:\n      - E4C33AC3638EEF68311F8AC0D72483C7:0x401480\n  features:\n    - and:\n      - os: windows\n      - 3 or more:\n        - and:\n          - number: 0x40000000 = IMAGE_SCN_MEM_READ\n          - number: 0x2 = PAGE_READONLY\n        - and:\n          - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x10 = PAGE_EXECUTE\n        - and:\n          - or:\n            - number: 0x60000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_EXECUTE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x20 = PAGE_EXECUTE_READ\n        - and:\n          - or:\n            - number: 0xC0000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x80000000 = IMAGE_SCN_MEM_WRITE\n          - number: 0x4 = PAGE_READWRITE\n        - and:\n          - or:\n            - number: 0xE0000000 = IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE | IMAGE_SCN_MEM_EXECUTE\n            - and:\n              - number: 0x40000000 = IMAGE_SCN_MEM_READ\n              - number: 0x80000000 = IMAGE_SCN_MEM_WRITE\n              - number: 0x20000000 = IMAGE_SCN_MEM_EXECUTE\n          - number: 0x40 = PAGE_EXECUTE_READWRITE\n      - optional:\n        - number: 0x1 = PAGE_NOACCESS\n","matches":[[{"type":"absolute","value":4208084},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":1,"description":"PAGE_NOACCESS"}},"children":[],"locations":[{"type":"absolute","value":4208187}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"some","count":3}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":1073741824,"description":"IMAGE_SCN_MEM_READ"}},"children":[],"locations":[{"type":"absolute","value":4208106},{"type":"absolute","value":4208151}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2,"description":"PAGE_READONLY"}},"children":[],"locations":[{"type":"absolute","value":4208170}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":536870912,"description":"IMAGE_SCN_MEM_EXECUTE"}},"children":[],"locations":[{"type":"absolute","value":4208099}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":16,"description":"PAGE_EXECUTE"}},"children":[],"locations":[{"type":"absolute","value":4208145}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":1610612736,"description":"IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_EXECUTE"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":1073741824,"description":"IMAGE_SCN_MEM_READ"}},"children":[],"locations":[{"type":"absolute","value":4208106},{"type":"absolute","value":4208151}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":536870912,"description":"IMAGE_SCN_MEM_EXECUTE"}},"children":[],"locations":[{"type":"absolute","value":4208099}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":32,"description":"PAGE_EXECUTE_READ"}},"children":[],"locations":[{"type":"absolute","value":4208125}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":3221225472,"description":"IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":1073741824,"description":"IMAGE_SCN_MEM_READ"}},"children":[],"locations":[{"type":"absolute","value":4208106},{"type":"absolute","value":4208151}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2147483648,"description":"IMAGE_SCN_MEM_WRITE"}},"children":[],"locations":[{"type":"absolute","value":4208113},{"type":"absolute","value":4208130},{"type":"absolute","value":4208158},{"type":"absolute","value":4208175}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":4,"description":"PAGE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":4208165}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":3758096384,"description":"IMAGE_SCN_MEM_READ | IMAGE_SCN_MEM_WRITE | IMAGE_SCN_MEM_EXECUTE"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":1073741824,"description":"IMAGE_SCN_MEM_READ"}},"children":[],"locations":[{"type":"absolute","value":4208106},{"type":"absolute","value":4208151}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2147483648,"description":"IMAGE_SCN_MEM_WRITE"}},"children":[],"locations":[{"type":"absolute","value":4208113},{"type":"absolute","value":4208130},{"type":"absolute","value":4208158},{"type":"absolute","value":4208175}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":536870912,"description":"IMAGE_SCN_MEM_EXECUTE"}},"children":[],"locations":[{"type":"absolute","value":4208099}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":64,"description":"PAGE_EXECUTE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":4208120}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"link many functions at runtime":{"meta":{"name":"link many functions at runtime","namespace":"linking/runtime-linking","authors":["moritz.raabe@mandiant.com","joakim@intezer.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[{"parts":["Execution","Shared Modules"],"tactic":"Execution","technique":"Shared Modules","subtechnique":"","id":"T1129"}],"mbc":[],"references":[],"examples":["b7b5e1253710d8927cbe07d52d2d2e10:0x401000"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: link many functions at runtime\n    namespace: linking/runtime-linking\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    att&ck:\n      - Execution::Shared Modules [T1129]\n    examples:\n      - b7b5e1253710d8927cbe07d52d2d2e10:0x401000\n  features:\n    - or:\n      - count(match(link function at runtime on Windows)): 5 or more\n      - count(match(link function at runtime on Linux)): 5 or more\n","matches":[[{"type":"absolute","value":4210476},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"range","min":5,"max":9223372036854775808,"child":{"type":"match","match":"link function at runtime on Windows"}}},"children":[],"locations":[{"type":"absolute","value":4210754},{"type":"absolute","value":4210628},{"type":"absolute","value":4210700},{"type":"absolute","value":4210574},{"type":"absolute","value":4210772},{"type":"absolute","value":4210646},{"type":"absolute","value":4210520},{"type":"absolute","value":4210718},{"type":"absolute","value":4210592},{"type":"absolute","value":4210790},{"type":"absolute","value":4210664},{"type":"absolute","value":4210538},{"type":"absolute","value":4210736},{"type":"absolute","value":4210610},{"type":"absolute","value":4210682},{"type":"absolute","value":4210556}],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"range","min":5,"max":9223372036854775808,"child":{"type":"match","match":"link function at runtime on Linux"}}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"extract resource via kernel32 functions":{"meta":{"name":"extract resource via kernel32 functions","namespace":"executable/resource","authors":["william.ballenthin@mandiant.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[],"mbc":[],"references":[],"examples":["BF88E1BD4A3BDE10B419A622278F1FF7:0x401000","Practical Malware Analysis Lab 01-04.exe_:0x4011FC","563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: extract resource via kernel32 functions\n    namespace: executable/resource\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    examples:\n      - BF88E1BD4A3BDE10B419A622278F1FF7:0x401000\n      - Practical Malware Analysis Lab 01-04.exe_:0x4011FC\n      # ntdll\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001ABA\n  features:\n    - or:\n      - and:\n        - or:\n          - api: kernel32.LoadResource\n          - api: kernel32.LockResource\n          - api: LdrAccessResource\n        - optional:\n          - api: kernel32.GetModuleHandle\n          # may occur in parent function, see 0664B09A86EC2DF7DFE01A93E184A1FA23DF66EA82CAB39000944E418EC1F7B2\n          - or:\n            - api: kernel32.FindResource\n            - api: kernel32.FindResourceEx\n            - api: LdrFindResource_U\n            - api: LdrFindResourceEx_U\n          - api: kernel32.SizeofResource\n          - api: kernel32.FreeResource\n","matches":[[{"type":"absolute","value":4211328},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"LoadResource"}},"children":[],"locations":[{"type":"absolute","value":4211364}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"LockResource"}},"children":[],"locations":[{"type":"absolute","value":4211376}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrAccessResource"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetModuleHandle"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"FindResource"}},"children":[],"locations":[{"type":"absolute","value":4211348}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"FindResourceEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrFindResource_U"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrFindResourceEx_U"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SizeofResource"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"FreeResource"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223036},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"LoadResource"}},"children":[],"locations":[{"type":"absolute","value":4223184}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"LockResource"}},"children":[],"locations":[{"type":"absolute","value":4223192}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrAccessResource"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetModuleHandle"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"FindResource"}},"children":[],"locations":[{"type":"absolute","value":4223164}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"FindResourceEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrFindResource_U"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrFindResourceEx_U"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"SizeofResource"}},"children":[],"locations":[{"type":"absolute","value":4223174}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"FreeResource"}},"children":[],"locations":[{"type":"absolute","value":4223204}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4223140},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"LoadResource"}},"children":[],"locations":[{"type":"absolute","value":4223184}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"LockResource"}},"children":[],"locations":[{"type":"absolute","value":4223192}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrAccessResource"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetModuleHandle"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"FindResource"}},"children":[],"locations":[{"type":"absolute","value":4223164}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"FindResourceEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrFindResource_U"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"LdrFindResourceEx_U"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"SizeofResource"}},"children":[],"locations":[{"type":"absolute","value":4223174}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"FreeResource"}},"children":[],"locations":[{"type":"absolute","value":4223204}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"terminate process":{"meta":{"name":"terminate process","namespace":"host-interaction/process/terminate","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[],"mbc":[{"parts":["Process","Terminate Process"],"objective":"Process","behavior":"Terminate Process","method":"","id":"C0018"}],"references":[],"examples":["C91887D861D9BD4A5872249B641BC9F9:0x401A77","9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - os: linux\n        - api: exit_group\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n","matches":[[{"type":"absolute","value":4211612},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Diagnostics.Process::Kill"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Diagnostics.Process::WaitForExit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Diagnostics.Process::WaitForExitAsync"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::Exit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Windows.Forms.Application::Exit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"exit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Exit"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"exit_group"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"open process"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"OpenProcess"}},"children":[],"locations":[{"type":"absolute","value":4211642}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenProcess"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4211612}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"TerminateProcess"}},"children":[],"locations":[{"type":"absolute","value":4211652}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtTerminateProcess"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ExitProcess"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get service handle":{"meta":{"name":"get service handle","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[],"mbc":[],"references":[],"examples":["Practical Malware Analysis Lab 03-02.dll_:0x10004706"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: get service handle\n    authors:\n      - moritz.raabe@mandiant.com\n    lib: true\n    scopes:\n      static: function\n      dynamic: call\n    examples:\n      - Practical Malware Analysis Lab 03-02.dll_:0x10004706\n  features:\n    - or:\n      - api: advapi32.CreateService\n      - api: advapi32.OpenService\n","matches":[[{"type":"absolute","value":4211936},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateService"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"OpenService"}},"children":[],"locations":[{"type":"absolute","value":4212017}],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4212160},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateService"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"OpenService"}},"children":[],"locations":[{"type":"absolute","value":4212236}],"captures":{}}],"locations":[],"captures":{}}]]},"query service status":{"meta":{"name":"query service status","namespace":"host-interaction/service","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[{"parts":["Discovery","System Service Discovery"],"tactic":"Discovery","technique":"System Service Discovery","subtechnique":"","id":"T1007"}],"mbc":[],"references":[],"examples":["9DC209F66DA77858E362E624D0BE86B3:0x403C70"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: query service status\n    namespace: host-interaction/service\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::System Service Discovery [T1007]\n    examples:\n      - 9DC209F66DA77858E362E624D0BE86B3:0x403C70\n  features:\n    - or:\n      - api: advapi32.QueryServiceStatusEx\n      - api: advapi32.QueryServiceStatus\n","matches":[[{"type":"absolute","value":4211936},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"QueryServiceStatusEx"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"QueryServiceStatus"}},"children":[],"locations":[{"type":"absolute","value":4212049},{"type":"absolute","value":4212077}],"captures":{}}],"locations":[],"captures":{}}]]},"stop service":{"meta":{"name":"stop service","namespace":"host-interaction/service/stop","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[{"parts":["Persistence","Create or Modify System Process","Windows Service"],"tactic":"Persistence","technique":"Create or Modify System Process","subtechnique":"Windows Service","id":"T1543.003"},{"parts":["Impact","Service Stop"],"tactic":"Impact","technique":"Service Stop","subtechnique":"","id":"T1489"}],"mbc":[],"references":[],"examples":["E544A4D616B60147D9774B48C2B65EF2:0x402140"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: stop service\n    namespace: host-interaction/service/stop\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    att&ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Impact::Service Stop [T1489]\n    examples:\n      - E544A4D616B60147D9774B48C2B65EF2:0x402140\n  features:\n    - and:\n      - optional:\n        - match: get service handle\n      - or:\n        - basic block:\n          - and:\n            - number: 0x1 = SERVICE_CONTROL_STOP\n            - or:\n              - api: advapi32.ControlService\n              - api: advapi32.ControlServiceEx\n        - call:\n          - and:\n            - number: 0x1 = SERVICE_CONTROL_STOP\n            - or:\n              - api: advapi32.ControlService\n              - api: advapi32.ControlServiceEx\n","matches":[[{"type":"absolute","value":4211936},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"get service handle"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateService"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"OpenService"}},"children":[],"locations":[{"type":"absolute","value":4212017}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4211936}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":1,"description":"SERVICE_CONTROL_STOP"}},"children":[],"locations":[{"type":"absolute","value":4212032}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"ControlService"}},"children":[],"locations":[{"type":"absolute","value":4212035}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ControlServiceEx"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4212028}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"stop service/fe9d8a06e740453dafd3e591b156e9fd"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"modify service":{"meta":{"name":"modify service","namespace":"host-interaction/service/modify","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[{"parts":["Persistence","Create or Modify System Process","Windows Service"],"tactic":"Persistence","technique":"Create or Modify System Process","subtechnique":"Windows Service","id":"T1543.003"},{"parts":["Execution","System Services","Service Execution"],"tactic":"Execution","technique":"System Services","subtechnique":"Service Execution","id":"T1569.002"}],"mbc":[],"references":[],"examples":["7D16EFD0078F22C17A4BD78B0F0CC468:0x401000"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: modify service\n    namespace: host-interaction/service/modify\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    att&ck:\n      - Persistence::Create or Modify System Process::Windows Service [T1543.003]\n      - Execution::System Services::Service Execution [T1569.002]\n    examples:\n      - 7D16EFD0078F22C17A4BD78B0F0CC468:0x401000\n  features:\n    - and:\n      - optional:\n        - match: get service handle\n      - or:\n        - api: advapi32.ChangeServiceConfig\n        - api: advapi32.ChangeServiceConfig2\n","matches":[[{"type":"absolute","value":4212160},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"get service handle"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateService"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"OpenService"}},"children":[],"locations":[{"type":"absolute","value":4212236}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4212160}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"ChangeServiceConfig"}},"children":[],"locations":[{"type":"absolute","value":4212270}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ChangeServiceConfig2"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get hostname":{"meta":{"name":"get hostname","namespace":"host-interaction/os/hostname","authors":["moritz.raabe@mandiant.com","joakim@intezer.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[{"parts":["Discovery","System Information Discovery"],"tactic":"Discovery","technique":"System Information Discovery","subtechnique":"","id":"T1082"}],"mbc":[{"parts":["Discovery","System Information Discovery"],"objective":"Discovery","behavior":"System Information Discovery","method":"","id":"E1082"}],"references":[],"examples":["9324D1A8AE37A36AE560C37448C9705A:0x4052A0","7351f8a40c5450557b24622417fc478d:0x405438"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: get hostname\n    namespace: host-interaction/os/hostname\n    authors:\n      - moritz.raabe@mandiant.com\n      - joakim@intezer.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - 9324D1A8AE37A36AE560C37448C9705A:0x4052A0\n      - 7351f8a40c5450557b24622417fc478d:0x405438\n  features:\n    - or:\n      - api: kernel32.GetComputerName\n      - api: kernel32.GetComputerNameEx\n      - api: GetComputerObjectName\n      - api: ws2_32.gethostname\n      - api: gethostname\n      - property/read: System.Environment::MachineName\n","matches":[[{"type":"absolute","value":4213624},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetComputerName"}},"children":[],"locations":[{"type":"absolute","value":4213740}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetComputerNameEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetComputerObjectName"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"gethostname"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::MachineName"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4213704},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetComputerName"}},"children":[],"locations":[{"type":"absolute","value":4213740}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetComputerNameEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetComputerObjectName"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"gethostname"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::MachineName"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get session user name":{"meta":{"name":"get session user name","namespace":"host-interaction/session","authors":["moritz.raabe@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[{"parts":["Discovery","System Owner/User Discovery"],"tactic":"Discovery","technique":"System Owner/User Discovery","subtechnique":"","id":"T1033"},{"parts":["Discovery","Account Discovery"],"tactic":"Discovery","technique":"Account Discovery","subtechnique":"","id":"T1087"}],"mbc":[],"references":[],"examples":["Practical Malware Analysis Lab 14-01.exe_:0x401285"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: get session user name\n    namespace: host-interaction/session\n    authors:\n      - moritz.raabe@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    att&ck:\n      - Discovery::System Owner/User Discovery [T1033]\n      - Discovery::Account Discovery [T1087]\n    examples:\n      - Practical Malware Analysis Lab 14-01.exe_:0x401285\n  features:\n    - or:\n      - api: advapi32.GetUserName\n      - api: secur32.GetUserNameEx\n      - basic block:\n        - and:\n          # - match: get session information (see #463)\n          - api: wtsapi32.WTSQuerySessionInformation\n          - number: 5 = WTSUserName\n      - call:\n        - and:\n          - api: wtsapi32.WTSQuerySessionInformation\n          - number: 5 = WTSUserName\n      - api: System.Security.Principal.WindowsIdentity::GetCurrent\n      - property/read: System.Environment::UserName\n","matches":[[{"type":"absolute","value":4213704},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetUserName"}},"children":[],"locations":[{"type":"absolute","value":4213749}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetUserNameEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"get session user name/b123e5c56bf64b8492dc531a3be0b844"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"get session user name/bda47bd7f1d94cb9a7e859df7ed1d057"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Security.Principal.WindowsIdentity::GetCurrent"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::UserName"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4215096},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetUserName"}},"children":[],"locations":[{"type":"absolute","value":4215149}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetUserNameEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"get session user name/b123e5c56bf64b8492dc531a3be0b844"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"get session user name/bda47bd7f1d94cb9a7e859df7ed1d057"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Security.Principal.WindowsIdentity::GetCurrent"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::UserName"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4215236},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetUserName"}},"children":[],"locations":[{"type":"absolute","value":4215289}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetUserNameEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"get session user name/b123e5c56bf64b8492dc531a3be0b844"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"get session user name/bda47bd7f1d94cb9a7e859df7ed1d057"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Security.Principal.WindowsIdentity::GetCurrent"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::UserName"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"check for time delay via GetTickCount":{"meta":{"name":"check for time delay via GetTickCount","namespace":"anti-analysis/anti-debugging/debugger-detection","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"function"},"attack":[],"mbc":[{"parts":["Anti-Behavioral Analysis","Debugger Detection","Timing/Delay Check GetTickCount"],"objective":"Anti-Behavioral Analysis","behavior":"Debugger Detection","method":"Timing/Delay Check GetTickCount","id":"B0001.032"}],"references":[],"examples":["Practical Malware Analysis Lab 16-03.exe_:0x4013d0"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: check for time delay via GetTickCount\n    namespace: anti-analysis/anti-debugging/debugger-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires mnemonic features\n    mbc:\n      - Anti-Behavioral Analysis::Debugger Detection::Timing/Delay Check GetTickCount [B0001.032]\n    examples:\n      - Practical Malware Analysis Lab 16-03.exe_:0x4013d0\n  features:\n    - and:\n      - count(api(kernel32.GetTickCount)): 2 or more\n      - basic block:\n        - and:\n          - mnemonic: sub\n          - mnemonic: cmp\n","matches":[[{"type":"absolute","value":4214956},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"sub"}},"children":[],"locations":[{"type":"absolute","value":4215010}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"cmp"}},"children":[],"locations":[{"type":"absolute","value":4215012}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"sub"}},"children":[],"locations":[{"type":"absolute","value":4215000}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"cmp"}},"children":[],"locations":[{"type":"absolute","value":4215002}],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4215010},{"type":"absolute","value":4214956}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"range","min":2,"max":9223372036854775808,"child":{"type":"api","api":"GetTickCount"}}},"children":[],"locations":[{"type":"absolute","value":4214961},{"type":"absolute","value":4214978},{"type":"absolute","value":4214995}],"captures":{}}],"locations":[],"captures":{}}]]},"reference the VMWare IO port":{"meta":{"name":"reference the VMWare IO port","namespace":"anti-analysis/anti-vm/vm-detection","authors":["matthew.williams@mandiant.com"],"scopes":{"static":"function"},"attack":[{"parts":["Defense Evasion","Virtualization/Sandbox Evasion","System Checks"],"tactic":"Defense Evasion","technique":"Virtualization/Sandbox Evasion","subtechnique":"System Checks","id":"T1497.001"}],"mbc":[{"parts":["Anti-Behavioral Analysis","Virtual Machine Detection","Unique Hardware/Firmware Check - I/O Communication Port"],"objective":"Anti-Behavioral Analysis","behavior":"Virtual Machine Detection","method":"Unique Hardware/Firmware Check - I/O Communication Port","id":"B0009.025"}],"references":[],"examples":[],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: reference the VMWare IO port\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - matthew.williams@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires mnemonic features\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection::Unique Hardware/Firmware Check - I/O Communication Port [B0009.025]\n  features:\n    - and:\n      - mnemonic: in\n      - number: 0x564D5868 = VMXh\n      - number: 0x5658 = VX\n","matches":[[{"type":"absolute","value":4215028},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"in"}},"children":[],"locations":[{"type":"absolute","value":4215060}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":1447909480,"description":"VMXh"}},"children":[],"locations":[{"type":"absolute","value":4215041}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":22104,"description":"VX"}},"children":[],"locations":[{"type":"absolute","value":4215056}],"captures":{}}],"locations":[],"captures":{}}]]},"set registry value":{"meta":{"name":"set registry value","namespace":"host-interaction/registry/create","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"call"},"attack":[],"mbc":[{"parts":["Operating System","Registry","Set Registry Key"],"objective":"Operating System","behavior":"Registry","method":"Set Registry Key","id":"C0036.001"}],"references":[],"examples":["BFB9B5391A13D0AFD787E87AB90F14F5:0x13147AF0","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40415E","98c37c3c23bbfb362dac7754c6ba48e75cf24d73bc963a4cdfca557b9e016909:0x40294D"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: set registry value\n    namespace: host-interaction/registry/create\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    mbc:\n      - Operating System::Registry::Set Registry Key [C0036.001]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13147AF0\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40433E\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x40415E\n      - 98c37c3c23bbfb362dac7754c6ba48e75cf24d73bc963a4cdfca557b9e016909:0x40294D\n  features:\n    - or:\n      - and:\n        - optional:\n          - match: create or open registry key\n        - or:\n          - api: advapi32.RegSetValue\n          - api: advapi32.RegSetValueEx\n          - api: advapi32.RegSetKeyValue\n          - api: ZwSetValueKey\n          - api: NtSetValueKey\n          - api: RtlWriteRegistryValue\n          - api: SHSetValue\n          - api: SHRegSetPath\n          - api: SHRegSetValue\n          - api: SHRegSetUSValue\n          - api: SHRegWriteUSValue\n          - api: Microsoft.Win32.RegistryKey::SetValue\n          - api: Microsoft.Win32.Registry::SetValue\n      - and:\n        - match: host-interaction/process/create\n        - string: \"/add/i\"\n        - or:\n          - string: \"/reg(|.exe)/i\"\n          - string: \"/hklm/i\"\n          - string: \"/HKEY_LOCAL_MACHINE/i\"\n          - string: \"/hkcu/i\"\n          - string: \"/HKEY_CURRENT_USER/i\"\n","matches":[[{"type":"absolute","value":4215368},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"host-interaction/process/create"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/add/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/reg(|.exe)/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/hklm/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HKEY_LOCAL_MACHINE/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/hkcu/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HKEY_CURRENT_USER/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create or open registry key"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[{"type":"absolute","value":4215549}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[{"type":"absolute","value":4215549}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4215480},{"type":"absolute","value":4215485}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegSetValue"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegSetValueEx"}},"children":[],"locations":[{"type":"absolute","value":4215581}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegSetKeyValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwSetValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtSetValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlWriteRegistryValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHSetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegWriteUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::SetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.Registry::SetValue"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4215454},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"host-interaction/process/create"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/add/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/reg(|.exe)/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/hklm/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HKEY_LOCAL_MACHINE/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/hkcu/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HKEY_CURRENT_USER/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create or open registry key"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[{"type":"absolute","value":4215549}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4215480}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegSetValue"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegSetValueEx"}},"children":[],"locations":[{"type":"absolute","value":4215581}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegSetKeyValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwSetValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtSetValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlWriteRegistryValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHSetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegWriteUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::SetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.Registry::SetValue"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4215480},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"host-interaction/process/create"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/add/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/reg(|.exe)/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/hklm/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HKEY_LOCAL_MACHINE/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/hkcu/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HKEY_CURRENT_USER/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create or open registry key"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[{"type":"absolute","value":4215549}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4215480}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegSetValue"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegSetValueEx"}},"children":[],"locations":[{"type":"absolute","value":4215581}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegSetKeyValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwSetValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtSetValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlWriteRegistryValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHSetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegWriteUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::SetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.Registry::SetValue"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4218464},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"host-interaction/process/create"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/add/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/reg(|.exe)/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/hklm/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HKEY_LOCAL_MACHINE/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/hkcu/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HKEY_CURRENT_USER/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create or open registry key"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[{"type":"absolute","value":4218534}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218464}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegSetValue"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegSetValueEx"}},"children":[],"locations":[{"type":"absolute","value":4218574}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegSetKeyValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwSetValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtSetValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlWriteRegistryValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHSetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegSetUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegWriteUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::SetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.Registry::SetValue"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"check for VM using instruction VPCEXT":{"meta":{"name":"check for VM using instruction VPCEXT","namespace":"anti-analysis/anti-vm/vm-detection","authors":["richard.weiss@mandiant.com"],"scopes":{"static":"function"},"attack":[{"parts":["Defense Evasion","Virtualization/Sandbox Evasion"],"tactic":"Defense Evasion","technique":"Virtualization/Sandbox Evasion","subtechnique":"","id":"T1497"}],"mbc":[{"parts":["Anti-Behavioral Analysis","Virtual Machine Detection","Instruction Testing"],"objective":"Anti-Behavioral Analysis","behavior":"Virtual Machine Detection","method":"Instruction Testing","id":"B0009.029"}],"references":["https://unprotect.it/technique/vpcext/","https://research.nccgroup.com/2017/12/13/hidden-cobra-volgmer-a-technical-analysis/","https://shasaurabh.blogspot.com/2017/07/virtual-machine-detection-techniques.html"],"examples":[],"description":"Detects virtualization using VPCEXT (visual property container extender) instruction. Execution of this instruction will cause an illegal instruction exception outside of a virtual environment otherwise return 0","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: check for VM using instruction VPCEXT\n    # Please be aware: Vivisect does not support \"VPCEXT\" currently, so this rule works in IDA only.\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - richard.weiss@mandiant.com\n    description: Detects virtualization using VPCEXT (visual property container extender) instruction. Execution of this instruction will cause an illegal instruction exception outside of a virtual environment otherwise return 0\n    scopes:\n      static: function\n      dynamic: unsupported  # requires mnemonic features\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion [T1497]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection::Instruction Testing [B0009.029]\n    references:\n      - https://unprotect.it/technique/vpcext/\n      - https://research.nccgroup.com/2017/12/13/hidden-cobra-volgmer-a-technical-analysis/\n      - https://shasaurabh.blogspot.com/2017/07/virtual-machine-detection-techniques.html\n  features:\n    # vpcext imm8 imm8\n    # result in ebx\n    # if ebx == 0: Virtual PC detected, else: illegal instruction exception\n    - mnemonic: vpcext\n","matches":[[{"type":"absolute","value":4215368},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"vpcext"}},"children":[],"locations":[{"type":"absolute","value":4215414}],"captures":{}}],[{"type":"absolute","value":4215380},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"vpcext"}},"children":[],"locations":[{"type":"absolute","value":4215414}],"captures":{}}]]},"persist via Active Setup registry key":{"meta":{"name":"persist via Active Setup registry key","namespace":"persistence/registry","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[{"parts":["Persistence","Boot or Logon Autostart Execution","Active Setup"],"tactic":"Persistence","technique":"Boot or Logon Autostart Execution","subtechnique":"Active Setup","id":"T1547.014"}],"mbc":[],"references":["https://www.fireeye.com/blog/threat-research/2017/02/spear_phishing_techn.html"],"examples":["c335a9d41185a32ad918c5389ee54235:0x4028F0"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: persist via Active Setup registry key\n    namespace: persistence/registry\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    att&ck:\n      - Persistence::Boot or Logon Autostart Execution::Active Setup [T1547.014]\n    references:\n      - https://www.fireeye.com/blog/threat-research/2017/02/spear_phishing_techn.html\n    examples:\n      - c335a9d41185a32ad918c5389ee54235:0x4028F0\n  features:\n    - and:\n      - or:\n        - match: set registry value\n        - number: 0x80000002 = HKEY_LOCAL_MACHINE\n      - string: /Software\\\\Microsoft\\\\Active Setup\\\\Installed Components/i\n      - string: \"StubPath\"\n","matches":[[{"type":"absolute","value":4215648},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"string","string":"StubPath"}},"children":[],"locations":[{"type":"absolute","value":4216051}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/Software\\\\Microsoft\\\\Active Setup\\\\Installed Components/i"}},"children":[],"locations":[{"type":"absolute","value":4216038}],"captures":{"SOFTWARE\\Microsoft\\Active Setup\\Installed Components\\":[{"type":"absolute","value":4216038}]}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"set registry value"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2147483650,"description":"HKEY_LOCAL_MACHINE"}},"children":[],"locations":[{"type":"absolute","value":4216227},{"type":"absolute","value":4215765},{"type":"absolute","value":4216056},{"type":"absolute","value":4216093},{"type":"absolute","value":4215871}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"persist via Run registry key":{"meta":{"name":"persist via Run registry key","namespace":"persistence/registry/run","authors":["moritz.raabe@mandiant.com","mehunhoff@google.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[{"parts":["Persistence","Boot or Logon Autostart Execution","Registry Run Keys / Startup Folder"],"tactic":"Persistence","technique":"Boot or Logon Autostart Execution","subtechnique":"Registry Run Keys / Startup Folder","id":"T1547.001"}],"mbc":[{"parts":["Persistence","Registry Run Keys / Startup Folder"],"objective":"Persistence","behavior":"Registry Run Keys / Startup Folder","method":"","id":"F0012"}],"references":[],"examples":["Practical Malware Analysis Lab 06-03.exe_:0x401130","b87e9dd18a5533a09d3e48a7a1efbcf6:0x1400070E0","9ff8e68343cc29c1036650fc153e69f7:0x470624"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: persist via Run registry key\n    namespace: persistence/registry/run\n    authors:\n      - moritz.raabe@mandiant.com\n      - mehunhoff@google.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    att&ck:\n      - Persistence::Boot or Logon Autostart Execution::Registry Run Keys / Startup Folder [T1547.001]\n    mbc:\n      - Persistence::Registry Run Keys / Startup Folder [F0012]\n    examples:\n      - Practical Malware Analysis Lab 06-03.exe_:0x401130\n      - b87e9dd18a5533a09d3e48a7a1efbcf6:0x1400070E0\n      - 9ff8e68343cc29c1036650fc153e69f7:0x470624\n  features:\n    - and:\n      - or:\n        - match: set registry value\n        - number: 0x80000001 = HKEY_CURRENT_USER\n        - number: 0x80000002 = HKEY_LOCAL_MACHINE\n      - or:\n        - string: /Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run/i\n        - string: /Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Shell Folders/i\n        - string: /Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\User Shell Folders/i\n        - string: /Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunServices/i\n        - string: /Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run/i\n        - string: /Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\\\\Load/i\n        - string: /System\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Control\\\\Session Manager\\\\BootExecute/i\n","matches":[[{"type":"absolute","value":4215648},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"set registry value"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2147483649,"description":"HKEY_CURRENT_USER"}},"children":[],"locations":[{"type":"absolute","value":4215728},{"type":"absolute","value":4216294}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2147483650,"description":"HKEY_LOCAL_MACHINE"}},"children":[],"locations":[{"type":"absolute","value":4216227},{"type":"absolute","value":4215765},{"type":"absolute","value":4216056},{"type":"absolute","value":4216093},{"type":"absolute","value":4215871}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Run/i"}},"children":[],"locations":[{"type":"absolute","value":4215723}],"captures":{"Software\\Microsoft\\Windows\\CurrentVersion\\Run":[{"type":"absolute","value":4215723}]}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Explorer\\\\Shell Folders/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\User Shell Folders/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\RunServices/i"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/Software\\\\Microsoft\\\\Windows\\\\CurrentVersion\\\\Policies\\\\Explorer\\\\Run/i"}},"children":[],"locations":[{"type":"absolute","value":4216289}],"captures":{"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\Explorer\\Run":[{"type":"absolute","value":4216289}]}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Windows\\\\Load/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/System\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Control\\\\Session Manager\\\\BootExecute/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"persist via Winlogon Helper DLL registry key":{"meta":{"name":"persist via Winlogon Helper DLL registry key","namespace":"persistence/registry/winlogon-helper","authors":["0x534a@mailbox.org","j.j.vannielen@utwente.nl"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[{"parts":["Persistence","Boot or Logon Autostart Execution","Winlogon Helper DLL"],"tactic":"Persistence","technique":"Boot or Logon Autostart Execution","subtechnique":"Winlogon Helper DLL","id":"T1547.004"}],"mbc":[],"references":["https://learn.microsoft.com/en-us/previous-versions/windows/desktop/policy/creating-a-policy-callback-function"],"examples":["9ff8e68343cc29c1036650fc153e69f7:0x47f818"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: persist via Winlogon Helper DLL registry key\n    namespace: persistence/registry/winlogon-helper\n    authors:\n      - 0x534a@mailbox.org\n      - j.j.vannielen@utwente.nl\n    scopes:\n      static: function\n      dynamic: span of calls\n    att&ck:\n      - Persistence::Boot or Logon Autostart Execution::Winlogon Helper DLL [T1547.004]\n    references:\n      - https://learn.microsoft.com/en-us/previous-versions/windows/desktop/policy/creating-a-policy-callback-function\n    examples:\n      - 9ff8e68343cc29c1036650fc153e69f7:0x47f818\n  features:\n    - and:\n      - or:\n        - match: set registry value\n        - number: 0x80000001 = HKEY_CURRENT_USER\n        - number: 0x80000002 = HKEY_LOCAL_MACHINE\n      - string: /Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon/i\n      - or:\n        - string: /Notify/i\n        - string: /Userinit/i\n        - string: /Shell/i\n        - string: /mpnotify/i\n        - and:\n          - string: /GPExtensions/i\n          - string: /DllName/i\n","matches":[[{"type":"absolute","value":4215648},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/Software\\\\Microsoft\\\\Windows NT\\\\CurrentVersion\\\\Winlogon/i"}},"children":[],"locations":[{"type":"absolute","value":4215760},{"type":"absolute","value":4216088},{"type":"absolute","value":4215866},{"type":"absolute","value":4216222}],"captures":{"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon":[{"type":"absolute","value":4215760},{"type":"absolute","value":4216088},{"type":"absolute","value":4215866},{"type":"absolute","value":4216222}]}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"set registry value"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2147483649,"description":"HKEY_CURRENT_USER"}},"children":[],"locations":[{"type":"absolute","value":4215728},{"type":"absolute","value":4216294}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2147483650,"description":"HKEY_LOCAL_MACHINE"}},"children":[],"locations":[{"type":"absolute","value":4216227},{"type":"absolute","value":4215765},{"type":"absolute","value":4216056},{"type":"absolute","value":4216093},{"type":"absolute","value":4215871}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/Notify/i"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/Userinit/i"}},"children":[],"locations":[{"type":"absolute","value":4216217},{"type":"absolute","value":4216083}],"captures":{"UserInit":[{"type":"absolute","value":4216083}],"Userinit":[{"type":"absolute","value":4216217}]}},{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/Shell/i"}},"children":[],"locations":[{"type":"absolute","value":4215755},{"type":"absolute","value":4215861}],"captures":{"Shell":[{"type":"absolute","value":4215755},{"type":"absolute","value":4215861}]}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/mpnotify/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/GPExtensions/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/DllName/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"query environment variable":{"meta":{"name":"query environment variable","namespace":"host-interaction/environment-variable","authors":["michael.hunhoff@mandiant.com","@_re_fox"],"scopes":{"static":"function","dynamic":"call"},"attack":[{"parts":["Discovery","System Information Discovery"],"tactic":"Discovery","technique":"System Information Discovery","subtechnique":"","id":"T1082"}],"mbc":[{"parts":["Discovery","System Information Discovery"],"objective":"Discovery","behavior":"System Information Discovery","method":"","id":"E1082"}],"references":[],"examples":["Practical Malware Analysis Lab 14-02.exe_:0x401880","0761142efbda6c4b1e801223de723578:0x65483490"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: query environment variable\n    namespace: host-interaction/environment-variable\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@_re_fox\"\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    mbc:\n      - Discovery::System Information Discovery [E1082]\n    examples:\n      - Practical Malware Analysis Lab 14-02.exe_:0x401880\n      - 0761142efbda6c4b1e801223de723578:0x65483490\n  features:\n    - or:\n      - api: kernel32.GetEnvironmentVariable\n      - api: kernel32.GetEnvironmentStrings\n      - api: kernel32.ExpandEnvironmentStrings\n      - api: msvcr90.getenv\n      - api: msvcrt.getenv\n      - api: System.Environment::GetEnvironmentVariable\n      - api: System.Environment::GetEnvironmentVariables\n      - api: System.Environment::ExpandEnvironmentVariables\n","matches":[[{"type":"absolute","value":4216872},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetEnvironmentVariable"}},"children":[],"locations":[{"type":"absolute","value":4216957}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetEnvironmentStrings"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ExpandEnvironmentStrings"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"getenv"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::GetEnvironmentVariable"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::GetEnvironmentVariables"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::ExpandEnvironmentVariables"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4220436},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetEnvironmentVariable"}},"children":[],"locations":[{"type":"absolute","value":4220529}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetEnvironmentStrings"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ExpandEnvironmentStrings"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"getenv"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::GetEnvironmentVariable"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::GetEnvironmentVariables"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Environment::ExpandEnvironmentVariables"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"query or enumerate registry value":{"meta":{"name":"query or enumerate registry value","namespace":"host-interaction/registry","authors":["william.ballenthin@mandiant.com","michael.hunhoff@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[{"parts":["Discovery","Query Registry"],"tactic":"Discovery","technique":"Query Registry","subtechnique":"","id":"T1012"}],"mbc":[{"parts":["Operating System","Registry","Query Registry Value"],"objective":"Operating System","behavior":"Registry","method":"Query Registry Value","id":"C0036.006"}],"references":[],"examples":["BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A","Practical Malware Analysis Lab 03-02.dll_:0x100047AD"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: query or enumerate registry value\n    namespace: host-interaction/registry\n    authors:\n      - william.ballenthin@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    att&ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Value [C0036.006]\n    examples:\n      - BFB9B5391A13D0AFD787E87AB90F14F5:0x13145B5A\n      - Practical Malware Analysis Lab 03-02.dll_:0x100047AD\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegGetValue\n        - api: advapi32.RegEnumValue\n        - api: advapi32.RegQueryValue\n        - api: advapi32.RegQueryValueEx\n        - api: advapi32.RegQueryMultipleValues\n        - api: ZwQueryValueKey\n        - api: ZwEnumerateValueKey\n        - api: NtQueryValueKey\n        - api: NtEnumerateValueKey\n        - api: RtlQueryRegistryValues\n        - api: SHGetValue\n        - api: SHEnumValue\n        - api: SHRegGetInt\n        - api: SHRegGetPath\n        - api: SHRegGetValue\n        - api: SHQueryValueEx\n        - api: SHRegGetUSValue\n        - api: SHOpenRegStream\n        - api: SHRegEnumUSValue\n        - api: SHOpenRegStream2\n        - api: SHRegQueryUSValue\n        - api: SHRegGetBoolUSValue\n        - api: SHRegGetValueFromHKCUHKLM\n        - api: SHRegGetBoolValueFromHKCUHKLM\n        - api: Microsoft.Win32.RegistryKey::GetValue\n        - api: Microsoft.Win32.RegistryKey::GetValueKind\n        - api: Microsoft.Win32.RegistryKey::GetValueNames\n        - api: Microsoft.Win32.Registry::GetValue\n","matches":[[{"type":"absolute","value":4218240},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create or open registry key"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[{"type":"absolute","value":4218311}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218240}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegGetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegEnumValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegQueryValue"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegQueryValueEx"}},"children":[],"locations":[{"type":"absolute","value":4218379},{"type":"absolute","value":4218341}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegQueryMultipleValues"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwEnumerateValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtEnumerateValueKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlQueryRegistryValues"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHGetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHEnumValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegGetInt"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegGetPath"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegGetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHQueryValueEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegGetUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHOpenRegStream"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegEnumUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHOpenRegStream2"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegQueryUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegGetBoolUSValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegGetValueFromHKCUHKLM"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegGetBoolValueFromHKCUHKLM"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::GetValue"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::GetValueKind"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::GetValueNames"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.Registry::GetValue"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"spawn thread to RWX shellcode":{"meta":{"name":"spawn thread to RWX shellcode","namespace":"load-code/shellcode","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[],"mbc":[{"parts":["Memory","Allocate Memory"],"objective":"Memory","behavior":"Allocate Memory","method":"","id":"C0007"},{"parts":["Process","Create Thread"],"objective":"Process","behavior":"Create Thread","method":"","id":"C0038"}],"references":[],"examples":["Practical Malware Analysis Lab 19-02.exe_:0x401230"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: spawn thread to RWX shellcode\n    namespace: load-code/shellcode\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    mbc:\n      - Memory::Allocate Memory [C0007]\n      - Process::Create Thread [C0038]\n    examples:\n      - Practical Malware Analysis Lab 19-02.exe_:0x401230\n  features:\n    - and:\n      - match: allocate or change RWX memory\n      - match: create thread\n","matches":[[{"type":"absolute","value":4218700},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[{"type":"absolute","value":4218918},{"type":"absolute","value":4218846}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218744}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":64,"description":"PAGE_EXECUTE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":4218816},{"type":"absolute","value":4218906}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/6c2c434a278b4b1b9489b3bac72ff5d9/169a9469648947a5abf30e3d2c455873"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218744}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/efde64e8d4064c3d933c2c1ba9650038"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[{"type":"absolute","value":4218963}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218948}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":64,"description":"PAGE_EXECUTE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":4218948}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/6c2c434a278b4b1b9489b3bac72ff5d9/169a9469648947a5abf30e3d2c455873"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218948}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/efde64e8d4064c3d933c2c1ba9650038"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218744},{"type":"absolute","value":4218948}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create thread"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"pthread_create"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Thread::Start"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Thread::ctor"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_beginthread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_beginthreadex"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"PsCreateSystemThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateThreadWithHandle"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateRemoteThread"}},"children":[],"locations":[{"type":"absolute","value":4219013}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateRemoteThreadEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateUserThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateThreadEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateThreadEx"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4219000}],"captures":{}}],"locations":[],"captures":{}}]]},"inject thread":{"meta":{"name":"inject thread","namespace":"host-interaction/process/inject","authors":["anamaria.martinezgom@mandiant.com","0x534a@mailbox.org"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[{"parts":["Defense Evasion","Process Injection","Thread Execution Hijacking"],"tactic":"Defense Evasion","technique":"Process Injection","subtechnique":"Thread Execution Hijacking","id":"T1055.003"},{"parts":["Defense Evasion","Reflective Code Loading"],"tactic":"Defense Evasion","technique":"Reflective Code Loading","subtechnique":"","id":"T1620"}],"mbc":[],"references":[],"examples":["Practical Malware Analysis Lab 12-01.exe_:0x4010D0","2D3EDC218A90F03089CC01715A9F047F:0x4027CF"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: inject thread\n    namespace: host-interaction/process/inject\n    authors:\n      - anamaria.martinezgom@mandiant.com\n      - 0x534a@mailbox.org\n    scopes:\n      static: function\n      dynamic: span of calls\n    att&ck:\n      - Defense Evasion::Process Injection::Thread Execution Hijacking [T1055.003]\n      - Defense Evasion::Reflective Code Loading [T1620]\n    examples:\n      - Practical Malware Analysis Lab 12-01.exe_:0x4010D0\n      - 2D3EDC218A90F03089CC01715A9F047F:0x4027CF\n  features:\n    - and:\n      - or:\n        - match: allocate or change RWX memory\n        - match: allocate or change RW memory\n      - match: write process memory\n      - match: create thread\n      - optional:\n        - or:\n          - match: host-interaction/process/create\n          - match: open process\n          - number: 0x3000 = MEM_COMMIT or MEM_RESERVE\n","matches":[[{"type":"absolute","value":4218700},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"write process memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"WriteProcessMemory"}},"children":[],"locations":[{"type":"absolute","value":4218937}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWow64WriteVirtualMemory64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"WriteProcessMemory"}},"children":[],"locations":[{"type":"absolute","value":4218986}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWow64WriteVirtualMemory64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"WriteProcessMemory"}},"children":[],"locations":[{"type":"absolute","value":4218901}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwWriteVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtWow64WriteVirtualMemory64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218937},{"type":"absolute","value":4218986},{"type":"absolute","value":4218901}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create thread"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"linux"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"os","os":"android"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"pthread_create"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Thread::Start"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.Threading.Thread::ctor"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"os","os":"windows"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_beginthread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_beginthreadex"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"PsCreateSystemThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHCreateThreadWithHandle"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"CreateRemoteThread"}},"children":[],"locations":[{"type":"absolute","value":4219013}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"CreateRemoteThreadEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateUserThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateThreadEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateThread"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateThreadEx"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4219000}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[{"type":"absolute","value":4218918},{"type":"absolute","value":4218846}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218744}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":64,"description":"PAGE_EXECUTE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":4218816},{"type":"absolute","value":4218906}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/6c2c434a278b4b1b9489b3bac72ff5d9/169a9469648947a5abf30e3d2c455873"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218744}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/efde64e8d4064c3d933c2c1ba9650038"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAlloc"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocEx"}},"children":[],"locations":[{"type":"absolute","value":4218963}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VirtualAllocExNuma"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwAllocateVirtualMemory"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwMapViewOfSection"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate memory/2fdaddfa00074f0f8df497413481ec1e"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218948}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"change memory protection"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":64,"description":"PAGE_EXECUTE_READWRITE"}},"children":[],"locations":[{"type":"absolute","value":4218948}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/6c2c434a278b4b1b9489b3bac72ff5d9/169a9469648947a5abf30e3d2c455873"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218948}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RWX memory/efde64e8d4064c3d933c2c1ba9650038"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4218744},{"type":"absolute","value":4218948}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"allocate or change RW memory"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"host-interaction/process/create"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"open process"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":12288,"description":"MEM_COMMIT or MEM_RESERVE"}},"children":[],"locations":[{"type":"absolute","value":4218818},{"type":"absolute","value":4218908},{"type":"absolute","value":4218950}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"query or enumerate registry key":{"meta":{"name":"query or enumerate registry key","namespace":"host-interaction/registry","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[{"parts":["Discovery","Query Registry"],"tactic":"Discovery","technique":"Query Registry","subtechnique":"","id":"T1012"}],"mbc":[{"parts":["Operating System","Registry","Query Registry Key"],"objective":"Operating System","behavior":"Registry","method":"Query Registry Key","id":"C0036.005"}],"references":[],"examples":["493167E85E45363D09495D0841C30648:0x404930","B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402608"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: query or enumerate registry key\n    namespace: host-interaction/registry\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    att&ck:\n      - Discovery::Query Registry [T1012]\n    mbc:\n      - Operating System::Registry::Query Registry Key [C0036.005]\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x404930\n      - B5F85C26D7AA5A1FB4AF5821B6B5AB9B:0x402608\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegEnumKey\n        - api: advapi32.RegEnumKeyEx\n        - api: advapi32.RegQueryInfoKeyA\n        - api: ZwQueryKey\n        - api: ZwEnumerateKey\n        - api: NtQueryKey\n        - api: NtEnumerateKey\n        - api: RtlCheckRegistryKey\n        - api: SHEnumKeyEx\n        - api: SHQueryInfoKey\n        - api: SHRegEnumUSKey\n        - api: SHRegQueryInfoUSKey\n        - api: Microsoft.Win32.RegistryKey::GetSubKeyNames\n        - api: Microsoft.Win32.RegistryKey::OpenBaseKey\n        - api: Microsoft.Win32.RegistryKey::OpenRemoteBaseKey\n        - api: Microsoft.Win32.RegistryKey::OpenSubKey\n","matches":[[{"type":"absolute","value":4219092},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"create or open registry key"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegEnumKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegEnumKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegQueryInfoKeyA"}},"children":[],"locations":[{"type":"absolute","value":4219257}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwEnumerateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtEnumerateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCheckRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHEnumKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHQueryInfoKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegEnumUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegQueryInfoUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::GetSubKeyNames"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4219200},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"create or open registry key"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegEnumKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegEnumKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegQueryInfoKeyA"}},"children":[],"locations":[{"type":"absolute","value":4219257}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwEnumerateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtEnumerateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCheckRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHEnumKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHQueryInfoKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegEnumUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegQueryInfoUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::GetSubKeyNames"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4219920},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create or open registry key"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[{"type":"absolute","value":4220102}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4220078}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegEnumKey"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegEnumKeyEx"}},"children":[],"locations":[{"type":"absolute","value":4220210}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegQueryInfoKeyA"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwQueryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwEnumerateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtQueryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtEnumerateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCheckRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHEnumKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHQueryInfoKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegEnumUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegQueryInfoUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::GetSubKeyNames"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"delete registry key":{"meta":{"name":"delete registry key","namespace":"host-interaction/registry/delete","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com","johnk3r"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[{"parts":["Defense Evasion","Modify Registry"],"tactic":"Defense Evasion","technique":"Modify Registry","subtechnique":"","id":"T1112"}],"mbc":[{"parts":["Operating System","Registry","Delete Registry Key"],"objective":"Operating System","behavior":"Registry","method":"Delete Registry Key","id":"C0036.002"}],"references":[],"examples":["4f11bdb380dafa2518053c6d20147a05:0x402A36","493167E85E45363D09495D0841C30648:0x404D60"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: delete registry key\n    namespace: host-interaction/registry/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - johnk3r\n    scopes:\n      static: function\n      dynamic: span of calls\n    att&ck:\n      - Defense Evasion::Modify Registry [T1112]\n    mbc:\n      - Operating System::Registry::Delete Registry Key [C0036.002]\n    examples:\n      - 4f11bdb380dafa2518053c6d20147a05:0x402A36\n      - 493167E85E45363D09495D0841C30648:0x404D60\n  features:\n    - and:\n      - optional:\n        - match: create or open registry key\n      - or:\n        - api: advapi32.RegDeleteKey\n        - api: advapi32.RegDeleteTree\n        - api: advapi32.RegDeleteKeyEx\n        - api: advapi32.RegDeleteKeyTransacted\n        - api: ZwDeleteKey\n        - api: NtDeleteKey\n        - api: SHDeleteKey\n        - api: SHDeleteEmptyKey\n        - api: SHRegDeleteEmptyUSKey\n        - api: Microsoft.Win32.RegistryKey::DeleteSubKey\n        - api: Microsoft.Win32.RegistryKey::DeleteSubKeyTree\n","matches":[[{"type":"absolute","value":4219920},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"create or open registry key"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyEx"}},"children":[],"locations":[{"type":"absolute","value":4220102}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenCurrentUser"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegOpenUserClassesRoot"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwOpenKeyTransactedEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwCreateKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtOpenKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtCreateKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegOpenUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegCreateUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlCreateRegistryKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::OpenRemoteBaseKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::CreateSubKey"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4220078}],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegDeleteKey"}},"children":[],"locations":[{"type":"absolute","value":4220357}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegDeleteTree"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegDeleteKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegDeleteKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwDeleteKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDeleteKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHDeleteKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHDeleteEmptyKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegDeleteEmptyUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::DeleteSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::DeleteSubKeyTree"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4220344},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"optional"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"create or open registry key"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"RegDeleteKey"}},"children":[],"locations":[{"type":"absolute","value":4220357}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegDeleteTree"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegDeleteKeyEx"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RegDeleteKeyTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwDeleteKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDeleteKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHDeleteKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHDeleteEmptyKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"SHRegDeleteEmptyUSKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::DeleteSubKey"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"Microsoft.Win32.RegistryKey::DeleteSubKeyTree"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"delete file":{"meta":{"name":"delete file","namespace":"host-interaction/file-system/delete","authors":["moritz.raabe@mandiant.com","michael.hunhoff@mandiant.com"],"scopes":{"static":"function","dynamic":"span of calls"},"attack":[],"mbc":[{"parts":["File System","Delete File"],"objective":"File System","behavior":"Delete File","method":"","id":"C0047"}],"references":[],"examples":["946A99F36A46D335DEC080D9A4371940:0x100015F0","31600AD0D1A7EA615690DF111AE36C73:0x401A15","563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: delete file\n    namespace: host-interaction/file-system/delete\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: function\n      dynamic: span of calls\n    mbc:\n      - File System::Delete File [C0047]\n    examples:\n      - 946A99F36A46D335DEC080D9A4371940:0x100015F0\n      # MoveFileEx\n      - 31600AD0D1A7EA615690DF111AE36C73:0x401A15\n      # NtDeleteFile\n      - 563653399B82CD443F120ECEFF836EA3678D4CF11D9B351BB737573C2D856299:0x140001E04\n  features:\n    - or:\n      - api: kernel32.DeleteFile\n      - api: DeleteFileTransacted\n      - api: NtDeleteFile\n      - api: ZwDeleteFile\n      - api: remove\n      - api: _wremove\n      - api: System.IO.File::Delete\n      - api: System.IO.FileSystemInfo::Delete\n      # static\n      - basic block:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - basic block:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n      # dynamic\n      - call:\n        - and:\n          - number: 3 = FO_DELETE\n          - or:\n            - api: kernel32.SHFileOperation\n      - call:\n        - and:\n          - number: 4 = MOVEFILE_DELAY_UNTIL_REBOOT\n          - number: 0 = NULL\n          - api: MoveFileEx\n","matches":[[{"type":"absolute","value":4221400},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"DeleteFile"}},"children":[],"locations":[{"type":"absolute","value":4222600}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"DeleteFileTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDeleteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwDeleteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"remove"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_wremove"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::Delete"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.FileSystemInfo::Delete"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/3dea0a1f332e46e18220995e539c6c97"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/69f57b290a2048f69106082b90abbfdd"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/cd389c98fdd64e90ad3b9b3f715b2d84"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/5bf25487e6e3477b97d6549f0bb01083"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4221424},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"DeleteFile"}},"children":[],"locations":[{"type":"absolute","value":4222600}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"DeleteFileTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDeleteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwDeleteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"remove"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_wremove"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::Delete"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.FileSystemInfo::Delete"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/3dea0a1f332e46e18220995e539c6c97"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/69f57b290a2048f69106082b90abbfdd"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/cd389c98fdd64e90ad3b9b3f715b2d84"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/5bf25487e6e3477b97d6549f0bb01083"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4221440},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"DeleteFile"}},"children":[],"locations":[{"type":"absolute","value":4222600}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"DeleteFileTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDeleteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwDeleteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"remove"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_wremove"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::Delete"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.FileSystemInfo::Delete"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/3dea0a1f332e46e18220995e539c6c97"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/69f57b290a2048f69106082b90abbfdd"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/cd389c98fdd64e90ad3b9b3f715b2d84"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/5bf25487e6e3477b97d6549f0bb01083"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4221564},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"DeleteFile"}},"children":[],"locations":[{"type":"absolute","value":4222600}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"DeleteFileTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDeleteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwDeleteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"remove"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_wremove"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::Delete"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.FileSystemInfo::Delete"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/3dea0a1f332e46e18220995e539c6c97"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/69f57b290a2048f69106082b90abbfdd"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/cd389c98fdd64e90ad3b9b3f715b2d84"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/5bf25487e6e3477b97d6549f0bb01083"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4221632},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"DeleteFile"}},"children":[],"locations":[{"type":"absolute","value":4222600}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"DeleteFileTransacted"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"NtDeleteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"ZwDeleteFile"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"remove"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"_wremove"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.File::Delete"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"System.IO.FileSystemInfo::Delete"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/3dea0a1f332e46e18220995e539c6c97"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/69f57b290a2048f69106082b90abbfdd"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/cd389c98fdd64e90ad3b9b3f715b2d84"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"delete file/5bf25487e6e3477b97d6549f0bb01083"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get number of processors":{"meta":{"name":"get number of processors","namespace":"host-interaction/hardware/cpu","authors":["michael.hunhoff@mandiant.com","anushka.virgaonkar@mandiant.com"],"scopes":{"static":"function"},"attack":[{"parts":["Discovery","System Information Discovery"],"tactic":"Discovery","technique":"System Information Discovery","subtechnique":"","id":"T1082"}],"mbc":[],"references":["https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiVM/Generic.cpp#L361"],"examples":["al-khaser_x86.exe_:0x432CB0"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: get number of processors\n    namespace: host-interaction/hardware/cpu\n    authors:\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires property features\n    att&ck:\n      - Discovery::System Information Discovery [T1082]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/bed03d2f849d9060c68f8d5905bd204d0cb3f593/al-khaser/AntiVM/Generic.cpp#L361\n    examples:\n      - al-khaser_x86.exe_:0x432CB0\n  features:\n    - or:\n      - and:\n        - match: PEB access\n        - or:\n          - and:\n            - arch: i386\n            - number: 0x64 = PEB->NumberOfProcessors\n          - and:\n            - arch: amd64\n            - number: 0xB8 = PEB->NumberOfProcessors\n      - property/read: System.Environment::ProcessorCount\n","matches":[[{"type":"absolute","value":4221400},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::ProcessorCount"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"PEB access"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"peb access"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"fs access"}},"children":[],"locations":[{"type":"absolute","value":4221680},{"type":"absolute","value":4221667},{"type":"absolute","value":4221683}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/88764106f5a94371815f1d9eb5cad20b"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"fs access"}},"children":[],"locations":[{"type":"absolute","value":4221680},{"type":"absolute","value":4221667},{"type":"absolute","value":4221683}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"offset","offset":48}},"children":[],"locations":[{"type":"absolute","value":4221663}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/6c3d766652914e2292b3c7d154c170c9"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"gs access"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":96}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/3cf9a9d68a3b48fd861333c91313fed9"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4221660}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":100,"description":"PEB->NumberOfProcessors"}},"children":[],"locations":[{"type":"absolute","value":4222630}],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":184,"description":"PEB->NumberOfProcessors"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4221424},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::ProcessorCount"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"PEB access"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"peb access"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"fs access"}},"children":[],"locations":[{"type":"absolute","value":4221680},{"type":"absolute","value":4221667},{"type":"absolute","value":4221683}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/88764106f5a94371815f1d9eb5cad20b"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"fs access"}},"children":[],"locations":[{"type":"absolute","value":4221680},{"type":"absolute","value":4221667},{"type":"absolute","value":4221683}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"offset","offset":48}},"children":[],"locations":[{"type":"absolute","value":4221663}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/6c3d766652914e2292b3c7d154c170c9"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"gs access"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":96}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/3cf9a9d68a3b48fd861333c91313fed9"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4221660}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":100,"description":"PEB->NumberOfProcessors"}},"children":[],"locations":[{"type":"absolute","value":4222630}],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":184,"description":"PEB->NumberOfProcessors"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],[{"type":"absolute","value":4221440},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"property","access":"read","property":"System.Environment::ProcessorCount"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"PEB access"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"peb access"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"fs access"}},"children":[],"locations":[{"type":"absolute","value":4221680},{"type":"absolute","value":4221667},{"type":"absolute","value":4221683}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/88764106f5a94371815f1d9eb5cad20b"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"fs access"}},"children":[],"locations":[{"type":"absolute","value":4221680},{"type":"absolute","value":4221667},{"type":"absolute","value":4221683}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"offset","offset":48}},"children":[],"locations":[{"type":"absolute","value":4221663}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/6c3d766652914e2292b3c7d154c170c9"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"gs access"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":96}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access/3cf9a9d68a3b48fd861333c91313fed9"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4221660}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":100,"description":"PEB->NumberOfProcessors"}},"children":[],"locations":[{"type":"absolute","value":4222630}],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":184,"description":"PEB->NumberOfProcessors"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"encrypt data using RC4 KSA":{"meta":{"name":"encrypt data using RC4 KSA","namespace":"data-manipulation/encryption/rc4","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"function"},"attack":[{"parts":["Defense Evasion","Obfuscated Files or Information"],"tactic":"Defense Evasion","technique":"Obfuscated Files or Information","subtechnique":"","id":"T1027"}],"mbc":[{"parts":["Cryptography","Encrypt Data","RC4"],"objective":"Cryptography","behavior":"Encrypt Data","method":"RC4","id":"C0027.009"},{"parts":["Cryptography","Encryption Key","RC4 KSA"],"objective":"Cryptography","behavior":"Encryption Key","method":"RC4 KSA","id":"C0028.002"}],"references":[],"examples":["34404A3FB9804977C6AB86CB991FB130:0x403D40","9324D1A8AE37A36AE560C37448C9705A:0x404950","2B8BEC5BCB1777EAA155D832F7AFC797:0x405C42","73CE04892E5F39EC82B00C02FC04C70F:0x40646E"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: encrypt data using RC4 KSA\n    namespace: data-manipulation/encryption/rc4\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: function\n      dynamic: unsupported  # requires characteristic, mnemonic, Not features\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Cryptography::Encrypt Data::RC4 [C0027.009]\n      - Cryptography::Encryption Key::RC4 KSA [C0028.002]\n    examples:\n      - 34404A3FB9804977C6AB86CB991FB130:0x403D40\n      - 9324D1A8AE37A36AE560C37448C9705A:0x404950\n      - 2B8BEC5BCB1777EAA155D832F7AFC797:0x405C42\n      - 73CE04892E5F39EC82B00C02FC04C70F:0x40646E\n  features:\n    - or:\n      - and:\n        - basic block:\n          - and:\n            - description: initialize S\n            # misses if regular loop is used,\n            # however we cannot model that a loop contains a certain number\n            - characteristic: tight loop\n            - or:\n              - number: 0xFF\n              - number: 0x100\n        - or:\n          - description: modulo 256\n          - match: calculate modulo 256 via x86 assembly\n          - basic block:\n            - and:\n              - description: modulo via zero-extended mov from 8-bit register\n              - count(mnemonic(movzx)): 2 or more\n              # avoid false positives; filter out unexpected instructions\n              - not:\n                - or:\n                  - mnemonic: shl\n                  - mnemonic: rol\n                  - characteristic: nzxor\n        - or:\n          - description: modulo key length\n          - mnemonic: div\n          - mnemonic: idiv\n      - and:\n        - description: write DWORDs instead of bytes\n        - or:\n          - number: 0x03020100\n          - number: 0xFFFEFDFC\n        - instruction:\n          - or:\n            - mnemonic: add\n            - mnemonic: sub\n          - number: 0x04040404\n","matches":[[{"type":"absolute","value":4223436},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and","description":"write DWORDs instead of bytes"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":50462976}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":4294901244}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"encrypt data using RC4 KSA/2eed35fa422f4f6fa06414239699f314"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"subscope","scope":"basic block"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and","description":"initialize S"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"characteristic","characteristic":"tight loop"}},"children":[],"locations":[{"type":"absolute","value":4223560}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":256}},"children":[],"locations":[{"type":"absolute","value":4223566}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4223560}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or","description":"modulo 256"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"calculate modulo 256 via x86 assembly"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4223815}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4223815}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4223748}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[{"type":"absolute","value":4223748}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4223637}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[{"type":"absolute","value":4223637}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4223847}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[{"type":"absolute","value":4223847}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4223610}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[{"type":"absolute","value":4223610}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"and"}},"children":[],"locations":[{"type":"absolute","value":4223774}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"number","number":2147483903}},"children":[],"locations":[{"type":"absolute","value":4223774}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"number","number":255}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"absolute","value":4223815},{"type":"absolute","value":4223748},{"type":"absolute","value":4223637},{"type":"absolute","value":4223847},{"type":"absolute","value":4223610},{"type":"absolute","value":4223774}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"encrypt data using RC4 KSA/69b9bcb8d53a4bd5b4bad56384d0d6c8"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or","description":"modulo key length"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"div"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"mnemonic","mnemonic":"idiv"}},"children":[],"locations":[{"type":"absolute","value":4223597}],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"get OS version":{"meta":{"name":"get OS version","authors":["@mr-tz"],"scopes":{"static":"function","dynamic":"call"},"attack":[],"mbc":[],"references":[],"examples":["493167E85E45363D09495D0841C30648:0x401000","5f66b82558ca92e54e77f216ef4c066c:0x44580A"],"description":"","lib":true,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: get OS version\n    authors:\n      - \"@mr-tz\"\n    lib: true\n    scopes:\n      static: function\n      dynamic: call\n    examples:\n      - 493167E85E45363D09495D0841C30648:0x401000\n      - 5f66b82558ca92e54e77f216ef4c066c:0x44580A\n  features:\n    - or:\n      - api: RtlGetVersion\n      - api: ntoskrnl.PsGetVersion\n      - api: GetVersion\n      - api: GetVersionEx\n      - api: VerifyVersionInfo\n      - api: VerSetConditionMask\n      - api: RtlGetNtVersionNumbers\n      - api: GetProductInfo\n      - and:\n        - match: PEB access\n        - or:\n          - and:\n            - arch: i386\n            - or:\n              - offset: 0xA4 = PEB->OSMajorVersion\n              - offset: 0xA8 = PEB->OSMinorVersion\n              - offset: 0xAC = PEB->OSBuildNumber\n          - and:\n            - arch: amd64\n            - or:\n              - offset: 0x118 = PEB->OSMajorVersion\n              - offset: 0x11C = PEB->OSMinorVersion\n              - offset: 0x120 = PEB->OSBuildNumber\n","matches":[[{"type":"absolute","value":4224048},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlGetVersion"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"PsGetVersion"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetVersion"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"api","api":"GetVersionEx"}},"children":[],"locations":[{"type":"absolute","value":4224077}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VerifyVersionInfo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"VerSetConditionMask"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"RtlGetNtVersionNumbers"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"api","api":"GetProductInfo"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"match","match":"PEB access"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"arch","arch":"i386"}},"children":[],"locations":[{"type":"no address"}],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":164,"description":"PEB->OSMajorVersion"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":168,"description":"PEB->OSMinorVersion"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":172,"description":"PEB->OSBuildNumber"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"arch","arch":"amd64"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":280,"description":"PEB->OSMajorVersion"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":284,"description":"PEB->OSMinorVersion"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"offset","offset":288,"description":"PEB->OSBuildNumber"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"contain a thread local storage (.tls) section":{"meta":{"name":"contain a thread local storage (.tls) section","namespace":"executable/pe/section/tls","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"file","dynamic":"file"},"attack":[],"mbc":[],"references":[],"examples":["Practical Malware Analysis Lab 16-02.exe_"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: contain a thread local storage (.tls) section\n    namespace: executable/pe/section/tls\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - Practical Malware Analysis Lab 16-02.exe_\n  features:\n    - section: .tls\n","matches":[[{"type":"no address"},{"success":true,"node":{"type":"feature","feature":{"type":"section","section":".tls"}},"children":[],"locations":[{"type":"absolute","value":4243456}],"captures":{}}]]},"reference anti-VM strings targeting VirtualBox":{"meta":{"name":"reference anti-VM strings targeting VirtualBox","namespace":"anti-analysis/anti-vm/vm-detection","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"file","dynamic":"file"},"attack":[{"parts":["Defense Evasion","Virtualization/Sandbox Evasion","System Checks"],"tactic":"Defense Evasion","technique":"Virtualization/Sandbox Evasion","subtechnique":"System Checks","id":"T1497.001"}],"mbc":[{"parts":["Anti-Behavioral Analysis","Virtual Machine Detection"],"objective":"Anti-Behavioral Analysis","behavior":"Virtual Machine Detection","method":"","id":"B0009"}],"references":["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VirtualBox.cpp"],"examples":["al-khaser_x86.exe_"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: reference anti-VM strings targeting VirtualBox\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VirtualBox.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /VBOX/i\n      - string: /VEN_VBOX/i\n      - string: /VirtualBox/i\n      - string: /06/23/99/i\n      - string: /HARDWARE\\\\ACPI\\\\DSDT\\\\VBOX__/i\n      - string: /HARDWARE\\\\ACPI\\\\FADT\\\\VBOX__/i\n      - string: /HARDWARE\\\\ACPI\\\\RSDT\\\\VBOX__/i\n      - string: /SOFTWARE\\\\Oracle\\\\VirtualBox Guest Additions/i\n      - string: /SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxGuest/i\n      - string: /SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxMouse/i\n      - string: /SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxService/i\n      - string: /SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxSF/i\n      - string: /SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxVideo/i\n      - string: /VBoxMouse\\.sys/i\n      - string: /VBoxGuest\\.sys/i\n      - string: /VBoxSF\\.sys/i\n      - string: /VBoxVideo\\.sys/i\n      - string: /vboxdisp\\.dll/i\n      - string: /vboxhook\\.dll/i\n      - string: /vboxmrxnp\\.dll/i\n      - string: /vboxogl\\.dll/i\n      - string: /vboxoglarrayspu\\.dll/i\n      - string: /vboxoglcrutil\\.dll/i\n      - string: /vboxoglerrorspu\\.dll/i\n      - string: /vboxoglfeedbackspu\\.dll/i\n      - string: /vboxoglpackspu\\.dll/i\n      - string: /vboxoglpassthroughspu\\.dll/i\n      - string: /vboxservice\\.exe/i\n      - string: /vboxtray\\.exe/i\n      - string: /VBoxControl\\.exe/i\n      - string: /oracle\\\\virtualbox guest additions\\\\/i\n      - string: /\\\\\\\\\\.\\\\VBoxMiniRdrDN/i\n      - string: /\\\\\\\\\\.\\\\VBoxGuest/i\n      - string: /\\\\\\\\\\.\\\\pipe\\\\VBoxMiniRdDN/i\n      - string: /\\\\\\\\\\.\\\\VBoxTrayIPC/i\n      - string: /\\\\\\\\\\.\\\\pipe\\\\VBoxTrayIPC/i\n      - string: /VBoxTrayToolWndClass/i\n      - string: /VBoxTrayToolWnd/i\n      - string: /vboxvideo/i\n      - string: /VBoxVideoW8/i\n      - string: /VBoxWddm/i\n      - string: /PCI\\\\VEN_80EE&DEV_CAFE/i\n      - string: /82801FB/i\n      - string: /82441FX/i\n      - string: /82371SB/i\n      - string: /OpenHCD/i\n      - string: /ACPIBus_BUS_0/i\n      - string: /PCI_BUS_0/i\n      - string: /PNP_BUS_0/i\n      - string: /Oracle Corporation/i\n      - string: /VBoxWdd/i\n      - string: /VBoxS/i\n        description: VirtualBox Shared Folders\n      - string: /VBoxMouse/i\n        description: VirtualBox Guest Mouse\n      - string: /VBoxGuest/i\n        description: VirtualBox Guest Driver\n      - string: /VBoxVBoxVBox/i\n      - string: /innotek GmbH/i\n      - string: /drivers\\\\vboxdrv/i\n","matches":[[{"type":"no address"},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBOX/i"}},"children":[],"locations":[{"type":"file","value":17056}],"captures":{"VBoxService.exe":[{"type":"file","value":17056}]}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VEN_VBOX/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VirtualBox/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/06/23/99/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HARDWARE\\\\ACPI\\\\DSDT\\\\VBOX__/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HARDWARE\\\\ACPI\\\\FADT\\\\VBOX__/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HARDWARE\\\\ACPI\\\\RSDT\\\\VBOX__/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SOFTWARE\\\\Oracle\\\\VirtualBox Guest Additions/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxGuest/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxMouse/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxService/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxSF/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxVideo/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxMouse\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxGuest\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxSF\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxVideo\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxdisp\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxhook\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxmrxnp\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxogl\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxoglarrayspu\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxoglcrutil\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxoglerrorspu\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxoglfeedbackspu\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxoglpackspu\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxoglpassthroughspu\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxservice\\.exe/i"}},"children":[],"locations":[{"type":"file","value":17056}],"captures":{"VBoxService.exe":[{"type":"file","value":17056}]}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxtray\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxControl\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/oracle\\\\virtualbox guest additions\\\\/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/\\\\\\\\\\.\\\\VBoxMiniRdrDN/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/\\\\\\\\\\.\\\\VBoxGuest/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/\\\\\\\\\\.\\\\pipe\\\\VBoxMiniRdDN/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/\\\\\\\\\\.\\\\VBoxTrayIPC/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/\\\\\\\\\\.\\\\pipe\\\\VBoxTrayIPC/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxTrayToolWndClass/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxTrayToolWnd/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxvideo/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxVideoW8/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxWddm/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/PCI\\\\VEN_80EE&DEV_CAFE/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/82801FB/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/82441FX/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/82371SB/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/OpenHCD/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/ACPIBus_BUS_0/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/PCI_BUS_0/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/PNP_BUS_0/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/Oracle Corporation/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxWdd/i"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxS/i","description":"VirtualBox Shared Folders"}},"children":[],"locations":[{"type":"file","value":17056}],"captures":{"VBoxService.exe":[{"type":"file","value":17056}]}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxMouse/i","description":"VirtualBox Guest Mouse"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxGuest/i","description":"VirtualBox Guest Driver"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxVBoxVBox/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/innotek GmbH/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/drivers\\\\vboxdrv/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]}}}
