{"meta":{"timestamp":"2025-07-01T13:12:57.263580","version":"9.2.1","argv":["sample/2a971b99dc2971b6252cf3c071c9f337.exe","-f","pe","-vvv","--json"],"sample":{"md5":"2a971b99dc2971b6252cf3c071c9f337","sha1":"9fc7788329b6852735e9fa5bd24e2b25d868b938","sha256":"2f67744573d667af558eaac47ff054853f05406b7e0adac19665d0deec54aa72","path":"/home/GokbakarE/sample/2a971b99dc2971b6252cf3c071c9f337.exe"},"flavor":"static","analysis":{"format":"pe","arch":"i386","os":"windows","extractor":"VivisectFeatureExtractor","rules":["/tmp/_MEI22Tjd7/rules"],"base_address":{"type":"absolute","value":4194304},"layout":{"functions":[]},"feature_counts":{"file":2493,"functions":[{"address":{"type":"absolute","value":4337622},"count":5}]},"library_functions":[]}},"rules":{"compiled to the .NET platform":{"meta":{"name":"compiled to the .NET platform","namespace":"runtime/dotnet","authors":["william.ballenthin@mandiant.com"],"scopes":{"static":"file","dynamic":"file"},"attack":[],"mbc":[],"references":[],"examples":["b9f5bd514485fb06da39beff051b9fdc"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: compiled to the .NET platform\n    namespace: runtime/dotnet\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - b9f5bd514485fb06da39beff051b9fdc\n  features:\n    - or:\n      - format: dotnet\n      - import: mscoree._CorExeMain\n      - import: mscoree._corexemain\n      - import: mscoree._CorDllMain\n      - import: mscoree._cordllmain\n","matches":[[{"type":"no address"},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"format","format":"dotnet"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"import","import_":"mscoree._CorExeMain"}},"children":[],"locations":[{"type":"absolute","value":4202496}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"import","import_":"mscoree._corexemain"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"import","import_":"mscoree._CorDllMain"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"import","import_":"mscoree._cordllmain"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"obfuscated with SmartAssembly":{"meta":{"name":"obfuscated with SmartAssembly","namespace":"anti-analysis/obfuscation","authors":["jakub.jozwiak@mandiant.com"],"scopes":{"static":"file","dynamic":"file"},"attack":[{"parts":["Defense Evasion","Obfuscated Files or Information"],"tactic":"Defense Evasion","technique":"Obfuscated Files or Information","subtechnique":"","id":"T1027"}],"mbc":[{"parts":["Anti-Static Analysis","Executable Code Obfuscation"],"objective":"Anti-Static Analysis","behavior":"Executable Code Obfuscation","method":"","id":"B0032"}],"references":["https://www.red-gate.com/products/dotnet-development/smartassembly/"],"examples":["2dae11cc5f86f5399b560b8837c26274b7e09431deed669b0844fef44e917915"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: obfuscated with SmartAssembly\n    namespace: anti-analysis/obfuscation\n    authors:\n      - jakub.jozwiak@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    att&ck:\n      - Defense Evasion::Obfuscated Files or Information [T1027]\n    mbc:\n      - Anti-Static Analysis::Executable Code Obfuscation [B0032]\n    references:\n      - https://www.red-gate.com/products/dotnet-development/smartassembly/\n    examples:\n      - 2dae11cc5f86f5399b560b8837c26274b7e09431deed669b0844fef44e917915\n  features:\n    - and:\n      - match: compiled to the .NET platform\n      - or:\n        - string: \"Powered by SmartAssembly\"\n        - string: \"Powered by {smartassembly}\"\n        - string: \"SmartAssembly.Attributes\"\n        - string: \"SmartAssembly.Attributes.PoweredByAttribute\"\n","matches":[[{"type":"no address"},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"match","match":"compiled to the .NET platform"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"format","format":"dotnet"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"import","import_":"mscoree._CorExeMain"}},"children":[],"locations":[{"type":"absolute","value":4202496}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"import","import_":"mscoree._corexemain"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"import","import_":"mscoree._CorDllMain"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"import","import_":"mscoree._cordllmain"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[{"type":"no address"}],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"string","string":"Powered by SmartAssembly"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"string","string":"Powered by {smartassembly}"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"string","string":"SmartAssembly.Attributes"}},"children":[],"locations":[{"type":"file","value":92005}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"string","string":"SmartAssembly.Attributes.PoweredByAttribute"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"reference anti-VM strings targeting VMWare":{"meta":{"name":"reference anti-VM strings targeting VMWare","namespace":"anti-analysis/anti-vm/vm-detection","authors":["michael.hunhoff@mandiant.com","@johnk3r"],"scopes":{"static":"file","dynamic":"file"},"attack":[{"parts":["Defense Evasion","Virtualization/Sandbox Evasion","System Checks"],"tactic":"Defense Evasion","technique":"Virtualization/Sandbox Evasion","subtechnique":"System Checks","id":"T1497.001"}],"mbc":[{"parts":["Anti-Behavioral Analysis","Virtual Machine Detection"],"objective":"Anti-Behavioral Analysis","behavior":"Virtual Machine Detection","method":"","id":"B0009"}],"references":["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VMWare.cpp"],"examples":["al-khaser_x86.exe_","b83480162ede09d4aa6d4850f9faa0a4c3834152752fd04cfdb22d647aa1f825:0x17D80"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: reference anti-VM strings targeting VMWare\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n      - \"@johnk3r\"\n    scopes:\n      static: file\n      dynamic: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VMWare.cpp\n    examples:\n      - al-khaser_x86.exe_\n      - b83480162ede09d4aa6d4850f9faa0a4c3834152752fd04cfdb22d647aa1f825:0x17D80\n  features:\n    - or:\n      - string: /VMWare/i\n      - string: /VMTools/i\n      - string: /SOFTWARE\\\\VMware, Inc\\.\\\\VMware Tools/i\n      - string: /vmnet\\.sys/i\n      - string: /vmmouse\\.sys/i\n      - string: /vmusb\\.sys/i\n      - string: /vm3dmp\\.sys/i\n      - string: /vmci\\.sys/i\n      - string: /vmhgfs\\.sys/i\n      - string: /vmmemctl\\.sys/i\n      - string: /vmx86\\.sys/i\n      - string: /vmrawdsk\\.sys/i\n      - string: /vmusbmouse\\.sys/i\n      - string: /vmkdb\\.sys/i\n      - string: /vmnetuserif\\.sys/i\n      - string: /vmnetadapter\\.sys/i\n      - string: /\\\\\\\\\\.\\\\HGFS/i\n      - string: /\\\\\\\\\\.\\\\vmci/i\n      - string: /vmtoolsd\\.exe/i\n      - string: /vmwaretray\\.exe/i\n      - string: /vmwareuser\\.exe/i\n      - string: /VGAuthService\\.exe/i\n      - string: /vmacthlp\\.exe/i\n      - string: /vmci/i\n        description: VMWare VMCI Bus Driver\n      - string: /vmhgfs/i\n        description: VMWare Host Guest Control Redirector\n      - string: /vmmouse/i\n      - string: /vmmemctl/i\n        description: VMWare Guest Memory Controller Driver\n      - string: /vmusb/i\n      - string: /vmusbmouse/i\n      - string: /vmx_svga/i\n      - string: /vmxnet/i\n      - string: /vmx86/i\n      - string: /VMwareVMware/i\n      - string: /vmGuestLib\\.dll/i\n      - string: /Applications\\\\VMwareHostOpen\\.exe/i\n      - string: /vm3dgl\\.dll/i\n      - string: /vmdum\\.dll/i\n      - string: /vm3dver\\.dll/i\n      - string: /vmtray\\.dll/i\n      - string: /VMToolsHook\\.dll/i\n      - string: /vmmousever\\.dll/i\n      - string: /VmGuestLibJava\\.dll/i\n      - string: /vmscsi\\.sys/i\n","matches":[[{"type":"no address"},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/VMWare/i"}},"children":[],"locations":[{"type":"file","value":97842},{"type":"file","value":115394},{"type":"file","value":115364},{"type":"file","value":97830},{"type":"file","value":92986}],"captures":{"VmWare":[{"type":"file","value":92986}],"AntiVmWare2":[{"type":"file","value":97830}],"AntiVmWare":[{"type":"file","value":97842}],"VMware SVGA 3D":[{"type":"file","value":115364}],"VMware SVGA II":[{"type":"file","value":115394}]}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VMTools/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SOFTWARE\\\\VMware, Inc\\.\\\\VMware Tools/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmnet\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmmouse\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmusb\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vm3dmp\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmci\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmhgfs\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmmemctl\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmx86\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmrawdsk\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmusbmouse\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmkdb\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmnetuserif\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmnetadapter\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/\\\\\\\\\\.\\\\HGFS/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/\\\\\\\\\\.\\\\vmci/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmtoolsd\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmwaretray\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmwareuser\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VGAuthService\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmacthlp\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmci/i","description":"VMWare VMCI Bus Driver"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmhgfs/i","description":"VMWare Host Guest Control Redirector"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmmouse/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmmemctl/i","description":"VMWare Guest Memory Controller Driver"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmusb/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmusbmouse/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmx_svga/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmxnet/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmx86/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VMwareVMware/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmGuestLib\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/Applications\\\\VMwareHostOpen\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vm3dgl\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmdum\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vm3dver\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmtray\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VMToolsHook\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmmousever\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VmGuestLibJava\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmscsi\\.sys/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"reference anti-VM strings targeting VirtualBox":{"meta":{"name":"reference anti-VM strings targeting VirtualBox","namespace":"anti-analysis/anti-vm/vm-detection","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"file","dynamic":"file"},"attack":[{"parts":["Defense Evasion","Virtualization/Sandbox Evasion","System Checks"],"tactic":"Defense Evasion","technique":"Virtualization/Sandbox Evasion","subtechnique":"System Checks","id":"T1497.001"}],"mbc":[{"parts":["Anti-Behavioral Analysis","Virtual Machine Detection"],"objective":"Anti-Behavioral Analysis","behavior":"Virtual Machine Detection","method":"","id":"B0009"}],"references":["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VirtualBox.cpp"],"examples":["al-khaser_x86.exe_"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: reference anti-VM strings targeting VirtualBox\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/VirtualBox.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /VBOX/i\n      - string: /VEN_VBOX/i\n      - string: /VirtualBox/i\n      - string: /06/23/99/i\n      - string: /HARDWARE\\\\ACPI\\\\DSDT\\\\VBOX__/i\n      - string: /HARDWARE\\\\ACPI\\\\FADT\\\\VBOX__/i\n      - string: /HARDWARE\\\\ACPI\\\\RSDT\\\\VBOX__/i\n      - string: /SOFTWARE\\\\Oracle\\\\VirtualBox Guest Additions/i\n      - string: /SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxGuest/i\n      - string: /SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxMouse/i\n      - string: /SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxService/i\n      - string: /SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxSF/i\n      - string: /SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxVideo/i\n      - string: /VBoxMouse\\.sys/i\n      - string: /VBoxGuest\\.sys/i\n      - string: /VBoxSF\\.sys/i\n      - string: /VBoxVideo\\.sys/i\n      - string: /vboxdisp\\.dll/i\n      - string: /vboxhook\\.dll/i\n      - string: /vboxmrxnp\\.dll/i\n      - string: /vboxogl\\.dll/i\n      - string: /vboxoglarrayspu\\.dll/i\n      - string: /vboxoglcrutil\\.dll/i\n      - string: /vboxoglerrorspu\\.dll/i\n      - string: /vboxoglfeedbackspu\\.dll/i\n      - string: /vboxoglpackspu\\.dll/i\n      - string: /vboxoglpassthroughspu\\.dll/i\n      - string: /vboxservice\\.exe/i\n      - string: /vboxtray\\.exe/i\n      - string: /VBoxControl\\.exe/i\n      - string: /oracle\\\\virtualbox guest additions\\\\/i\n      - string: /\\\\\\\\\\.\\\\VBoxMiniRdrDN/i\n      - string: /\\\\\\\\\\.\\\\VBoxGuest/i\n      - string: /\\\\\\\\\\.\\\\pipe\\\\VBoxMiniRdDN/i\n      - string: /\\\\\\\\\\.\\\\VBoxTrayIPC/i\n      - string: /\\\\\\\\\\.\\\\pipe\\\\VBoxTrayIPC/i\n      - string: /VBoxTrayToolWndClass/i\n      - string: /VBoxTrayToolWnd/i\n      - string: /vboxvideo/i\n      - string: /VBoxVideoW8/i\n      - string: /VBoxWddm/i\n      - string: /PCI\\\\VEN_80EE&DEV_CAFE/i\n      - string: /82801FB/i\n      - string: /82441FX/i\n      - string: /82371SB/i\n      - string: /OpenHCD/i\n      - string: /ACPIBus_BUS_0/i\n      - string: /PCI_BUS_0/i\n      - string: /PNP_BUS_0/i\n      - string: /Oracle Corporation/i\n      - string: /VBoxWdd/i\n      - string: /VBoxS/i\n        description: VirtualBox Shared Folders\n      - string: /VBoxMouse/i\n        description: VirtualBox Guest Mouse\n      - string: /VBoxGuest/i\n        description: VirtualBox Guest Driver\n      - string: /VBoxVBoxVBox/i\n      - string: /innotek GmbH/i\n      - string: /drivers\\\\vboxdrv/i\n","matches":[[{"type":"no address"},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBOX/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VEN_VBOX/i"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/VirtualBox/i"}},"children":[],"locations":[{"type":"file","value":115424},{"type":"file","value":92993},{"type":"file","value":97853}],"captures":{"VirtualBox":[{"type":"file","value":92993}],"AntiVirtualBox":[{"type":"file","value":97853}],"VirtualBox Graphics Adapter":[{"type":"file","value":115424}]}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/06/23/99/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HARDWARE\\\\ACPI\\\\DSDT\\\\VBOX__/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HARDWARE\\\\ACPI\\\\FADT\\\\VBOX__/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HARDWARE\\\\ACPI\\\\RSDT\\\\VBOX__/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SOFTWARE\\\\Oracle\\\\VirtualBox Guest Additions/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxGuest/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxMouse/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxService/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxSF/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\VBoxVideo/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxMouse\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxGuest\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxSF\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxVideo\\.sys/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxdisp\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxhook\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxmrxnp\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxogl\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxoglarrayspu\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxoglcrutil\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxoglerrorspu\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxoglfeedbackspu\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxoglpackspu\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxoglpassthroughspu\\.dll/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxservice\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxtray\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxControl\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/oracle\\\\virtualbox guest additions\\\\/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/\\\\\\\\\\.\\\\VBoxMiniRdrDN/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/\\\\\\\\\\.\\\\VBoxGuest/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/\\\\\\\\\\.\\\\pipe\\\\VBoxMiniRdDN/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/\\\\\\\\\\.\\\\VBoxTrayIPC/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/\\\\\\\\\\.\\\\pipe\\\\VBoxTrayIPC/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxTrayToolWndClass/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxTrayToolWnd/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vboxvideo/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxVideoW8/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxWddm/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/PCI\\\\VEN_80EE&DEV_CAFE/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/82801FB/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/82441FX/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/82371SB/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/OpenHCD/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/ACPIBus_BUS_0/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/PCI_BUS_0/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/PNP_BUS_0/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/Oracle Corporation/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxWdd/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxS/i","description":"VirtualBox Shared Folders"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxMouse/i","description":"VirtualBox Guest Mouse"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxGuest/i","description":"VirtualBox Guest Driver"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/VBoxVBoxVBox/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/innotek GmbH/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/drivers\\\\vboxdrv/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"reference analysis tools strings":{"meta":{"name":"reference analysis tools strings","namespace":"anti-analysis","authors":["michael.hunhoff@mandiant.com"],"scopes":{"static":"file","dynamic":"file"},"attack":[],"mbc":[{"parts":["Discovery","Analysis Tool Discovery","Process detection"],"objective":"Discovery","behavior":"Analysis Tool Discovery","method":"Process detection","id":"B0013.001"}],"references":["https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiAnalysis/process.cpp"],"examples":["al-khaser_x86.exe_"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: reference analysis tools strings\n    namespace: anti-analysis\n    authors:\n      - michael.hunhoff@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    mbc:\n      - Discovery::Analysis Tool Discovery::Process detection [B0013.001]\n    references:\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiAnalysis/process.cpp\n    examples:\n      - al-khaser_x86.exe_\n  features:\n    - or:\n      - string: /ollydbg(\\.exe)?/i\n      - string: /ProcessHacker(\\.exe)?/i\n      - string: /tcpview(\\.exe)?/i\n      - string: /autoruns(\\.exe)?/i\n      - string: /autorunsc(\\.exe)?/i\n      - string: /filemon(\\.exe)?/i\n      - string: /procmon(\\.exe)?/i\n      - string: /regmon(\\.exe)?/i\n      - string: /procexp(\\.exe)?/i\n      - string: /(?<!\\w)ida[gqtuw]?(\\.exe)?$/i\n      - string: /ida[gqtuw]?64(\\.exe)?$/i\n      - string: /ImmunityDebugger(\\.exe)?/i\n      - string: /Wireshark(\\.exe)?/i\n      - string: /dumpcap(\\.exe)?/i\n      - string: /HookExplorer(\\.exe)?/i\n      - string: /ImportREC(\\.exe)?/i\n      - string: /PETools(\\.exe)?/i\n      - string: /LordPE(\\.exe)?/i\n      - string: /SysInspector(\\.exe)?/i\n      - string: /proc_analyzer(\\.exe)?/i\n      - string: /sysAnalyzer(\\.exe)?/i\n      - string: /sniff_hit(\\.exe)?/i\n      - string: /windbg(\\.exe)?/i\n      - string: /joeboxcontrol(\\.exe)?/i\n      - string: /joeboxserver(\\.exe)?/i\n      - string: /ResourceHacker(\\.exe)?/i\n      - string: /x32dbg(\\.exe)?/i\n      - string: /x64dbg(\\.exe)?/i\n      - string: /Fiddler(\\.exe)?/i\n      - string: /httpdebugger(\\.exe)?/i\n      - string: /fakenet(\\.exe)?/i\n      - string: /netmon(\\.exe)?/i\n      - string: /WPE PRO(\\.exe)?/i\n      - string: /decompile(\\.exe)?/i\n      - string: /scylla/i\n      - string: /megadumper/i\n","matches":[[{"type":"no address"},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/ollydbg(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/ProcessHacker(\\.exe)?/i"}},"children":[],"locations":[{"type":"file","value":116214}],"captures":{"processhacker":[{"type":"file","value":116214}]}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/tcpview(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/autoruns(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/autorunsc(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/filemon(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/procmon(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/regmon(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/procexp(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/(?<!\\w)ida[gqtuw]?(\\.exe)?$/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/ida[gqtuw]?64(\\.exe)?$/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/ImmunityDebugger(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/Wireshark(\\.exe)?/i"}},"children":[],"locations":[{"type":"file","value":120744},{"type":"file","value":93004}],"captures":{"wireshark":[{"type":"file","value":120744},{"type":"file","value":93004}]}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/dumpcap(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HookExplorer(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/ImportREC(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/PETools(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/LordPE(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SysInspector(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/proc_analyzer(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/sysAnalyzer(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/sniff_hit(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/windbg(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/joeboxcontrol(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/joeboxserver(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/ResourceHacker(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/x32dbg(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/x64dbg(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/Fiddler(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/httpdebugger(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/fakenet(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/netmon(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/WPE PRO(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/decompile(\\.exe)?/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/scylla/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/megadumper/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"reference anti-VM strings":{"meta":{"name":"reference anti-VM strings","namespace":"anti-analysis/anti-vm/vm-detection","authors":["moritz.raabe@mandiant.com"],"scopes":{"static":"file","dynamic":"file"},"attack":[{"parts":["Defense Evasion","Virtualization/Sandbox Evasion","System Checks"],"tactic":"Defense Evasion","technique":"Virtualization/Sandbox Evasion","subtechnique":"System Checks","id":"T1497.001"}],"mbc":[{"parts":["Anti-Behavioral Analysis","Virtual Machine Detection"],"objective":"Anti-Behavioral Analysis","behavior":"Virtual Machine Detection","method":"","id":"B0009"}],"references":["https://github.com/ctxis/CAPE/blob/master/modules/signatures/antivm_*","https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp"],"examples":["Practical Malware Analysis Lab 17-02.dll_"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: reference anti-VM strings\n    namespace: anti-analysis/anti-vm/vm-detection\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    att&ck:\n      - Defense Evasion::Virtualization/Sandbox Evasion::System Checks [T1497.001]\n    mbc:\n      - Anti-Behavioral Analysis::Virtual Machine Detection [B0009]\n    references:\n      - https://github.com/ctxis/CAPE/blob/master/modules/signatures/antivm_*\n      - https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp\n    examples:\n      - Practical Malware Analysis Lab 17-02.dll_\n  features:\n    - or:\n      - string: /HARDWARE\\\\ACPI\\\\(DSDT|FADT|RSDT)\\\\BOCHS/i\n      - string: /HARDWARE\\\\DESCRIPTION\\\\System\\\\(SystemBiosVersion|VideoBiosVersion)/i\n      - string: /HARDWARE\\\\DESCRIPTION\\\\System\\\\CentralProcessor/i\n      - string: /HARDWARE\\\\DEVICEMAP\\\\Scsi\\\\Scsi Port 0\\\\Scsi Bus 0\\\\Target Id 0\\\\Logical Unit Id 0/i\n      - string: /SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Enum\\\\IDE/i\n      - string: /SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\Disk\\\\Enum\\\\/i\n      - string: /SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Control\\\\SystemInformation\\\\SystemManufacturer/i\n      - string: /A M I/i\n      - string: /Hyper-V/i\n      - string: /Kernel-VMDetection-Private/i\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L699\n      - string: /KVMKVMKVM/i\n        description: KVM\n      - string: /Microsoft Hv/i\n        description: Microsoft Hyper-V or Windows Virtual PC\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L8\n      - string: /avghookx\\.dll/i\n        description: AVG\n      - string: /avghooka\\.dll/i\n        description: AVG\n      - string: /snxhk\\.dll/i\n        description: Avast\n      - string: /pstorec\\.dll/i\n        description: SunBelt Sandbox\n      - string: /vmcheck\\.dll/i\n        description: Virtual PC\n      - string: /wpespy\\.dll/i\n        description: WPE Pro\n      - string: /cmdvrt64\\.dll/i\n        description: Comodo Container\n      - string: /cmdvrt32\\.dll/i\n        description: Comodo Container\n      # https://github.com/LordNoteworthy/al-khaser/blob/master/al-khaser/AntiVM/Generic.cpp#L46\n      - string: /sample\\.exe/i\n      - string: /bot\\.exe/i\n      - string: /sandbox\\.exe/i\n      - string: /malware\\.exe/i\n      - string: /test\\.exe/i\n      - string: /klavme\\.exe/i\n      - string: /myapp\\.exe/i\n      - string: /testapp\\.exe/i\n","matches":[[{"type":"no address"},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HARDWARE\\\\ACPI\\\\(DSDT|FADT|RSDT)\\\\BOCHS/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HARDWARE\\\\DESCRIPTION\\\\System\\\\(SystemBiosVersion|VideoBiosVersion)/i"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/HARDWARE\\\\DESCRIPTION\\\\System\\\\CentralProcessor/i"}},"children":[],"locations":[{"type":"file","value":120874},{"type":"file","value":116941}],"captures":{"HKEY_LOCAL_MACHINE\\HARDWARE\\DESCRIPTION\\SYSTEM\\CENTRALPROCESSOR\\0":[{"type":"file","value":116941}],"Hardware\\Description\\System\\CentralProcessor\\0":[{"type":"file","value":120874}]}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/HARDWARE\\\\DEVICEMAP\\\\Scsi\\\\Scsi Port 0\\\\Scsi Bus 0\\\\Target Id 0\\\\Logical Unit Id 0/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Enum\\\\IDE/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Services\\\\Disk\\\\Enum\\\\/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SYSTEM\\\\(ControlSet\\d{3}|CurrentControlSet)\\\\Control\\\\SystemInformation\\\\SystemManufacturer/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/A M I/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/Hyper-V/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/Kernel-VMDetection-Private/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/KVMKVMKVM/i","description":"KVM"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/Microsoft Hv/i","description":"Microsoft Hyper-V or Windows Virtual PC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/avghookx\\.dll/i","description":"AVG"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/avghooka\\.dll/i","description":"AVG"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/snxhk\\.dll/i","description":"Avast"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/pstorec\\.dll/i","description":"SunBelt Sandbox"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/vmcheck\\.dll/i","description":"Virtual PC"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/wpespy\\.dll/i","description":"WPE Pro"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/cmdvrt64\\.dll/i","description":"Comodo Container"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/cmdvrt32\\.dll/i","description":"Comodo Container"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/sample\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/bot\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/sandbox\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/malware\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/test\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/klavme\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/myapp\\.exe/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/testapp\\.exe/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"gather chrome based browser login information":{"meta":{"name":"gather chrome based browser login information","namespace":"collection/browser","authors":["@_re_fox","still@teamt5.org"],"scopes":{"static":"file","dynamic":"file"},"attack":[{"parts":["Credential Access","Credentials from Password Stores","Credentials from Web Browsers"],"tactic":"Credential Access","technique":"Credentials from Password Stores","subtechnique":"Credentials from Web Browsers","id":"T1555.003"}],"mbc":[],"references":[],"examples":["2fd45662e3d0ec0077ea2fa66b6378f0:0x6000039","54390bda109aab7fc006b8b4ead5b6c2:0x1006E8D3"],"description":"","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: gather chrome based browser login information\n    namespace: collection/browser\n    authors:\n      - \"@_re_fox\"\n      - still@teamt5.org\n    scopes:\n      static: file\n      dynamic: file\n    att&ck:\n      - Credential Access::Credentials from Password Stores::Credentials from Web Browsers [T1555.003]\n    examples:\n      - 2fd45662e3d0ec0077ea2fa66b6378f0:0x6000039\n      - 54390bda109aab7fc006b8b4ead5b6c2:0x1006E8D3\n  features:\n    - and:\n      - or:\n        - string: /\\\\+(Edge|Chrome|Chromium|Brave\\-Browser|YandexBrowser|Kometa|Orbitum|Dragon|Torch|Amigo)\\\\+User Data\\\\+Default(\\\\+Network)?\\\\+(Cookies|Login Data)/i\n        - string: /\\\\Opera Software\\\\Opera Stable\\\\(Login Data|Cookies)/i\n      - or:\n        - string: /SELECT ((date_created|username_element|password_element|origin_url|signon_realm|action_url|username_value|password_value),?\\s?)+ FROM logins/i\n        - string: /SELECT ((creation_utc|encrypted_value),?\\s?)+ FROM cookies/i\n        - 2 or more:\n          - substring: \"date_created\"\n          - substring: \"encrypted_value\"\n          - substring: \"creation_utc\"\n          - substring: \"username_element\"\n          - substring: \"username_value\"\n          - substring: \"password_element\"\n          - substring: \"origin_url\"\n          - substring: \"signon_realm\"\n          - substring: \"action_url\"\n          - substring: \"password_value\"\n","matches":[[{"type":"no address"},{"success":true,"node":{"type":"statement","statement":{"type":"and"}},"children":[{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":true,"node":{"type":"feature","feature":{"type":"regex","regex":"/\\\\+(Edge|Chrome|Chromium|Brave\\-Browser|YandexBrowser|Kometa|Orbitum|Dragon|Torch|Amigo)\\\\+User Data\\\\+Default(\\\\+Network)?\\\\+(Cookies|Login Data)/i"}},"children":[],"locations":[{"type":"file","value":124675}],"captures":{"\\Google\\Chrome\\User Data\\Default\\Login Data":[{"type":"file","value":124675}]}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/\\\\Opera Software\\\\Opera Stable\\\\(Login Data|Cookies)/i"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SELECT ((date_created|username_element|password_element|origin_url|signon_realm|action_url|username_value|password_value),?\\s?)+ FROM logins/i"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"regex","regex":"/SELECT ((creation_utc|encrypted_value),?\\s?)+ FROM cookies/i"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"statement","statement":{"type":"some","count":2}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"substring","substring":"date_created"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"substring","substring":"encrypted_value"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"substring","substring":"creation_utc"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"substring","substring":"username_element"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"substring","substring":"username_value"}},"children":[],"locations":[{"type":"file","value":124799}],"captures":{"username_value":[{"type":"file","value":124799}]}},{"success":false,"node":{"type":"feature","feature":{"type":"substring","substring":"password_element"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"substring","substring":"origin_url"}},"children":[],"locations":[{"type":"file","value":124777}],"captures":{"origin_url":[{"type":"file","value":124777}]}},{"success":false,"node":{"type":"feature","feature":{"type":"substring","substring":"signon_realm"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"substring","substring":"action_url"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"substring","substring":"password_value"}},"children":[],"locations":[{"type":"file","value":124829}],"captures":{"password_value":[{"type":"file","value":124829}]}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]},"(internal) .NET file limitation":{"meta":{"name":"(internal) .NET file limitation","namespace":"internal/limitation/dynamic","authors":["@v1bh475u"],"scopes":{"static":"file","dynamic":"file"},"attack":[],"mbc":[],"references":[],"examples":["2f8a79b12a7a989ac7e5f6ec65050036588a92e65aeb6841e08dc228ff0e21b4_min_archive.zip"],"description":"This dynamic analysis trace describes a .NET file.\n\ncapa rules are not yet tuned for the .NET runtime, \nso its analysis may be incomplete or misleading.\n","lib":false,"is_subscope_rule":false,"maec":{}},"source":"rule:\n  meta:\n    name: (internal) .NET file limitation\n    namespace: internal/limitation/dynamic\n    authors:\n      - \"@v1bh475u\"\n    description: |\n      This dynamic analysis trace describes a .NET file.\n\n      capa rules are not yet tuned for the .NET runtime, \n      so its analysis may be incomplete or misleading.\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - 2f8a79b12a7a989ac7e5f6ec65050036588a92e65aeb6841e08dc228ff0e21b4_min_archive.zip\n  features:\n    - or:\n      - format: dotnet\n      - import: mscoree._CorExeMain\n      - import: mscoree._corexemain\n      - import: mscoree._CorDllMain\n      - import: mscoree._cordllmain\n","matches":[[{"type":"no address"},{"success":true,"node":{"type":"statement","statement":{"type":"or"}},"children":[{"success":false,"node":{"type":"feature","feature":{"type":"format","format":"dotnet"}},"children":[],"locations":[],"captures":{}},{"success":true,"node":{"type":"feature","feature":{"type":"import","import_":"mscoree._CorExeMain"}},"children":[],"locations":[{"type":"absolute","value":4202496}],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"import","import_":"mscoree._corexemain"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"import","import_":"mscoree._CorDllMain"}},"children":[],"locations":[],"captures":{}},{"success":false,"node":{"type":"feature","feature":{"type":"import","import_":"mscoree._cordllmain"}},"children":[],"locations":[],"captures":{}}],"locations":[],"captures":{}}]]}}}
